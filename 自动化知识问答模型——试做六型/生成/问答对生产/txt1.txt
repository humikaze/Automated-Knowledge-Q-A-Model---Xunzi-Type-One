
第八章非线性控制系统分析

8- 1       非线性控制系统概述
1.研究非线性控制理论的意义
本书以上各章详细地讨论了线性定常控制系统的分析和设计问题。但实际上，理想的线性系 统并不存在，因为组成控制系统的各元件的动态和静态特性都存在着不同程度的非线性。以随动 系统为例，放大元件由于受电源电压或输出功率的限制，在输入电压超过放大器的线性工作范围 时，输出呈饱和现象，如图8-1(a)所示；执行元件电动机，由于轴上存在着摩擦力矩和负载力矩， 只有在电枢电压达到一定数值后，电机才会转动，存在着死区，而当电枢电压超过一定数值时，电 机的转速将不再增加，出现饱和现象，其特性如图8-1(b) 所示；又如传动机构，受加工和装配精度 的限制，换向时存在着间隙特性，如图8-1(c) 所示。






(a)                         (b)                                  (c)
图8-1 几种典型的非线性特性
由此可见，实际系统中普遍存在非线性因素。当系统中含有一个或多个具有非线性特性的元 件时，该系统称为非线性系统。例如，在图8-2所示的柱形液位系统中，设H  为液位高度，Q,为 液



图8-2 液位系统


体流入量，Q。为液体流出量，C 为贮槽的截面积。根据水力学原理
Q 。=k√H                                                 (8-1)
其中比例系数k 取决于液体的黏度和阀阻。液位系统的动态方程为  (8-2)
显然，液位H 和液体输入量Q;的数学关系式为非线性微分方程。 一般



地，非线性系统的数学模型可以表示为




(8-3)

其中f(·)     和 g(·)     为非线性函数。
当非线性程度不严重时，例如不灵敏区较小、输入信号幅值较小、传动机构间隙不大时，可以 忽略非线性特性的影响，从而可将非线性环节视为线性环节；当系统方程解析且工作在某一数值 附近的较小范围内时，可运用小偏差法将非线性模型线性化。例如，设图8-2液位系统的液位H  在H。附近变化，相应的液体输入量Q, 在Q;o附近变化时，可取△H=H-Ho,△Q=Q-Qo,               对







√H   作泰勒级数展开，有

鉴于H,Q:   变化较小，取 √H  泰勒级数展开式的一次项近似，可得以下小偏差线性方程：




(8-4)



(8-5)

忽略非线性特性的影响或作小偏差线性化处理后，非线性系统近似为线性化系统，因此可以采用 线性定常系统的方法加以分析和设计。但是，对于非线性程度比较严重，且系统工作范围较大的 非线性系统，只有使用非线性系统的分析和设计方法，才能得到较为正确的结果。随着生产和科 学技术的发展，对控制系统的性能和精度的要求越来越高，建立在上述线性化基础上的分析和设 计方法已难以解决高质量的控制问题。为此，必须针对非线性系统的数学模型，采用非线性控制 理论进行研究。此外，为了改善系统的性能，实现高质量的控制，还必须考虑非线性控制器的设 计。例如，为了获得最短时间控制，需对执行机构采用继电控制，使其始终工作在最大电压或最大 功率下，充分发挥其调节能力；为了兼顾系统的响应速率和稳态精度，需使用变增益控制器。
值得注意的是，非线性特性千差万别，对于非线性系统，目前还没有统一的且普遍适用的处 理方法。线性系统是非线性系统的特例，线性系统的分析和设计方法在非线性控制系统的研究中 仍将发挥非常重要的作用。
2.非线性系统的特征
线性系统的重要特征是可以应用线性叠加原理。由于描述非线性系统运动的数学模型为非 线性微分方程，因此叠加原理不能应用，故能否应用叠加原理是两类系统的本质区别。非线性系 统的运动主要有以下特点：
(1)稳定性分析复杂
按照平衡状态的定义，在无外作用且系统输出的各阶导数等于零时，系统处于平衡状态。显 然，对于线性系统，只有一个平衡状态y=0, 线性系统的稳定性即为该平衡状态的稳定性，而且 只取决于系统本身的结构和参数，与外作用和初始条件无关。
对于非线性系统，则问题变得较复杂。首先，系统可能存在多个平衡状态。考虑下述非线性 一阶系统：
i=x²-x=x(x-1)                                                                            (8-6) 令x=0,   可知该系统存在两个平衡状态x=0   和x=1,    为了分析各个平衡状态的稳定性，需要求解 式(8-6)。设t=0   时，系统的初始状态为xo, 由式(8-6)得



积分得







(8-7)

相应的时间响应随初始条件而变。当xo>1  时，随t增大，x(t)递增时 ，
x(t)为无穷大。当xo<1 时 ，x(t)递减并趋于0。不同初始条件下的时间响应曲线如图8-3所示。 考虑上述平衡状态受小扰动的影响，故平衡状态x=1   是不稳定的，因为稍有偏离，系统不








时间响应曲线        自由运动方程为 ü+w²x=0
用拉普拉斯变换法求解该微分方程得

系统自由运动



(8-8)

(8-9)



图8-4 二阶零阻尼线性系统

(8-10)
其中振幅A 和相角φ依赖于初始条件。此外，根据线性叠加原理，在系统运动过程中，一旦外扰 动使系统输出x(t)   或i(t)   发生偏离，则A 和φ都将随之改变，因而上述周期运动将不能维持。所 以线性系统在无外界周期变化信号作用时所具有的周期运动不是自激振荡。
考虑著名的范德波尔方程
-2p(1-x²)+x=0,                             p>0                                            (8-11).
该方程描述具有非线性阻尼的非线性二阶系统。当扰动使x<1  时，因为-p(1-x²)<0  系统具 有负阻尼，此时系统从外部获得能量，x(t)的运动呈发散形式；当x>1 时，因为-2p(1-x²)>0,
系统具有正阻尼，此时系统消耗能量，x(t)  的运动呈收敛形式；而当x=1   时，系统为零阻尼，系统
运动呈等幅振荡形式。上述分析表明，系统能克  服扰动对x 的影响，保持幅值为1的等幅振荡， 见图8-5。
必须指出，长时间大幅度的振荡会造成机械 磨损，增加控制误差，因此多数情况下不希望系 统有自振发生。但在控制中通过引入高频小幅度 的颤振，可克服间隙、死区等非线性因素的不良
影响。而在振动试验中，还必须使系统产生稳定 的周期运动。因此研究自振的产生条件及抑制，确定自振的频率和周期，是非线性系统分析的重 要内容。
(3)频率响应发生畸变
稳定的线性系统的频率响应，即正弦信号作用下的稳态输出量是与输入同频率的正弦信号，






其幅值A 和相位φ为输入正弦信号频率w 的函数。而非线性系统的频率响应除了含有与输入同 频率的正弦信号分量(基频分量)外，还含有关于w 的高次谐波分量，使输出波形发生非线性畸 变。若系统含有多值非线性环节，输出的各次谐波分量的幅值还可能发生跃变。
在非线性系统的分析和控制中，还会产生一些其他与线性系统明显不同的现象，在此不再 赘述。
3.非线性系统的分析与设计方法
系统分析和设计的目的是通过求取系统的运动形式，以解决稳定性问题为中心，对系统实施 有效的控制。由于非线性系统形式多样，受数学工具限制，一般情况下难以求得非线性微分方程 的解析解，只能采用工程上适用的近似方法。本章重点介绍以下三种方法：
(1)相平面法
相平面法是推广应用时域分析法的一种图解分析方法。该方法通过在相平面上绘制相轨迹 曲线，确定非线性微分方程在不同初始条件下解的运动形式。相平面法仅适用于一阶和二阶 系统。
(2)描述函数法
描述函数法是基于频域分析法和非线性特性谐波线性化的一种图解分析方法。该方法对于 满足结构要求的一类非线性系统，通过谐波线性化，将非线性特性近似表示为复变增益环节，然 后推广应用频率法，分析非线性系统的稳定性或自激振荡。
(3)逆系统法
逆系统法是运用内环非线性反馈控制，构成伪线性系统，并以此为基础，设计外环控制网络。 该方法应用数学工具直接研究非线性控制问题，不必求解非线性系统的运动方程，是非线性系统  控制研究的一个发展方向。
8-2   常见非线性特性及其对系统运动的影响

继电特性、死区、饱和、间隙和摩擦是实际系统中常见的非线性因素。在很多情况下，非线性 系统可以表示为在线性系统的某些环节的输入或输出端加入非线性环节。因此，非线性因素的影 响使线性系统的运动发生变化。有鉴于此，本节从物理概念的角度出发，基于线性系统的分析方 法，对这类非线性系统进行定性分析，所得结论虽然不够严谨，但对分析常见非线性因素对系统 运动的影响，具有一定的参考价值。以下分析中，采用简单的折线代替实际的非线性曲线，将非线 性特性典型化，而由此产生的误差一般处于工程所允许的范围之内。
1.非线性特性的等效增益
设非线性特性可以表示为
y=f(x)                                                                         (8-12)  将非线性特性视为一个环节，环节的输入为x,  输出为y, 按照线性系统中比例环节的描述，
定义非线性环节输出y 和输入x 的比值为等效增益
(8-13)
应当指出，比例环节的增益为常值，输出和输入呈线性关系，而式(8-12)所示非线性环节的等效 增益为变增益，因而可将非线性特性视为变增益比例环节。当然，比例环节是变增益比例环节的 特例。






继电器、接触器和可控硅等电气元件的特性通常都表现为继电特性。继电特性的等效增益曲 线如图8-6(a)所示。当输入x 趋于零时，等效增益趋于无穷大；由于输出y 的幅值保持不变，故 当 x||  增大时，等效增益减小，|x| 趋于无穷大时，等效增益趋于零。
死区特性一般是由测量元件、放大元件及执行机构的不灵敏区所造成的。死区特性的等效增 益曲线如图8-6(b) 所示。当|x|<△ 时 ，k=0;   当 |x|>△ 时 ，k 为 |x| 的增函数，且随|x|  趋于无穷 时 ，k 趋 于ko。
放大器及执行机构受电源电压或功率的限制导致饱和现象，等效增益曲线如图8-6(c) 所示。 当输入 |x|≤a 时，输出y 随输入x 线性变化，等效增益 k=ko; 当 |x|>a  时，输出量保持常值，k  为 |x|的减函数，且随|x|趋于无穷而趋于零。
齿轮、蜗轮轴系的加工及装配误差或磁滞效应是形成间隙特性的主要原因。以齿轮传动为 例，一对啮合齿轮，当主动轮驱动从动轮正向运行时，若主动轮改变方向，则需运行两倍的齿隙才 可使从动轮反向运行，如图8-6(d)所示。间隙特性为非单值函数

(8-14)


根据式(8-14)分段确定等效增益并作等效增益曲线如图8-6(d) 所示。受间隙特性的影响，在主动 轮改变方向的瞬时和从动轮由停止变为跟随主动轮转动的瞬时(x=±(a-2b)),          等效增益曲线 发生转折；当主动轮转角过零时，等效增益发生+一到-○的跳变；在其他运动点上，等效增益的 绝对值为|x|的减函数。
摩擦特性是机械传动机构中普遍存在的非线性特性。摩擦力阻挠系统的运动，即表现为与物 体运动方向相反的制动力。摩擦力一般表示为三种形式的组合，如图8-6(e)所示。图中，F₁ 是 物 体开始运动所需克服的静摩擦力；当系统开始运动后，则变为动摩擦力F₂;  第三种摩擦力为粘性 摩擦力，与物体运动的滑动平面相对速率成正比。摩擦特性的等效增益为物体运动速率|x|  的 减 函数。 i|| 趋于无穷大时，等效增益趋于ko;当 |x|在零附近作微小变化时，由于静摩擦力和动摩 擦力的突变式转变，等效增益变化剧烈。










(a)继电特性           (b)死区特性          (c)饱和特性        (d)间隙特性         (e)摩擦特性
图8-6 常见非线性特性的等效增益曲线
2.常见非线性因素对系统运动的影响
非线性特性对系统性能的影响是多方面的，难以一概而论。为便于定性分析，采用图8-7所





示的结构形式，图中k 为非线性特性的等效增益，G(s) 为线性部分的传递函数，K*为线性部分的 开环根轨迹增益。当忽略或不考虑非线性因素，即k 为常数时，非线性系统表现为线性系统，因此 非线性系统的分析可在线性系统分析的基础上加以推广。由于非线性特性用等效增益表示，图示 非线性系统的开环零极点与开环根轨迹增益为k·K"    时的线性系统的零极点相同。非线性因素 对系统运动的影响通过增益的变化改变系统的闭环极点的位置，因而仍可采用根轨迹分析法。
(1)继电特性
由图8-6(a)所示继电特性的等效增益曲线知， 0<k<0,     且为 x|| 的减函数。对于图8-7所示系统， 以下讨论两种情况：
,由于闭环系统对于任意的k 值均稳定， |x(t)|   将趋于零，由图8-8(a)
所示根轨迹可知，由于 x|(t)|   的减小，k 随之增大，系统闭环极点将沿着根轨迹的方向最终趋于 -1±jo, 因为实际系统中的继电特性总是具有一定的开关速度，因此x(t)呈现为零附近的高频 小幅度振荡。当输入r(t)=1(t)     时，非线性系统的单位阶跃响应的稳态过程亦呈现为1(t) 叠加高 频小幅度振荡的运动形式。


图8-8 线性系统的根轨迹
,由图8-8(b) 所示，根轨迹与虚轴的交点为±j√6,     交点处根 轨迹增益kK · 为30,由此可确定此时继电特性的输入幅值 。当|x(t)|>x₁      时，继电特 性的等效增益 ,由根轨迹曲线可知，系统闭环极点均位于s 平面的左半平面，系统闭环稳
定，故x(t)   的幅值将减小，等效增益k 随之增大，系统两个闭环极点将沿根轨迹的方向趋于
±j√6;       当| x(t )|<x₁      时，继电特性的等效增益 ,系统有两个闭环极点位于s 平面的右    半平面，系统闭环不稳定，故x(t)  的幅值将增大，等效增益k 随之减小，系统两个闭环极点也将， 沿根轨迹的反方向趋于±j√6, 由于系统具有惯性，故x(t)最终将保t的等幅振
荡形式。
上述分析表明，继电特性常常使系统产生振荡现象，但如果选择合适的继电特性可提高系统 的响应速度，也可构成正弦信号发生器。





(2)死区特性
死区特性最直接的影响是使系统存在稳态误差。当|x(t)|<△  时，由于k=0,   系统处于开环 状态，失去调节作用。当系统输入为速度信号时，受死区的影响，在|r-c|<△ 时，系统无调节作 用，因而导致系统输出在时间上的滞后，降低了系统的跟踪精度。而在另一方面，当系统输入端存 在小扰动信号时，在系统动态过程的稳态值附近，死区的作用可减小扰动信号的影响。
考虑死区对图8-8(a) 所示系统动态性能的影响。设无死区特性时，系统闭环极点位于根轨 迹曲线上s₁,S₁ 处，阻尼比较小，系统动态过程超调量较大。由于死区的存在，使非线性特性的等 效增益在0~ko之间变化。当 |x(t)|   较大时，闭环极点为阻尼比较小的共轭复极点，系统响应速 度快，当|x(t)|较小时，等效增益下降，闭环极点为具有较大阻尼比的共轭复极点或实极点，系统 振荡性减弱，因而可降低系统的超调量。
(3)饱和特性
饱和特性的等效增益曲线表明，饱和现象将使系统的开环增益在饱和区时下降。控制系统设 计时，为使功放元件得到充分利用，应力求使功放级首先进入饱和；为获得较好的动态性能，应通 过合适选择线性区增益和饱和电压，使系统既能获得较小的超调量，又能保证较大的开环增益，减 小稳态误差。饱和区对系统闭环极点的分析过程与继电特性类同。
(4)间隙特性
间隙的存在，相当于死区的影响，降低系统的跟踪精度。由于间隙为非单值函数，对于相同的 输入值x(t),   输 出y(t)   的取值还取决于i(t)    的符号，因而受其影响负载系统的运动变化剧烈。首 先分析能量的变化，由于主动轮转向时，需先越过两倍的齿隙，不驱动负载，导致能量的积累。当 主动轮越过齿隙重新驱动负载时，积累能量的释放将使负载运动变化加剧。而间隙过大，则蓄能 过多，将会造成系统自振。再分析等效增益曲线，可以发现，在主动轮转向和越过齿隙的瞬间，等
效增益曲线产生切变。而在x(t)   过零处，等效增益将产生+○到一○的跳变。若取G(s)=
,x(t)信号过零前，k 趋 于 + ∞ ,x(t)以高频振荡形式收敛，而过零后，k由 - ○趋于0,系 统闭环不稳定，表现为迅速发散。上述分析表明，间隙特性将严重影响系统的性能，必须加以克 服。通常，可通过提高齿轮的加工和装配精度减小间隙，使用双片齿轮消除齿隙和设计各种校正 装置补偿间隙的影响。
(5)摩擦特性
摩擦对系统性能的影响最主要的是造成系统低速运动的不平滑性，即当系统的输入轴作低 速平稳运转时，输出轴的旋转呈现跳跃式的变化。这种低速爬行现象是由静摩擦到动摩擦的跳变



图8-9 传动机构结构图


产生的。传动机构的结构图如图8-9所示，其中J    为转动惯量，i 为齿轮系速比，0(t) 为输出轴角度， 由于输入转矩需克服静态转矩F₁ 方使输出轴由 静止开始转动，而一旦输出轴转动，摩擦转矩即由 F₁ 迅速降为动态转矩F₂,  因而造成输出轴在小角 度(零附近)产生跳动式变化。反映在等效增益上， 在x(t)  为零处表现为能量为F₁  的正脉冲和能量

为F₁-F₂     的负脉冲。对于雷达、天文望远镜、火炮等高精度控制系统，这种脉冲式的输出变化产生 的低速爬行现象往往导致不能跟踪目标，甚至丢失目标。





以上主要是通过等效增益概念在一般意义上针对特定的系统定性分析了常见非线性因素对 系统性能的影响，在其他情况下不一定适用，具体问题必须具体分析。而欲获得较为准确的结论， 还应采用有效的方法对非线性系统作进一步的定量分析和研究。
8-3 相平面法

相平面法由庞加莱1885年首先提出。该方法通过图解法将一阶和二阶系统的运动过程转化 为位置和速度平面上的相轨迹，从而比较直观、准确地反映系统的稳定性、平衡状态和稳态精度 以及初始条件及参数对系统运动的影响。相轨迹的绘制方法步骤简单、计算量小，特别适用于分 析常见非线性特性和一阶、二阶线性环节组合而成的非线性系统。
1.相平面的基本概念
考虑可用下列常微分方程描述的二阶时不变系统：
ä=f(x,i)                                                   (8-15)  其 中f(x,i)     是 x(t)  和i(t)    的线性或非线性函数。该方程的解可以用x(t)   的时间函数曲线表示， 也可以用i(t)   和x(t)  的关系曲线表示，而t 为参变量。x(t)  和(t)    称为系统运动的相变量(状态  变量),以x(t)  为横坐标，(t)   为纵坐标构成的直角坐标平面称为相平面。相变量从初始时刻t。 对应的状态点(xo,xo)  起，随着时间t 的推移，在相平面上运动形成的曲线称为相轨迹。在相轨迹  上用箭头符号表示参变量时间t的增加方向。根据微分方程解的存在与唯一性定理，对于任一给  定的初始条件，相平面上有一条相轨迹与之对应。多个初始条件下的运动对应多条相轨迹，形成  相轨迹簇，而由一簇相轨迹所组成的图形称为相平面图。
若已知x  和 i  的时间响应曲线如图8-10(b),(c)    所示，则可根据任一时间点的x(t)   和 i(t) 的值，得到相轨迹上对应的点，并由此获得一条相轨迹，如图8-10(a) 所示。

(b)
图8-10 x(t),   文(t) 及其相轨迹曲线





相轨迹在某些特定情况下，也可以通过积分法，直接由微分方程获得i(t)    和x(t)   的解析关


系式。因为


由式(8-15)


若该式可以分解为 两端积分


图8-11 弹簧-质量 运动系统




整理得





                             (8-16)

g(i)di=h(x)dx                                                                    (8-17)

                         (8-18)
由 此 可 得 和x  的解析关系式，其中xo 和 i 。为初始条件。
例8-1 某弹簧-质量运动系统如图8-11所示，图中m 为物体的质 量，k 为弹簧的弹性系数，若初始条件为x(0)=xo,x(0)=io,           试确定系 统自由运动的相轨迹。
解描述系统自由运动的微分方程式为
+x=0                                                 (8-19)
将上式写为

令g(i)=i,h(x)=-x,               则按式(8-18),有



x²+²=(x?+               始 )                          (8-20)

该系统自由运动的相轨迹为以坐标原点为圆心、 √x 路+品为半径的圆，见图8-12。 2.相轨迹绘制的等倾线法
等倾线法是求取相轨迹的一种作图方法，不需 求解微分方程。对于求解困难的非线性微分方程，图 解方法显得尤为实用。
等倾线法的基本思想是先确定相轨迹的等倾 线，进而绘出相轨迹的切线方向场，然后从初始条件 出发，沿方向场逐步绘制相轨迹。

由式(8-16)可得相轨迹微分方程




(8-21)

今出了相轨迹在相平面上任一点(x,i)    处切






线的斜率。取相轨迹切线的斜率为某一常数α,得等倾线方程




(8-22)

由该方程可在相平面上作一条曲线，称为等倾线。当相轨迹经过该等倾线上任一点时，其切线的 斜率都相等，均为α。取α为若干不同的常数，即可在相平面上绘制出若干条等倾线，在等倾线上 各点处作斜率为α的短直线，并以箭头表示切线方向，则构成相轨迹的切线方向场。
在图8-13中，已绘制某系统的等倾线和切线方向场，给定初始点(xo,io),    则相轨迹的绘制
过程如下：
由初始点出发，按照该点所处等倾线的短直线方向作一条小线段，并与相邻一条等倾线相 交；由该交点起，并按该交点所在等倾线的短直线方向作一条小线段，再与其相邻的一条等倾线 相交；循此步骤依次进行，就可以获得一条从初始点出发，由各小线段组成的折线，最后对该折线

作光滑处理，即得到所求系统的相轨迹。
使用等倾线法绘制相轨迹应注意以下几点：
1)坐标轴x  和 i  应选用相同的比例尺，以便于 根据等倾线斜率准确绘制等倾线上一点的相轨迹 切线。
2)在相平面的上半平面，由于i>0,    则 x 随 t 增 大而增加，相轨迹的走向应是由左向右；在相平面的 下半平面i<0,    则 x 随 t 增大而减小，相轨迹的走向 应由右向左。
3)除系统的平衡点外，相轨迹与x 轴的相交点 处切线斜率 应 为 + 一 或 - , 即 相 轨 迹 与x 轴垂直相交。
4)一般地，等倾线分布越密，则所作的相轨迹越




(i(0),x(0))
相轨迹
切线方向
等倾斜线


-x






图8-13 用等倾线法绘制相轨迹

准确。但随所取等倾线的增加，绘图工作量增加，同时也使作图产生的积累误差增大。为提高作 图精度，可采用平均斜率法，即取相邻两条等倾线所对应的斜率的平均值为两条等倾线间直线的 斜率。
3.线性系统的相轨迹
线性系统是非线性系统的特例，对于许多非线性一阶和二阶系统(系统中所含非线性环节可 用分段折线表示),常可以分成多个区间进行研究，而在各个区间内，非线性系统的运动特性可用 线性微分方程描述；此外，对于某些非线性微分方程，为研究各平衡状态附近的运动特性，可在平 衡点附近作增量线性化处理，即对非线性微分方程两端的各非线性函数作泰勒级数展开，并取一 次项近似，获得平衡点处的增量线性微分方程。因此，研究线性一阶、二阶系统的相轨迹及其特点 是十分必要的。下面研究线性一阶、二阶系统自由运动的相轨迹，所得结论可作为非线性一阶、二 阶系统相平面分析的基础。
(1)线性一阶系统的相轨迹
描述线性一阶系统自由运动的微分方程为
Tc+c=0





相轨迹方程为
(8-23)
设系统初始条件为c(0)=co,   则 ,相轨迹如图8-14所示。


(b)T>0


图8-14 线性一阶系统的相轨迹
由图8-14知，相轨迹位于过原点，斜率为的直线上。当T>0 原点；当T<0    时，相轨迹沿该直线发散至无穷。
(2)线性二阶系统的相轨迹
描述线性二阶系统自由运动的微分方程为
c+ac+bc=0
当b>0   时，上述微分方程又可以表示为
ä+25wnc+w²c=0
线性二阶系统的特征根

相轨迹微分方程为

令可得等倾线方程为

其 中k 为等倾线的斜率。当a²-4b>0,       且 b≠0   时，可得满足k=α
率为




时，相轨迹沿该直线收敛于




(8-24) (8-25)
(8-26)


(8-27)



(8-28) 的两条特殊的等倾线，其斜

(8-29)
该式表明，特殊的等倾线的斜率等于位于该等倾线上相轨迹任一点的切线斜率，即当相轨迹 运动至特殊的等倾线上时，将沿着等倾线收敛或发散，而不可能脱离该等倾线。下面就线性二阶 微分方程参数b<0,b=0     和 b>0   的七种不同情况加以具体讨论，其相轨迹曲线采用等倾线法或





解析法绘制而得。
1)b<0 。 系统特征根



S₁,s₂ 为两个符号相反的互异实根，系统相平面图见图8-15。
由图可见，图中两条特殊的等倾线是相轨迹，也是其他相 轨迹的渐近线，此外作为相平面的分隔线，还将相平面划分为 四个具有不同运动状态的区域。当初始条件位于c=s₂c  对应的 相轨迹上时，系统的运动将趋于原点，但只要受到极其微小的 扰动，系统的运动将偏离该相轨迹，并最终沿着c=s₁c    对应的 相轨迹的方向发散至无穷。因此，b<0 时，线性二阶系统的运动
是不稳定的。
2)b=0 。 系统特征根为
S₁=0,            Sz=-a
相轨迹微分方程为

运用积分法求得相轨迹方程



相平面图

(8-30)

c(t)-c=-a(c(t)-co)                                                               (8-31)
相平面图见图8-16,相轨迹为过初始点(co,co),   斜 率为-a  的直线。当a>0   时，相轨迹收敛并最终停 止在c 轴上；a<0   时，相轨迹发散至无穷。
3)b>0 。 由式(8-24)及式(8-25)知，可取ζ=
,并分以下几种情况加以分析：
①0<5<1。系统特征根为一对具有负实部的 共轭复根。由时域分析结果知，系统的零输入响应 为衰减振荡形式。取ζ=0.5,wa=1,  运用等倾线法


绘制系统的相轨迹如图8-17所示。相轨迹为向心螺旋 线，最终趋于原点。
②5>1。系统特征根为两个互异负实根：s₁=-5wn
+wa√s²-1,s₂=-Sw-wa√5²-1 。          系统的零输入响 应为非振荡衰减形式，存在两条特殊的等倾线，其斜率 分别为
k₁=s₁<0,                 k₂=s₂<k₁                   (8-32) 系统相平面图见图8-18。当初始点落在c(t)=s₂c(t)      或 c(t)=sic(t)     直线上时，相轨迹沿该直线趋于原点；除此 之外，相轨迹最终沿着c(t)=s₁c(t) 的方向收敛至原点。
关于相轨迹的运动形式说明如下：



图8-175=0.5,wn=1时线性二阶 系统的相轨迹





由式(8-28)知，线性二阶系统的等倾线斜率为
                            (8-33) 可求得                                                     (8-34)
当等倾线位于第I,Ⅲ  象限时，k>0,   则α<0。故在第I 象限，c增大，c减小；在第Ⅱ象限，c 减小，c增大。在第I( 或 第N)象限，两条特殊相轨迹将该象限划分为A,B 和C 三个区域，如图
8-19所示。因为

(8-35)

图8-185>1时线性二阶系统的相平面图        图8-195>1时线性二阶系统相轨迹的运动
对于A 区内任意一条k=kA 的等倾线，由于0>kA>s₁>s₂,   故αA>kA,相轨迹趋近于特殊等 倾线c=s₁c;   对于B 区内任一条k=kB 的等倾线，由于s₁>ks>s₂,     故 αB<kg, 相轨迹亦趋近于特 殊等倾线c=s₁c,   偏离特殊等倾线c=s₂c;   而当等倾线位于C 区时，kc<s₂<s₁,    则 ac>kc,   相轨迹 偏离c=s₂c。 由以上分析亦可知，相轨迹沿c=s₂c 的运动是不稳定的，稍有扰动，则偏离该相轨 迹，最终沿等倾线c=sic   的方向收敛至原点。



图8-205=1,w=1 时线性二阶 系统的相平面图


根据时域分析结果，5>1的线性二阶系统的自由运动为
c(t)=C₁oe⁻+c2oe⁻                                 (8-36) C10,C₂0由初始条件决定。当取初始条件使c₁o=0 (或c₂o=0),   则 相轨迹为c=s₂c  ( 或c=s₁c);    而在其他情况下，由于特征根sz 远离虚轴，故czoe⁻z 相对于c₁oe⁻  很快衰减，系统运动过程特 别是过渡过程的后期主要取决于c₁oe⁻t 项。这一结果与相平 面分析的结果一致。
③5=1。系统特征根为两个相等的负实根。取wa=1, 其 相平面图见图8-20。与5>1相比，相轨迹的渐近线即特殊等 倾线蜕化为一条，不同初始条件的相轨迹最终将沿着这条特 殊的等倾线趋于原点。





④5=0。系统特征根为一对纯虚根s1.2=±jun 。 系统的自由运动为等幅正弦振荡。给定初 始 点(co,co),仿照例8-1,采用直接积分方法可得系统的相轨迹方程
(8-37)
显然，上式为相平面的椭圆方程。系统的相平面图为围绕坐标原点的一簇椭圆，见图8-21。椭圆 的横轴和纵轴由初始条件给出。
⑤-1<s<0 。   系统特征根为一对具有正实部的共轭复根，系统自由运动呈发散振荡形式。 取 5 = - 0 . 5 ,w=1  时，系统相轨迹如图8-22所示，为离心螺旋线，最终发散至无穷。






图8-215=0时线性二阶 系统的相平面图



图8-225=-0.5,w=1  时线性二阶 系统相平面图

⑥5≤ - 1。5< - 1时系统特征根为两个正实根，s₁=15|w+wa√s²-1,s₂=15|w₂-w.
√s²-1 。  系统自由运动呈非振荡发散，系统相平面图见图8-23。如图所示，存在两条特殊的等倾 线 c=sic   和 c=s₂c 。 当初始点落在这两条直线上，则相轨迹沿该直线趋于无穷；当初始点位于其余 位置时，相轨迹发散至无穷远处，相轨迹曲线的形式与5>1的情况相同，只是运动方向相反。
当5=-1时，系统特征根为两个相同的正实根，存在一条特殊的等倾线。系统相轨迹发散， 相平面图如图8-24所示。



图8-235  <-1时线性二阶 系统相平面图
应当指出，二阶系统的相轨迹可应用MATLAB



图8-245=-1时线性二阶系统 的相平面图
软件包，运行相应的M 文本，在相平面上精

确绘制，并可方便地给出相应的时间响应曲线，便于对比分析。 4.奇点和奇线
系统分析的目的是确定系统所具有的各种运动状态及其性质。对于非线性系统，平衡状态和





平衡状态附近系统的运动形式以及极限环的存在制约着整个系统的运动特性，为此必须加以讨 论和研究。
(1)奇点
以微分方程  = f(x,i) 表示的二阶系统，其相轨迹上每一点切线的斜率  若在某点处f(x,i)     和立同时为零，即的不定形式，则称该点为相平面的奇点。
相轨迹在奇点处的切线斜率不定，表明系统在奇点处可以按任意方向趋近或离开奇点，因此 在奇点处，多条相轨迹相交；而在相轨迹的非奇点(称为普通点)处，不同时满足i=0     和 f(x,
i)=0,     相轨迹的切线斜率是一个确定的值，故经过普通点的相轨迹只有一条。
由奇点定义知，奇点一定位于相平面的横轴上。在奇点处，x=0,ü=f(x,i)=0,                 系统运动 的速度和加速度同时为零。对于二阶系统来说，系统不再发生运动，处于平衡状态。故相平面的 奇点亦称为平衡点。
线性二阶系统为非线性二阶系统的特殊情况。按前分析，特征根在s 平面上的分布，决定了 系统自由运动的形式，因而可由此划分线性二阶系统奇点(0,0)的类型：
1)焦点。当特征根为一对具有负实部的共轭复根时，奇点为稳定焦点，见图8-17;当特征根 为一对具有正实部的共轭复根时，奇点为不稳定焦点，见图8-22。
2)节点。当特征根为两个负实根时，奇点为稳定节点，见图8-18;当特征根为两个正实根时， 奇点为不稳定节点，见图8-23。
3)鞍点。当特征根一个为正实根，一个为负实根时，奇点为鞍点，见图8-15。
此外，若线性一阶系统的特征根为负实根(奇点为原点)或线性二阶系统的特征根一个为零 根，另一个为负实根时(奇点为横轴),相轨迹线性收敛；若线性一阶系统的特征根为负实根时或 线性二阶系统一个根为零根，另一个根为正实根时，则相轨迹线性发散。系统相平面图如图8-14 和图8-16所示。
对于非线性系统的各个平衡点，若描述非线性过程的非线性函数解析时，可以通过平衡点处 的线性化方程，基于线性系统特征根的分布，确定奇点的类型，进而确定平衡点附近相轨迹的运 动形式。对于常微分方程  = f(x,i),       若 f(x,x)     解析，设(xo,io)   为非线性系统的某个奇点，则 可将f(x,i)      在奇点(xo,io)   处展开成泰勒级数，在奇点的小邻域内，略去△x=x-xo     和△i=-
io 的高次项，即取一次近似，则得到奇点附近关于x 增量△r 的线性二阶微分方程
(8-38)

若f(x,z) 不解析，例如非线性系统中含有用分段折线表示的常见非线性因素，可以根据非线性  特性，将相平面划分为若干个区域，在各个区域，非线性方程中f(x,i) 或满足解析条件或可直接  表示为线性微分方程。当非线性方程在某个区域可以表示为线性微分方程时，则奇点类型决定该 区域系统运动的形式。若对应的奇点位于本区域内，则称为实奇点；若对应的奇点位于其他区域， 则称为虚奇点。
(2)奇线
奇线就是特殊的相轨迹，它将相平面划分为具有不同运动特点的各个区域。最常见的奇线是 极限环。由于非线性系统会出现自振荡，因此相应的相平面上会出现一条孤立的封闭曲线，曲线





附近的相轨迹都渐近地趋向这条封闭的曲线，或者从这条封闭的曲线离开，见图8-25,这条特殊 的相轨迹就是极限环。极限环把相平面划分为内部平面和外部平面两部分，相轨迹不能从环内穿 越极限环进入环外，或者相反。这样就把相平面划分为具有不同运动特点的各个区域，所以，极限 环也是相平面上的分隔线，它对于确定系统的全部运动状态是非常重要的。
应当指出，不是相平面内所有的封闭曲线都是极限环。在无阻尼的线性二阶系统中，由于不 存在由阻尼所造成的能量损耗，因而相平面图是一簇连续的封闭曲线，这类闭合曲线不是极限 环，因为它们不是孤立的，在任何特定的封闭曲线邻近，仍存在着封闭曲线。而极限环是相互孤立 的，在任何极限环的邻近都不可能有其他的极限环。极限环是非线性系统中的特有现象，它只发 生在非守恒系统中，这种周期运动的原因不在于系统无阻尼，而是系统的非线性特性，它导致系 统的能量作交替变化，这样就有可能从某种非周期性的能源中获取能量，从而维持周期运动。
根据极限环邻近相轨迹的运动特点，可以将极限环分为以下三种类型：
1)稳定的极限环。当t→ ○   时，如果起始于极限环内部或外部的相轨迹均卷向极限环，则该 极限环叫做稳定的极限环，见图8-25(a)。 极限环内部的相轨迹发散至极限环，说明极限环的内 部是不稳定区域；极限环外部的相轨迹收敛至极限环，说明极限环的外部是稳定区域。因为任何 微小扰动使系统的状态离开极限环后，最终仍会回到这个极限环，说明系统的运动表现为自振 荡，而且这种自振荡只与系统的结构参数有关，与初始条件无关。






(a)

(b)






(c)

(d)






图8-25 极限环的类型及其过渡过程
2)不稳定的极限环。当t→0   时，如果起始于极限环内部或外部的相轨迹均卷离极限环，则  该极限环叫做不稳定的极限环，见图8-25(b) 。 极限环内部的相轨迹收敛至环内的奇点，说明极  限环的内部是稳定区域；极限环外部的相轨迹发散至无穷远处，说明极限环的外部是不稳定区  域。极限环所表示的周期运动是不稳定的，任何微小扰动，不是使系统的运动收敛于环内的奇点， 就是使系统的运动发散至无穷。
3)半稳定的极限环。当t→ ○   时，如果起始于极限环内(外)部的相轨迹卷向极限环，而起始 于极限环外(内)部的相轨迹卷离极限环，则这种极限环叫做半稳定的极限环，见图8-25(c)  和
(d) 。 图8- 25(e) 所示的极限环，其内部和外部都是不稳定区域，极限环所表示的周期运动是不稳 定的，系统的运动最终将发散至无穷远处。图8-25(d)所示的极限环，其内部和外部都是稳定区 域，极限环所表示的周期运动是稳定的，系统的运动最终将收敛至环内的奇点。
在一些复杂的非线性控制系统中，有可能出现两个或两个以上的极限环，图8-26是有两个







图8-26 双极限环
解  系统相轨迹微分方程为


极限环的例子，里面的一个是不稳定的极限环；外边的一个是 稳定的极限环，这时非线性系统的工作状态，不仅取决于初始 条件，也取决于扰动的方向和大小。应该指出，只有稳定的极限 环才能在实验中观察到，不稳定或半稳定的极限环是无法在实 验中观察到的。
例8-2 已知非线性系统的微分方程为
+ 0 . 5 元 + 2x+x²=0              (8-39)
试求系统的奇点，并绘制系统的相平面图。


,则求得系统的两个奇点

为确定奇点类型，需计算各奇点处的一阶偏导数及增量线性化方程。
奇点(0,0)处

△+0.5△i+2△x=0
特征根为s₁,2=-0.25±j1.39,          故奇点(0,0)为稳定焦点。
奇点(-2,0)处

△i+0.5△i-2△x=0
特征根为s₁=1.19,s₂=-1.69,           故奇点(-2,0)为鞍点。
根据奇点的位置和奇点类型，结合线性系统奇点类型和系统运动形式的对应关系，绘制本系 统在各奇点附近的相轨迹，再使用等倾线法，绘制其他区域的相轨迹，获得系统的相平面图，见图 8-27。图中相交于鞍点(-2,0)的两条相轨迹为奇线，将相平面划分为两个区域，相平面图中阴影 线内区域为系统的稳定区域，阴影线外区域为系统的不稳定区域。凡初始条件位于阴影线内区域 时，系统的运动均收敛至原点；凡初始条件位于阴影线外区域时，系统的运动发散至无穷大。该例 说明，非线性系统的运动及其稳定性与初始条件有关。
5.非线性系统的相平面分析
常见非线性特性多数可用分段直线来表示，或者本身就是分段线性的。对于含有这些非线性 特性的一大类非线性系统，由于不满足解析条件，无法采用小扰动线性化方法。然而，若根据非线 性的分段特点，将相平面分成若干区域进行研究，可使非线性微分方程在各个区域表现为线性微 分方程，再应用线性系统的相平面分析方法，则问题将迎刃而解。
这一类非线性特性曲线的折线的各转折点，构成了相平面区域的分界线，称为开关线。下面 通过具有几种典型非线性特性的控制系统的研究，具体介绍该方法的应用。






图8-27 例8-2系统相平面图(MATLAB)
(1)具有死区特性的非线性控制系统
设系统结构如图8-28所示，系统初始状态为 零，输入r(t)=R·1(t)。
根据图8-28,可列写系统的微分方程如下：         图8-28 具有死区特性的非线性系统
Tc(t)+(t)=Km(t)
                  (8-40)
e(t)=r(t)-c(t)
为便于分析，取e(t),e(t)     作为状态变量，并按特性曲线分区域列写微分方程式 区 域I:Te+e+Kke=Tr+i-Kk△,                                                   e≤- △
区域Ⅱ:Te+e=T#+,                                                                     le|<△                   (8-41)
区域Ⅲ:Te+e+Kke=T#+i+Kk△,                                              e≥△
显然，e=-△   和 e=△ 为死区特性的转折点，亦为相平面的开关线。代入r(t)   形式，因为
#(t)=i(t)=0,          整理得
区 域I:T(e+△)"+(e+△)'+Kk(e+△)=0,                                     e≤- △
区域Ⅱ:Te+e=0,                                                                          le|<△                   (8-42)
区域Ⅲ:T(e-△)"+(e-△)'+Kk(e-△)=0,                                    e≥△
若给定参数T=1,Kk=1,       根据线性系统相轨迹分析结果，可得奇点类型 区域I:    奇点(-△,0)为稳定焦点，相轨迹为向心螺旋线(5=0.5); 区域Ⅱ:奇点为(x,0),x∈(-△,△),             相轨迹沿直线收敛；
区域Ⅲ:奇点(△,0)为稳定焦点，相轨迹为向心螺旋线(5=0.5)。
由零初始条件c(0)=0,c(0)=0         和 r(t)=R·1(t)         得e(0)=r(0)-c(0)=R,e(0)=0 。        根 据
区域奇点类型及对应的运动形式，作相轨迹如图8-29实线所示。

下





图8-29 具有死区特性的非线性系统相轨迹 态为零。


由图可知，各区域的相轨迹运动形式由该区域 的线性微分方程的奇点类型决定，相轨迹在开关线 上改变运动形式，系统存在稳态误差，而稳态误差的 大小取决于系统参数，亦与输入和初始条件有关。若 用比例环节k=1   代替死区特性，即无死区影响时， 线性二阶系统的相轨迹如图8-29中虚线所示。由此  亦可以比较死区特性对系统运动的影响。
(2)具有饱和特性的非线性控制系统
设具有饱和特性的非线性控制系统如图8-30 所示。图中T=1,K=4,eo=M₀=0.2,             系统初始状


图8-30 具有饱和特性的非线性控制系统
取状态变量为e(t)  和e(t),   按饱和特性可列写以下三个线性微分方程： Te+e-KM。=Tr+            亡，   e≤-eo
       le|<e。
Te+e+KM₀=Tr+              广，    e≥e。
可知开关线e=-eo     和 e=e 。将相平面分为负饱和区、线性区和正饱和区。下面分别研究系统在


r(t)=R · 1(t) 和r(t)=Vot 作用下的相轨迹。 1)r(t)=R·1(t) 。     整理式(8-43)得
Te+e-KM。=0,
Te+e+Ke=0,    Te+e+KM₀=0,
这里涉及在饱和区需要确定形如
Te+e+A=0,
的相轨迹。由上式得相轨迹微分方程




e≤-eo
|e|<eo e≥eo

A 为常数





(8-44)


(8-45)


相轨迹无奇点，而等倾线方程

为一簇平行于横轴的直线，其斜率k 均为零。令α=0得e=-A,   即为特殊的等倾线(k =α=0)。 代入给定参数求得线性区的奇点为原点，且为实奇点，其特征根为s₁,2=-0.5±j1.94, 所以奇点 为稳定焦点。由零初始条件和输入r(t)=R · 1(t) 得 ，e(0)=R,e(0)=0。  取 R=2  绘制系统的相 轨迹如图8-31所示。由图可见，相轨迹在e<-eo     区域渐近趋近于e=KMo    的等倾线；在e>eo





区域，渐近趋近于e=-KMo      的等倾线。相轨迹最终趋于坐标原点，系统稳定。

a-0 e=KM₀




-I      -0.6        io2 0.6



a=0 e=-KM₀
|el<eo            e>e₀
(a)                                                                                      (b)

	图8-31 r(t)=2·1(t)	具有饱和特性的非线性系统相轨迹
2)r(t)=Vot。	由 i(t)=Vo,(t)=0,	可分区间得下述三个线性微分方程：
Te+e-(KM 。+V 。)=0,                                                           e≤-e。
             |e|<e。 Te+e+(KM 。-V 。)=0,                                                           e≥e。
仿照“1)”讨论，在给定参数值下，线性区间奇点为稳定焦点；负饱和区内特殊的等倾
线 为e=KM₀+V 。(    k=α=0); 正饱和区内特殊的等倾线为e =-KMo+V₀ (k=α=0)。     综 上 知
r(t)=V₀t     对系统运动的影响，与r(t)=R·1(t)         的情况相比较，奇点将沿横轴向右平称    ,两条
特殊的等倾线将沿纵轴向上平移V₀ 。对于初始条件c(0)=co,c(0)=co,  由 于i(0)=Vo,r(0)=
0,故e(0)=-co,e(0)=V₀-co 。      而正因为奇点和特殊的等倾线的平移使奇点的虚实发生变化， 特别是系统相轨迹的运动变得复杂，因此需根据参数K 及输入系数V。,分别加以研究，下面仅讨 论其中的三种情况。
当 Vo=1.2>KMo     时，线性区内，相轨迹奇点(0.3,0)为稳定焦点，且为虚奇点，饱和区的两 条特殊的等倾线均位于相平面的上半平面。系统的相平面图如图8-32(a) 所示，起始于任何初始 点的相轨迹将沿正饱和区的特殊相轨迹发散至无穷。
当 V₀=0.4<KM。   时，线性区内，相轨迹奇点(0.1,0)为稳定焦点，且为实奇点，负饱和区和 正饱和区的两条特殊的等倾线分别位于e 的上半平面和下半平面。系统的相平面图如图8-32(b)   所示，起始于任何初始点的相轨迹最终都收敛于(0.1,0),系统的稳态误差为0.1。
当 Vo=0.8=KM 。 时，线性区内，相轨迹奇点(0.2,0)为稳定焦点，为实奇点，且位于开关线 e=e。上，正饱和区的线性微分方程为
Te+e=0

















(a)                                                                              (b)











(c)
图8-32 r(t)=Vt    时具有饱和特性的非线性系统的相平面图
按线性系统相轨迹分析知，该区域内的相轨迹是斜率为的直线，横轴上大于eo的各点皆为 奇点，起始于任何初始点的相轨迹最终都落在e>eo  的横轴上，系统存在稳态误差，稳态误差的 大小取决于初始条件，相平面图为图8-32(c)。
(3)具有滞环继电特性的非线性控制系统
非线性系统结构如图8-33所示，H(s) 为反馈网络，r(t)=0。
1)单位反馈H(s)=1 。 根据滞环继电特性分区间列写微分方程如下：


Tc+c+KM₀=0, Tc+c-KM₀=0,

图8-33 具有滞环继电特性的非线性系统


c>h     或 c>-h,i<0
(8-47)
c<-h        或 c<h,i>0
由式(8-47)易知，三条开关线c=h,c>0;c=-h,
i<0   和-   h<c<h,c      =0  将相平面划分为左右两个 区域。根据式(8-45)的分析结果，左区域内存在一 条特殊的相轨迹c=KM₀(k=α=0),         右区域内亦存 在一条特殊的相轨迹c=-KM₀ 。  所绘制的系统相 平面图如图8-34所示。横轴上区间(-h,h)  为发散

段，即初始点位于该线段时，相轨迹运动呈向外发散形式，初始点位于该线段附近时也同样向外 发散；而由远离该线段的初始点出发的相轨迹均趋向于两条特殊的等倾线，即向内收敛，故而介





于从内向外发散和从外向内收敛的相轨迹之间，存在一条闭合曲线MNKLM,  构成极限环。按极 限环定义，该极限环为稳定的极限环。因此在无外作用下，不论初始条件如何，系统最终都将处于 自振状态。而在输入为r(t)=R · 1(t)条件下，仍有
Te+e+KM 。=Tr+r=0,                     e>h     或e>-h,e<0
Te+e-KM₀=Tr+              广 = 0 ,  e<-h       或 e<h,e>0                             (8-48)
系统状态e(t),e(t)    仍将最终处于自振状态。可见滞环特性恶化了系统的品质，使系统处于失控
状态。
2)速度反馈H(s)=1+ts(0<r<T) 。     滞环非线性因素对系统影响的定性分析和相平面法
分析表明，滞环的存在导致了控制的滞后，为补偿其不利影响，引入输出的速度反馈，以期改善非 线性系统的品质。


加入速度反馈控制以后，非线性系统在无输入作用下的微分方程为
Tc+i+KM 。=0,               c+ti>h         或c+ti>-h,c+tä<0
Tc+c-KM₀=0,                  c+ti<-h           或c+ti<h,c+tä>0
由滞环继电特性可知，式(8-49)中方程的第二个条件只是在-h<c+ic<h 节输出为KMo 或-KM₀   的条件。设直线L₁:c+ti=h,L₂:c+tc=-h。
限(c<0)   且位于L₁ 上方以及L₁ 上时



(8-49)
区域内保持非线性环 当相轨迹点位于第IV象


故当相轨迹运动至A₁ 点后，非线性环节输出仍将保持-KM₀, 系统仍将按H(s)=1     时的运动规 律运动至A₂ 点，此时，非线性环节输出切换为KMo。当相轨迹点位于第Ⅱ象限且位于L₂ 下方以
及L₂ 上时的运动可仿上分析，由此可知，三条开关线c>0 且c+ti =h、i<0 且           和
c=0   且 -h<c<h    将相平面划分为左右两个区域，相平面图如图8-35所示。与单位反馈时的切 换线相比，引入速度反馈后，开关线反向旋转，相轨迹将提前进行转换，使得系统自由运动的超调 量减小，极限环减小，同时也减小了控制的滞后。由于开关线反向旋转的角度φ随着速度反馈系 数t 的增大而增大，因此当0<r<T  时，系统性能的改善，将随着t的增大愈加明显。一般来说， 控制系统可以允许存在较小幅值的自振荡，因而通过引入速度反馈减小自振荡幅值，具有重要的 应用价值。



图8-34 H(s)=1   时，具有滞环继电特性的 非线性系统相平面图



图8-35 速度反馈(r>T)  下滞环继电特性
的相平面图






8-4  描述函数法

描述函数法是达尼尔(P.J.Daniel)于1940年首先提出的，其基本思想是：当系统满足一定 的假设条件时，系统中非线性环节在正弦信号作用下的输出可用一次谐波分量来近似，由此导出 非线性环节的近似等效频率特性，即描述函数。这时非线性系统就近似等效为一个线性系统，并 可应用线性系统理论中的频率法对系统进行频域分析。
描述函数法主要用来分析在无外作用的情况下，非线性系统的稳定性和自振荡问题，并且不 受系统阶次的限制，一般都能给出比较满意的结果，因而获得了广泛的应用。但是由于描述函数 对系统结构、非线性环节的特性和线性部分的性能都有一定的要求，其本身也是一种近似的分析 方法，因此该方法的应用有一定的限制条件。另外，描述函数法只能用来研究系统的频率响应特 性，不能给出时间响应的确切信息。
1.描述函数的基本概念
(1)描述函数的定义
设非线性环节输入输出描述为
y=f(x)                                                                        (8-50)
当非线性环节的输入信号为正弦信号
x(t)=Asinwt                                                                    (8-51) 时，可对非线性环节的稳态输出y(t)  进行谐波分析。一般情况下，y(t)  为非正弦的周期信号，因而 可以展开成傅里叶级数：

其中，A。为直流分量；Ynsin(nwt+%)  为第n 次谐波分量，且有
Y,=√A3+B²,                                 (8-52)
式中，A,B 。为傅里叶系数，以下式描述：
               (n=1,2,…)               (8-53) 而直流分量
                           (8-54) 若A₀=0  且 当n>1   时 ，Y。均很小，则可近似认为非线性环节的正弦响应仅有一次谐波分量
y(t)≈A₁cosot+B₁sinot           =Y₁sin(wt           +A)                                 (8-55)
上式表明，非线性环节可近似认为具有和线性环节相类似的频率响应形式。为此，定义正弦输入 信号作用下，非线性环节的稳态输出中一次谐波分量和输入信号的复数比为非线性环节的描述
函数，用N(A)  表示：
(8-56)
例8-3 设继电特性为







试计算该非线性特性的描述函数。 解            x=Asinwt








(8-57)















(8-58)

一般情况下，描述函数N 是输入信号幅值A 和频率w 的函数。当非线性环节中不包含储能元 件时，其输出的一次谐波分量的幅值和相位差与w 无关，故描述函数只与输入信号幅值A 有关。

至于直流分量，若非线性环节的正弦响应为关于t 的奇对称函数，即

则由式(8-54)

取变换at           =wu+π,有


而当非线性特性为输入x 的奇函数时，即f(x)=-f(-x),    有

=f(-x)=-f(x)=-y(t)
即y(t)  为 t 的奇对称函数，直流分量为零。B₁,A₁    按下式计算：

关于描述函数计算，还具有以下特点。若y(t)  为奇函数，即y(t)=-y(-t),            则






(8-59)















(8-60)






(8-61)






若y(t)  为奇函数，且又为半周期内对称，即

例8-4 设某非线性元件的特性为

试计算其描述函数。
解  因y(x)   为x 的奇函数，故Ao=0 。 当 输 入x=Asinwt   时

为t 的奇函数，故A₁=0 。 又因为y(t)  具有半周期对称，按式(8-62),有


由定积分公式

得
则该非线性元件的描述函数为





(8-62)


(8-63)



(8-64)








n 为奇整数
(8-65)
n 为偶整数




(8-66)

(2)非线性系统描述函数法分析的应用条件
1)非线性系统应简化成一个非线性环节和一个线性部分闭环连接的典型结构形式，如 图8-36所示。



图8-36 非线性系统典型结构形式


2)非线性环节的输入输出特性y(x)   应 是x  的奇函数，即f(x)   =-f(-x),    或正弦输入下的
输出为t 的奇对称函数，即
保证非线性环节的正弦响应不含有常值分量，即

A₀=0。
3)系统的线性部分应具有较好的低通滤波性能。当非线性环节的输入为正弦信号时，实际  输出必定含有高次谐波分量，但经线性部分传递之后，由于低通滤波的作用，高次谐波分量将被 大大削弱，因此闭环通道内近似地只有一次谐波分量流通，从而保证应用描述函数分析方法所得  的结果比较准确。对于实际的非线性系统，大部分都容易满足这一条件。线性部分的阶次越高， 低通滤波性能越好；而欲具有低通滤波性能，线性部分的极点应位于复平面的左半平面。




(3)描述函数的物理意义
线性系统的频率特性反映正弦信号作用下，系统稳态输出中与输入同频率的分量的幅值和 相位相对于输入信号的变化；而非线性环节的描述函数则反映非线性系统正弦响应中一次谐波 分量的幅值和相位相对于输入信号的变化。因此忽略高次谐波分量，仅考虑基波分量，非线性环 节的描述函数表现为复数增益的放大器。
值得注意的是，线性系统的频率特性是输入正弦信号频率w 的函数，与正弦信号的幅值A  无关，而由描述函数表示的非线性环节的近似频率特性则是输入正弦信号幅值A 的函数，因而 描述函数又表现为关于输入正弦信号的幅值A 的复变增益放大器，这正是非线性环节的近似频 率特性与线性系统频率特性的本质区别。当非线性环节的频率特性由描述函数近似表示后，就可 以推广应用频率法分析非线性系统的运动性质，问题的关键是描述函数的计算。
2.典型非线性特性的描述函数
典型非线性特性具有分段线性特点，描述函数的计算重点在于确定正弦响应曲线和积分区 间，一般采用图解方法。下面针对两种典型非线性特性，介绍计算过程和步骤。
(1)死区饱和非线性环节
将正弦输入信号x(t) 、非线性特性y(x)  和输出信号y(t)  的坐标按图8-37所示方式和位置 旋转，由非线性特性的区间端点(△,y(△)) 和(a,y(a))    可以确定y(t)   关 于wt 的区间端点ψ和



图8-37 死区饱和特性和正弦响应曲线
ψ2。死区饱和特性及其正弦响应如图8-37所示。输出y(t)  的数学表达式为

如图所示，由非线性特性的转折点△和a,可确定y(t)产生不同线性变化的区间端点为


由于y(t)为奇函数，所以A₀=0,A₁=0,   而y(t)又为半周期内对称，故




















(8-67)



(8-68) (8-69)












死区饱和特性的描述函数为

        A≥a                                                        (8-70) 取△=0,由式(8-70)得饱和特性的描述函数为
        A≥a                            (8-71) 对于死区特性，。由式(8-692得 ,则由式(8-70)得死区特性的描述函数为
        A≥△          (8-72)
(2)死区与滞环继电非线性环节



图8-38 死区滞环继电特性和正弦响应曲线


注意到滞环与输入信号及其变化率的关系，通过 作图法获得y(t)  如图8-38所示。输出y(t)  的数学表 达式为

(8-73)

图中，由于非线性特性导致y(t)产生不同线性变化的

区间端点为	

	
(8-74) (8-75)






由图可见，y(t)  为奇对称函数，而非奇函数，由式(8-60)





死区滞环继电特性的描述函数为

取h=0,   得理想继电特性的描述函数为

取m=1,  得死区继电特性的描述函数为

A≥h
取m=-1,     得滞环继电特性的描述函数为

A≥h
表8-1列出了一些典型非线性特性的描述函数，以供查用。







A≥h         (8-76)


(8-77)


(8-78)


(8-79)

表8-1非线性特性及其描述函数

非线性类型	静  特  性	描述函数N(A)


理想继电特性、 库仑摩擦		




有死区的继电 特性		

,A≥h


有滞环的继电 特性		









非线性类型	静  特  性	描述函数N(A)


有死区与滞环 的继电特性		



饱和特性，幅值 限制		



有死区的饱和 特性		
.a≥0


死区特性		




间隙特性		




变增益特性		



有死区的线性 特性		



库仑摩擦加黏 性摩擦		








3.非线性系统的简化
非线性系统的描述函数分析建立在图8-36所示的典型结构基础上。当系统由多个非线性环 节和多个线性环节组合而成时，在一些情况下，可通过等效变换使系统简化为典型结构形式。
等效变换的原则是在r(t)=0 的条件下，根据非线性特性的串、并联，简化非线性部分为一个 等效非线性环节，再保持等效非线性环节的输入输出关系不变，简化线性部分。
(1)非线性特性的并联
若两个非线性特性输入相同，输出相加、减，则等效非线性特性为两个非线性特性的叠加。图 8-39为死区非线性和死区继电非线性并联的情况。

图8-39 非线性特性并联时的等效非线性特性
由描述函数定义，并联等效非线性特性的描述函数为各非线性特性描述函数的代数和。
(2)非线性特性的串联
若两个非线性环节串联，可采用图解法简化。以图8-40所示死区特性和死区饱和特性串联
简化为例。

图8-40 非线性特性串联
通常，先将两个非线性特性按图8-41(a),(b)形式放置，再按输出端非线性特性的变化端点 △₂和a₂ 确定输入x 的对应点△和a, 获得等效非线性特性如图8-41(c) 所示，最后确定等效非线


图8-41 非线性串联简化的图解方法

开




性的参数。由△₂=K₁ (△-△₁), 得


由 a₂=K₁(a-△₁)       得









(8-80》


(8-81)

当 |x|≤△ 时，由y(x₁)   特性知，y(x)=0;     当 x||≥a     时，由y(x₁)    亦可知，y(x)=K₂(az-△₂); 当 △ < x||<a    时 ，y(x₁)   位于线性区，y(x)  亦呈线性，设斜率为K,  即有
y(x)=K(x-△)=K₂(x₁-△₂)
特殊地，当x=a    时 ，x₁=a₂,   由 于x₁=△₂+K₁(a-△),         故 ,因此K=K₁K₂。
应该指出，两个非线性环节的串联，等效特性还取决于其前后次序。调换次序则等效非线性 特性亦不同。描述函数需按等效非线性环节的特性计算。多个非线性特性串联，可按上述两个非 线性环节串联简化方法，依由前向后顺序逐一加以简化。
(3)线性部分的等效变换
考虑图8-42(a) 示例，按等效变换原则，调换综合点，系统可表示为图8-42(b) 形式，再按线 性系统等效变换得典型结构形式，见图8-42(c)。






(a)                                                        (b)




(c)
图8-42 非线性系统等效变换 4.非线性系统稳定性分析的描述函数法
若非线性系统经过适当简化后，具有图8-36所示的典型结构形式，且非线性环节和线性部 分满足描述函数法应用的条件，则描述函数可以作为一个具有复变增益的比例环节。于是非线性 系统经过谐波线性化已变成一个等效的线性系统，可以应用线性系统理论中的频率域稳定判据 分析非线性系统的稳定性。
(1)变增益线性系统的稳定性分析
为了应用描述函数分析非线性系统的稳定性，有必要研究图8-43(a) 所示线性系统的稳定 性，其中K  为比例环节增益。设G(s)  的极点均位于s 的左半平面，即P=0,G(jw)     的奈奎斯特曲 线 Ic  如图8-43(b) 所示。闭环系统的特征方程为
1+KG(jw)=0                                                                     (8-82)







(a)                                                             (b)
图8-43 可变增益的线性系统
或                                                          (8-83) 由奈氏判据知，当Ic  曲线不包围点时，即Z= P-2N=-2N=0,      系 统 闭环稳定；当 Tc 曲线包围点时，系统不稳定；当Tc 曲线穿过 点时，系统临界稳定，将产生 等幅振荡。更进一步，若设K 在一定范围内可变，即有K₁≤K≤K₂,       则 为复平面实轴
上的一段直线，若Tc 曲线不包围该直线，则系统闭环稳定，而当Tc 包围该直线时，则系统闭环 不稳定。
(2)应用描述函数分析非线性系统的稳定性
上述分析为应用描述函数判定非线性系统的稳定性奠定了基础。由于要求G(s)  具有低通特 性，故其极点均应位于s 的左半平面。当非线性特性采用描述函数近似等效时，闭环系统的特征 方程为
1+N(A)G(jw)=0                                                                   (8-84)
即                                                               (8-85) 为非线性环节的负倒描述函数。在复平面上绘制Tc 曲线和- 曲线时， 曲线上箭头表示随A 增大，的变化方向。
若 Tc 曲线和 曲线无交点，表明式(8-84)无w 的正实数解。图8-44给出了这一条件
下的两种可能的形式。
图8-44(a) 中 ，Ic  曲线包围 ·曲线，对于非线性环节具有任一确定振幅A 的正弦输入
j
GGjo)                    
0
w a

(a)                                                            (b)
图8-44 Tc曲线和曲线无交点的两种形式





信号，           点 被Ic  包围，此时系统不稳定，A 将增大，并最终使A 增大到极限位置或使
系统发生故障。
图8-44(b) 中 ，Tc 曲线不包围-曲线，对于非线性环节的具有任一确定振幅A 的正弦 信号，点不被Tc 曲线包围，此时系统稳定，A 将减小，并最终使
A 减小为零或使非线性环节的输入值为某定值，或位于该定值附近较小的范围。
综上可得非线性系统的稳定性判据：若Ic  曲线不包围- 曲线，则非线性系统稳定；若 Tc 曲线包围 曲线，则非线性系统不稳定。
例8-5 已知非线性系统结构如图8-45所示，试分析系统的稳定性。


解对于线性环节，令K=10,T₁=1,T₂=4,

rD±(   0            四

图8-45 例8-5非线性系统结构图
非线性环节为库仑摩擦加黏性摩擦，由表8-1得


解得穿越频率







作Tc 曲线和 曲线如图8-46所示，图中Ic  曲线包围
曲线。根据非线性系统稳定判据，该非线性系统不
稳定。
若 Ic  曲线和 曲线有交点，表明式(8-84)有w 的正 实数解，则系统存在着无外作用下的周期运动，对应于相平面 分析中的极限环，这种情况下系统的稳定性和所具有的周期运 动的稳定性必须另行分析。



图8-46  例8-5系统稳定性分析

(3)非线性系统存在周期运动时的稳定性分析
当 Ic  曲线和 曲线有交点时，式(8-85)成立，即有
         /G(jw)=     一 π - /N(A)                               (8-86)
或                  Re[G(jw)N(A)]=-1,                    Im[G(jw)N(A)]=0                                     (8-87)
由上两式可解得交点处的频率w 和幅值A。系统处于周期运动时，非线性环节的输入近似为 等幅振荡
x(t)=Asinat
即每一个交点对应着一个周期运动。如果该周期运动能够维持，即在外界小扰动作用下使系统偏





离该周期运动，而当该扰动消失后，系统的运动仍能恢复原周期运动，则称为稳定的周期运动。图
8-47给出了非线性系统存在周期运动的四种形式。图中Ic  曲 线 和 的交点为No=
,负倒描述函数上的一点N: 对应的幅值为A。



(a)


j

G(jo)
-
MN₀ N₂ 下

ap
(b)



P=0



(c)



(d)

图8-47 存在周期运动的非线性系统
对于图8-47(a) 所示系统，设系统周期运动的幅值为Ao。当外界扰动使非线性环节输入振幅
减小为A₁时，由于Ic  曲线包围点，系统不稳定，振幅将增大，最终回到N。点；当外 界扰动使输入振幅增大为A₂, 由 于Ic  曲线不包围 点，系统稳定，振幅将衰减，最终
也将回到No 点。这说明N。点对应的周期运动是稳定的。
对于图8-47(b) 所示系统，曲线的运动方向与图8-47(a)相反，当外扰动使系统偏离
周期运动至N₂ 点，即使其幅值由A。增大为A₂时，系统不稳定，振幅将进一步增大，最终发散至无 穷；而当外扰动使系统偏离周期运动至N₁ 点，即使其幅值由A。减小为A₁时，系统稳定，振幅将进 一步减小，最终衰减为零。这表明N₀ 点对应的周期运动是不稳定的。
对于图8-47(c) 所示系统，Ic  曲线和曲线有两个交点N₁₀ 和N₂0, 系统中存在两个周期
运动，幅值分别为A₁₀ 和A₂₀,仿上分析可知，在N₂o 点，外界小扰动使系统运动偏离该周期运动后， 系统运动仍然能恢复该周期运动；而在N₁₀ 点，只要有外界扰动使系统运动偏离该周期运动，则系  统运动或收敛至零，或趋向于N₂0点对应的周期运动。因此，N₁₀ 点对应的周期运动是不稳定的， N₂0点对应的周期运动是稳定的。
对于图8-47(d) 所示系统，Ic  曲线和有两个交点N₁₀ 和N₂0, 表明系统中存在幅值为
A₁₀和A₂₀ 的两个周期运动，N₁₀ 点对应的周期运动是稳定的；N₂0点对应的周期运动是不稳定的， 外界小扰动或使系统运动发散至无穷，或趋向于幅值N₁o点对应的周期运动。
综合上述分析过程，在复平面上可将T₆ 曲线包围的区域视为不稳定区域，Tc曲线不包围的 区域视为稳定区域，则有下述周期运动稳定性判据：
在Tc 曲线和 —  A)  曲线的交点处，若- 曲线沿着振幅A 增加的方向由不稳定区域 进入稳定区域时，该交点对应的周期运动是稳定的。 曲线沿着振幅A 增加的方
向在交点处由稳定区域进入不稳定区域时，该交点对应的周期运动是不稳定的。
图8-47的分析表明，非线性系统存在周期运动时，系统运动的分析是较为复杂的。图8-47





(b) 所示系统，系统运动收敛至零还是发散至无穷，均取决于初始条件，即使系统处于零平衡状 态，但受到大的扰动仍将发散至无穷。图8-47(c)所示系统，当初始条件为A 较大时(A>A₁o),  将 产生稳定的周期运动。而图8-47(d) 所示系统，则当初始条件为A 较小时(A≤A₂₀),    将产生稳定 的周期运动。因而，这样的系统产生自激振荡是有条件的。此外还应注意到这类系统稳定的周期 运动只是对扰动的一定范围具有稳定性，当扰动较大时，系统将停振或发散至无穷。由于系统不 可避免地存在各种扰动因素，因此不稳定的周期运动在系统中不可能出现，而欲利用非线性系统 产生不受扰动影响的自激振荡，应选图8-47(a) 所示的系统。
最后还需指出，应用描述函数法分析非线性系统运动的稳定性，都是建立在只考虑基波分量 的基础之上的。实际上，系统中仍有一定量的高次谐波分量流通，系统自振荡波形并非纯正弦波，
因此分析结果的准确性还取决于Tc 曲线与- 曲线在交点处的相对运动。若交点处两条曲
线几乎垂直相交，且非线性环节输出的高次谐波分量被线性部分充分衰减，则分析结果是准确  的。若两曲线在交点处几乎相切，则在一些情况下(取决于高次谐波的衰减程度)不存在自振荡。
例8-6 设具有饱和非线特性的控制系统如图8-48所示，试分析： 1)K=15   时非线性系统的运动；
2)欲使系统不出现自振荡，确定K 的临界值。

r(1)=0±        e(1)



图8-48 具有饱和非线性特性的控制系统 解1)由表8-1查得饱和非线性特性的描述函数为






A≥a





(8-88)

,对 N(u) 求导得



注意到A >a 时，1,故
为A 的减函数，代入给定参数a=1,k=2,


,N(u) 为 u 的增函数，N(A) 为 A 的减函数，亦
得


曲线如图8-49所示。
线性部分G(s)  在K=15   时 的Tc 曲线如图8-49中曲线①所示，其中穿越频率

Ic  曲线与负实轴的交点为







由图8-49可知，Tc曲 线 和曲线存在交
点 ( - 1 ,j0)且在该交点处，        沿 A 增大方向，
由不稳定区域进入稳定区域，根据周期运动稳定性判 据，系统存在稳定的周期运动。由式(8-87)
Im[G(jw)N(A)]=Im[G(jw)]·N(A)=0 得振荡频率w=₂=7.07,         而由
Re[G(jw)N(A)]=Re[G(jw)]N(A) =-N(A)=-1
可求得振幅A=2.5 。 因而非线性系统处于自振荡情 况下的非线性环节的输入信号为



图8-49 例8-6系统的 曲线

e(t)=2.5sin7.07t
2)为使该系统不出现自振荡，应调整K 使 Tc 曲线移动，并和- 曲线无交点，即应有

而K 的临界值应使上述不等式变为等式，即

K=7.5  时 的Tc 曲线如图8-49中曲线②所示。
例8-7 设非线性系统如图8-50所示，试采用描述函数法分析： 1)G.(s)=1;

时非线性系统的运动特性。

H0=0±c  eO厂Ge(s)   x0


图8-50 例8-7非线性系统的结构图 解由表8-1,死区继电特性的描述函数为
       A≥h 取 ,则
,   u≥1 对N(u)  求导数






由极值条件

又当h≤A<Am    时 ;当A>Am  时，,故Am 为 N(A) 的极大值点，极大值为

而 亦 为       的极大值，注意到- 曲线如图8-51所
示。
1)G₂(s)=1 。Ic       曲线如图8-51中曲线①所示，其中穿越频率

Ic  曲线与负实轴的交点坐标为

由图可知，在负实轴(-1,j0)点 处 ，c 曲线和曲线有两个交点，按式(8-85)解得

根据周期运动稳定性判据知，A₁ 和w₁ 对应不稳定的周期运动；A₂ 和 w₂ 对应稳定的周期运 动。当初始条件或外扰动使A<A₁,  则系统运动不存在自振荡，稳态误差le|<h; 当初始条件或外 扰动使A>A₁   时，则系统产生自振荡，e(t)=1.146sin4t。



图8-51 例8-7非线性系统的频率特性


为无源超前网
络，系统线性部分为Gs)G₄ (s)。Tcc  曲线如图 8-51中曲线②所示，其中穿越频率为
W=11.97
G₂(jw₂)G(jw)=-0.226
由 于Ic 曲线不包围       曲线，系统稳定。
取A 为定值，由|G. (jw.)G(jw.)N(A) |=1,  可
以解得w.,则相角裕度为
Y(A)=180°-/G.(jw.)G(jw.)
特殊地，取A=Am,  相应地相角裕度为Ym,约为 30°左右，而由图8-51可知

Y(A)≥ym
因此加入串联超前校正网络，可以使非线性系统消除自振，且使系统具有一定的相角裕度。当然 也可以通过减小线性部分的增益消除自振，但这样做会使系统响应的快速性降低。
最后指出：在掌握描述函数法基本理论的基础上，应用MATLAB  软件可作出- 1/N(A)  和





G(jo)  曲线，便于分析非线性系统的稳定性和自振荡。

8-5 非线性控制的逆系统方法

相平面法和描述函数法是非线性系统分析的常用方法，对于研究含有饱和、死区和滞环等非 解析的非线性环节的系统，具有十分明显的优点。这两种方法也可用于非线性控制系统的设计， 例如前面我们曾在相平面法一节的叙述中，为了改善具有滞环非线性环节的系统的运动特性，引 入了微分反馈控制；在描述函数法一节的叙述中，通过加入串联超前校正环节，消除了由于死区 继电特性所产生的自激振荡。然而由于设计方法的基础是图解和近似分析，结果也只是近似的， 更重要的是控制器的设计尚需要对具体系统的运动性质有一定的了解。逆系统方法围绕反馈控 制设计这一目的，应用数学工具直接研究非线性控制问题，不再依赖于非线性系统运动的求解和  稳定性分析，因而具有一定的普遍性，并在工程中得到了成功的应用。诚然，逆系统方法要求系统 中非线性特性是解析的。
1.非线性系统的反馈线性化
在控制理论中，反馈控制方法是实现控制目的的基本途径。例如由非线性方程
j=f(y,j)+u                                                                         (8-91)
表示的非线性二阶系统，取y,j   为状态，制-,，j使用反馈控制律
则闭环系统变换为由方程
j=v                                                                       (8-93) 表示的线性系统，变换后系统的控制问题即可用线性方法加以解决。这种采用非线性状态反馈将 非线性系统完全变换为线性系统的方法称为反馈线性化。与传统的非线性控制方法相比，反馈线 性化方法不再依赖于系统运动的求解或稳定性分析，只需要研究系统的反馈结构，使得非线性系 统的控制问题变得简单。反馈线性化是逆系统方法的基础。
2.逆系统方法的基本思想
众所周知，逆概念具有普遍意义。对于函数，有反函数；对于矩阵，有逆矩阵；对于系统的运动 亦有逆运动。一般意义上，这些关系都可看成映射和逆映射或变换和逆变换。从数学模型角度看， 所谓系统相当于对象在给定初始条件下，输入到输出的一个变换，即T:u→y   (y(0)=yo,j(0)=jo,…,yu-(0)=y%"-¹),n                    为系统阶次),y 为 n 阶可微函数。若在满足初始条
件的情况下，存在一个系统即变换个：y→u, 则称该系统为原系统的逆系统，即有
TTy=Tu=y                                        (8-94)
根据工程的可实现性要求，考虑y"(t)    到 u 的逆映射，可取
φ=y(t)                                                      (8-95)
若有系统 Ti:φ→u 使下式成立：
TTø=Tu=y                               (8-96)
则称该系统为原系统的L-阶积分逆系统。 设非线性系统的微分方程为






y(n)=f[y,y,…,y(a-1),u,u,…,u(m] 原系统的结构如图8-52所示。

图8-52 原非线性系统的结构 假设原非线性系统存在连续解
u(m)=g[y,y,…,y(m),u,ü,…,u(m-1)]
且满足原系统所给的初始条件，取φ=y("(t);则 n 阶积分逆系统结构如图8-53所示。

u(m)       u(m-1)




图8-53 n 阶积分逆系统结构图
3.伪线性系统


(8-97)










(8-98)

将n 阶积分逆系统和原系统相串联构成复合系统，称为伪线性系统。考虑到微分环节工程上 难以实现，故要求y,j,…,y(n-1)    或至少y("-1) 可测量。当仅有y(n-1)可测量时，需用n-2    个积分 器串联结构获取其余状态。y,y,…,y("-1)    均可测量时，伪线性系统的结构如图8-54所示。图8-54
(a) 为实现形式，图8-54(b) 为等效环节，因为变换
TTy(m)=                                                                       (8-99)
其拉氏变换为
                            (8-100)

图8-54 伪线系统结构
若y(n-1)不可测量，只有y 或 y") 可测量，则需设计状态观测器，请参阅有关文献。 例8-8 已知某非线性系统的数学模型为
·424 ·






y-2yy+2y²=u+2u                                                                   (8-101)
求对应的伪线性系统结构。 解 由原系统方程可得
                       (8-102)
取伪线性系统的输入为
φ=j
则逆系统方程为
                       (8-103)
将式(8-103)代入式(8-101)得
j=                                                                                  (8-104)
                            (8-105)


伪线性系统等效为二重积分环节，其实现形式 如图8-55所示。图中符号“区”表示乘法器。 4.非线性控制的逆系统设计方法
伪线性系统是非线性系统反馈线性化的结 果，表现为n 重积分环节的标准形式。为对系统 实施有效控制，还需在伪线性系统的基础上，设 计外环控制网络。可根据控制要求，确定控制结 构和控制器参数。
(1)状态反馈控制
设 y,y,…,y(n-1)可测量，因此可取状态反 馈控制器如图8-56所示。其中
φ=r-v,
反馈网络传递函数为



图8-55 例8-8伪线性系统的实现


                      (8-106)






图8-56 基于伪线性系统的反馈控制


(8-107) 若要求通过外环状态反馈控制器使闭环系统极点位
于给定位置，即有
(8-108)

则由图8-56,系统闭环传递函数又为


(8-109)

比较式(8-108)和式(8-109)的分母多项式关于s 的同次幂的系数，可得





k;=a;                      i=0,1,…,n-1                                                     (8-110)
(2)渐近跟踪控制
状态反馈可使系统具有较好的动态性能，但对形如 的多项式输入，不能保证
的无静差跟踪。根据时域分析法结果，应使系统开环传递函数具


±   e       G₂(s)    x±        
v
H(s)

图8-57 渐近跟踪控制结构
通过选择控制器参数b;(i=0,1,…,l+-1)


有一定的积分环节个数，可采用图8-57所示的控 制结构，即采用串联与局部反馈的综合控制形式。
其中G(s)   为串联控制器，具有如下形式：
        (8-111)
设置闭环零点和选择参数k;(i=0,1,…,n-1)          设置

闭环极点，可使闭环系统渐近稳定且具有满意的动态特性。
例8-9 对于例8-8所示二阶伪线性系统，要求实现位置跟踪控制，试确定控制器结构和参 数。
解 位 置 输 入r(t )=ro · 1(t), 即有l=0, 故取
        H(s)=ko+k₁s                                              (8-112)


若选定闭环极点s₁=-0,S₂,3=-5wn±jan√ 1-5²(5<1),              则闭环特征方程为 (s+σ)(s²+25wns+w²)=s³+(σ+25wn)s²+(w²+25w,O)s+σw²=0(8-113)
而由给定的控制器结构，系统闭环传递函数

故有控制器参数

特殊地，选择

则得
此时系统闭环传递函数为








(8-114)













(8-115)


8-6   非线性控制系统设计

例8-10 恒温箱温度控制。设恒温箱动态结构图如图8-58所示。若要求温度保持200℃,恒






温箱由常温20℃启动，试在T-T 。相平面上作出温度控制的相轨迹，并计算升温时间和保持温度 的精度，最后进行MATLAB  验证。
200℃
00+1
6




图8-58 恒温箱结构图 解 由图8-58可得系统分段微分方程为

相应的相轨迹如图8-59所示。相轨迹在开关线上跳至另一条相轨迹。


升温时间：在升温时，相轨迹沿图8-59中AB 运动。AB 段对应的相轨迹方程为



MATLAB  验证：应用MATLAB   软件包，在Simulink   环境下搭建如图8-60所示的温控系统仿真模型，其中 MATLAB    Function环节的调用函数为M 文 件fun.m, 运



图8-59 恒温箱温度控制系统

行它可在相平面上精确绘出T.-T.     相轨迹，同时也可绘出恒温箱温度控制系统的时间响应曲
线，如图8-61中的(a),(b)    所示，最后测得：升温时间t,=36.96s,     保温精度为±5℃。
MATLAB     Function环节的调用函数： function y=fun(u)
if((u(2)>=5)|((u(2)>=-5)&(u(1)>=0))) y=110;
else  y=0 end
例8-11 设变增益控制系统的结构图如图8-62所示。试用相平面法研究系统在斜坡输入 r(t)=V ·t 作用下的相轨迹，并分析采用变增益放大器对系统稳态误差的影响。 其 中 ，k=0.1,eo=0.6,K=5,T=0.49;V       可分别取为0.2,0.5及4。最后要求进行MATLAB
验证。







图8-60 Simulink  环境下的温控系统仿真模型



T. (a)



(b)

图8-61 温控系统的相轨迹及其时间响应(MATLAB)



图8-62 变增益系统结构图
-c, 其初始条件为e(0)=0,e(0)=V。 整理上述关系式后可得


解假设开始时系统处于静止状态 ， 即 c(0)=0,c(0)=0
则描述系统的微分方程为
Tc+c=Ku
其中

e.=r-c
因 为r(t)=V ·t,    故 有e=Vt-c,e=V-c,e=

Te+e+Ke=V,                           |e|>eo
Te+e+kKe=V,|e|<eo
开 关 线 为 |e|=eo。
在 相 平 面 的I 区 (le|<eo),         描 述 系 统 的 微 分 方 程 为






奇点在处(称为P₁  点),是稳定节点。
在相平面的I 区(e>eo)  和Ⅲ区(e<-eo),     描述系统的微分方程为

奇点在      处(称为P₂  点),是稳定焦点。因为k<1,    所以P₂  总 在P₁  的左边。当V 取不同数
值时，这两个奇点可能处于相平面上的不同区域。其中T=0.49,K=5,k=0.1,eo=0.6。
当 V<kKe 。 时，有,即奇点P₁  和 Pz 均 在I 区内。绘制相应的概略相轨迹如
图8-63(a) 所示(取V=0.2) 。 系统以非周期运动形式由初始点A(0,0.2)    运动到平衡位置P₁   (0.4,0),稳态误差en(∞)=0.4, 与线性放大器情况相比较(稳态误差为 ),稳态误差增
大了。








(a)









(b)                                                     (c)
图8-63 变增益控制系统相轨迹

当kKe₀<V<Ke 。 时 ，      4          ,即奇点P₁  在Ⅱ区内，P₂ 在 I  区内。因为P₁  是 I  区
内相轨迹的奇点，现在又位于I  区，故P₁  是虚奇点，P₂ 是实奇点。绘制相应的概略相轨迹如 图8-63(b) 所示(取V=0.5) 。 从图上可以看出，当相轨迹由A(0,0.5)    运动到B 点，相轨迹进行 转换，原来的相轨迹不能运动至奇点P₁ 。 新相轨迹的奇点P₂  又 在I  区内，当相轨迹由B 转移到 C 时又发生转换，使I  区相轨迹不能趋向于P₂  点。所以，系统的稳态误差表现出振荡特性，最终
平衡在(eo,0) 处，稳态误差就是eo。在现在所取参数下，稳态误差为0.6,与线性放大器相比(稳态 误差为,稳态误差增大了。
·429 ·





当V>Keo 时 ，,即奇点P₁ 和 P₂ 均 在I 区，所以P₁ 是实奇点，P₂ 是虚奇点。绘
制相应的相轨迹如图8-63(c)所示(取V=4)。 由图可见，从A(0,4)出发的相轨迹收敛于稳定焦点 P₂,P₂   的横坐标就是稳态误差，即,与线性放大器时的情况相同。所以，在这种 情况(V>Keo)  下，引入非线性放大器不会增加斜坡响应的稳态误差。
以上分析表明，只有在大斜坡输入量(V>Keo)  的情况下，引入变增益放大器才会使稳态误 差与线性放大器情况时的稳态误差相同。除此之外，在小或中斜坡输入量情况下，稳态误差均增 大。斜坡输入量越低，两者相差越大。可见，引入变增益放大器后没有使系统的稳态误差减小，在 有些情况下，反而使稳态误差增大了。
MATLAB 验证：因
T=0.49,K=5,k=0.1,eo=0.6 故应用MATLAB 可作出系统相轨迹如下：
global KTV                                     %设定全局变量参数
K=5;V=0.5;T=0.5;
G=tf([K],[T      10]);                          %线性开环传递函数


sys=feedback(G,1); t=0:0.01:7;
u=V*t;
c=lsim(sys,u,t,0); el=u'-c;
e0=[00.2];
[t,e2]=ode45('sys',t,e0); figure(1)
plot(e2(:,1),e2(:,2));grid figure(2)
plot(t,el,:',t,e2(:,1));grid
调用函数：sys.m
function de=sys(t,e) global KTV
e01=0.6;k=0.1; del=e(2);
if(abs(e(1))>e01)


%线性闭环传递函数 %设定仿真时间为7s  %输入r(t)=V·t
%线性闭环系统输出 %线性闭环系统输出
%设定非线性闭环系统的误差初始条件 %求解非线性系统微分方程

%绘制相轨迹

%绘制非线性环节加入前后的e(t)曲线

%描述非线性系统的微分方程 %说明全局变量参数

de2=(V-e(2)-K*e(1))./T;
else         de2=(V-e(2)-k*K*e(1))./T;
end
de=[del   de2];
当V=0.2   时，变增益系统在斜坡输入下的相轨迹如图8-64(a) 所示，可见e(∞)=0.4;        而非
线性环节加入前后的e(t) 曲线分别如图8-64(b) 中的虚线和实线部分所示。
当V=0.5   时，变增益系统在斜坡输入下的相轨迹如图8-65(a) 所示，可见e()=0.6;           而非
线性环节加入前后的e(t)曲线分别如图8-65(b)中的虚线和实线部分所示。







c  (a)



1   (b)

图8-64 V=0.2  时的相轨迹及误差响应曲线(MATLAB)

(a)                                                                                                     (b)
图 8 - 6 5 V=0.5        时 的 相 轨 迹 及 误 差 响 应 曲 线(MATLAB)
当V=4  时，变增益系统在斜坡输入下的相轨迹如图8-66(a) 所示，可见e,(∞)=0.8 。  而非线
性环节加入前后的e(t) 曲线分别如图8-66(b) 中的虚线和实线部分所示。



(a)



1   (b)


图 8 - 6 6 V=4      时 的 相 轨 迹 及 误 差 响 应 曲 线(MATLAB)
例8-12 带死区的仪表伺服机构控制。带有弹簧轴的仪表伺服机构的结构如图8-67所示。 试用描述函数法并应用MATLAB 确定线性部分为下列传递函数时系统是否稳定?是否存在自 振?若有，参数是多少?

·431·

不






图8-67 仪表伺服系统
解 应 用MATLAB  仿真法进行求解
(1)死区非线性描述函数
由表8-1知

(2)稳定性分析基础
非线性系统闭环特征方程为

在复平面上，下列结论成立：
若G(jw) 曲 线Tc 与负倒描述函数-1/N(A)  曲线不相交，则当Tc 曲线不包围- 1/N(A)  曲 线时，非线性系统稳定；当Ic 曲线包围- 1/N(A) 曲线时，非线性系统不稳定。
若G(jw) 曲 线Ic  与负倒描述函数-1/N(A)  曲线存在交点，则在交点处，当-1/N(A)  曲 线 沿振幅A 的增加方向由不稳定区域进入稳定区域时，该交点对应的自振是稳定的；当-1/N(A)   沿A 的增加方向由稳定区域进入不稳定区域时，该交点对应的自振是不稳定的。自振振幅A 由 交点处- 1/N(A)  上振幅确定；自振频率wo由交点处G(jw) 上的频率确定。
(3)MATLAB    程 序
1)绘制系统的Ic  和 - 1/N(A)  曲线
clc;clear
G1=tf([4000],[2003010]); G2=tf([20],[1010]);
A=1.0001:0.001:1000;
x=real(-1./((2*((pi./2)-asin(1./A)-(1./A),*sqrt(1-(1./A),^2)))/pi+j*0));   y=imag(-1./((2*((pi./2)-asin(1./A)-(1./A).*sqrt(1-(1./A).^2)))/pi+j*0)); %when the system isG1
figure(1)
w=0.001:0.001:1;
nyquist(G1,w);hold on plot(x,y);hold off





axis([-600000-4000040000]) %when the system is G2
figure(2)
w=0.001:0.001:20;
nyquist(G2,w);hold  on plot(x,y);hold  off
axis([-30-0.10.1])
2)当初始条件c(0)=2     时，绘制系统的零输入响应曲线
t=0:0.01:8;
c01=[200  了；
[t,cl]=ode45('sysI',t,c01); figure(1)
plot(t,cl(:,1));grid %
t=0:0.01:120; c02=[20];
[t,c2]=ode45('sys2',t,c02); figure(2)
plot(t,c2(:,1));grid
调用函数：当仪表伺服系统
function    dc=sys1(t,c) dcl=c(2);
de2=c(3); if(c(1)>1)
de3=-0.15*c(3)-0.005*c(2)-20*c(1)+20; elseif(abs(c(1))<1)
dc3=-0.15*c(3)-0.005*c(2); else
de3=-0.15*c(3)-0.005*c(2)-20*c(1)-20;
end
dc=[dc1  de2  de3];
调用函数：当仪表伺服系统 function    dc=sys2(t,c)
dcl=c(2);
if(c(1)>1)
dc2=-0.1*c(2)-2*c(1)+2; elseif(abs(c(1))<1)
de2=-0.1*c(2); else
de2=-0.1*c(2)-2*c(1)-2; end
dc=[dc1    dc2];
·433 ·





(4)仿真结果
曲线与- 1/N(A)  曲线，如图8-68(a) 所示；
当初始条件c(0)=2 时，系统的零输入响应如图8-68(b)所示。由图可知，仪表伺服系统在取 时，存在不稳定自振。令ImG(jw)=0,    得频率w=0.0707 。  同时由
,得振幅A=1.001。





云





Time/sec
(a)系统的T 和-1/N(A)曲线
时，有死区的仪表伺服系统特性(MATLAB)
曲线与- 1/N(A) 曲线，如图8-69(a)所示；当初始条件c(0)=2  时，系统的零输入响应如图8-69(b)所示。由图可见，Ic 曲线不包围-1/N(A) 曲线，仪表伺服系 统稳定。



Real Axis
(a)系统的厂和-1/M(A)曲线







S





Time/sec
(b)零输入时间响应

时，有死区的仪表伺服系统特性(MATLAB)






习      题

8-1 某线性系统的结构图如图8-70所示，试分别绘制下列三种情况时，变量e 的相轨迹， 并根据相轨迹分别作出相应的e(t)曲线。

上   ±  e±0

K₂s²

图8-70 题8-1的线性系统结构图
(1)J=1,K₁=1,K₂=2,             初始条件e(0)=3,e(0)=0;e(0)=1,e(0)=-2.5;  (2)J=1,K₁=1,K₂=0.5,              初始条件e(0)=3,e(0)=0;e(0)=-3,e(0)=0; (3)J=1,K₁=1,K₂=0,            初始条件e(0)=1,e(0)=1;e(0)=0,e(0)=2。
8-2 设一阶非线性系统的微分方程为
=-x+x³
试确定系统有几个平衡状态，分析各平衡状态的稳定性，并作出系统的相轨迹。
8-3 试确定下列方程的奇点及其类型，并用等倾线法或MATLAB  法绘制它们的相平面 图 ：
(1)ä+i+|x|=0;
(2)ä+x+signi=0;
(3)若+sinx=0;
(4)ä+|x|=0;

8-4 若非线性系统的微分方程为
(1)     +(3x-0.5)+x+x²=0;
(2)ä+xi+x=0;
(3)ä+x²+x=0。
试求系统的奇点，并概略绘制奇点附近的相轨迹。
8-5 非线性系统的结构图如图8-71所示，系统开始是静止的，输入信号r(t)=4 · 1(t), 试 写出开关线方程，确定奇点的位置和类型，作出该系统的相平面图，并分析系统的运动特点。

图8-71 题8-5的非线性系统结构图
8-6 变增益控制系统的结构图及其中非线性元件GN的输入输出特性如图8-72所示，设系
·435 ·






统开始处于零初始状态，若输入信号r(t)=R·1(t),         且R>eo                          ,试绘出系统的相平
面图，分析采用变增益放大器对系统性能的影响。已知系统参数：k=0.1,eo=0.6,K=5,T= 0.49。

(a)                                                                     (b)
图8-72 题8-6具有非线性放大器的系统
8-7 图8-73为一带有库仑摩擦的二阶系统，试用相平面法讨论库仑摩擦对系统单位阶跃 响应的影响。
8-8 设非线性系统如图8-74所示，输入为单位斜坡函数。试在e-e 平面上绘制相轨迹。



图8-73 题8-7有库仑摩擦的二阶系统
8-9 设非线性系统如图8-75所示，其中M=1,T=1。 1(t),   要求：


图8-74 题8-8的非线性系统
若输出为零初始条件，输入r(t)=

MI
r    ±0 e         5
-M

图8-75 题8-9的非线性系统
(1)在e-e 平面上画出相轨迹；
(2)判断该系统是否稳定，最大稳态误差是多少；
(3)绘出e(t)  及c(t)  的时间响应大致波形。
8-10 已知具有理想继电器的非线性系统如图8-76所示，试用相平面法分析：

r=10±      e          1+Ts


图8-76 题8-10具有理想继电器的非线性系统





(1)Ta=0  时 系统的运动；
(2)Ta=0.5  时系统的运动，并说明比例微分控制对改善系统性能的作用；
(3)Ta=2,     并考虑实际继电器有延迟时系统的运动。
8-11 非线性系统的结构图如图8-77所示，图中a=0.5,K=8,T=0.5,K,=0.5,      要求：

图8-77 题8-11的非线性系统
(1)当开关断开时，绘制初始条件为e(0)=2,e(0)=0         的相轨迹；
(2)当开关闭合时，绘制相同初始条件下的相轨迹，并说明测速反馈的作用。 8-12 设三个非线性系统的非线性环节一样，其线性部分分别为

用描述函数法分析时，哪个系统分析的准确度高? 8-13 试推导下列非线性特性的描述函数：
(1)变增益特性(见表8-1中第九项);
(2)具有死区的继电特性(见表8-1中第二项);
(3)y=x³。
8-14 将图8-78所示非线性系统简化成典型结构图形式，并写出线性部分的传递函数。

图8-78 题8-14的非线性系统结构图
8-15 根据已知非线性特性的描述函数求图8-79所示各种非线性特性的描述函数。

(a)                                   (b)                                                           (c)
图8-79 题8-15的非线性特性





8-16 某单位反馈系统，其前向通路中有一描述函数N(A)=e-7/A        的非线性元件，线性 部分的传递函数为G(s)=15/s(0.5s+1),         试用描述函数法确定系统是否存在自振?若有，参数是
多少?
8-17  已知非线性系统的结构图如图8-80所示，图中非线性环节的描述函数  (A>0),      试用描述函数法确定：
r=0 ±c          N(A)


图8-80 题8-17的非线性系统
(1)使该非线性系统稳定、不稳定以及产生周期运动时，线性部分的K 值范围；
(2)判断周期运动的稳定性，并计算稳定周期运动的振幅和频率。
8-18 非线性系统如图8-81所示，试用描述函数法分析周期运动的稳定性，并确定系统输 出信号振荡的振幅和频率。
书
r=0+   e0      5
o  o2

图8-81 题8-18的非线性系统
8-19 试用描述函数法说明图8-82所示系统必然存在自振，并确定c 的自振振幅和频率， 画出c,x,y    的稳态波形。
8-20 试用描述函数法和相平面法分析图8-83所示非线性系统的稳定性及自振。 8-21   已知非线性系统的输入和输出关系式
y+af(j,y,y)=i+bg(ù,u) 试求伪线性系统的结构及实现形式。


图8-82 题8-19的非线性系统             图8-83 题8-20的非线性系统
8-22 已知带速度反馈的非线性系统如图8-84所示。系统原来处于静止状态，且0<β<1, 输入r(t)=-R·1(t)(R>a),                试分别画出有速度反馈和无速度反馈时的系统相轨迹。
8-23    非线性系统如图8-85所示，其中非线性环节的描述函数 。试问：
(1)当r=0   时，系统受扰动后的稳定运动状态呈现什么形式?
(2)当r≠0   时，要使系统产生频率w=1,   幅 值A=2   的自振，t  与 K  应取何值?






图8-84 非线性系统


M=1
o
-1



图8-85 非线性系统
8-24  若要求图8-86所示非线性系统输出量c的自振振幅A=0.1,  角频率w=10,试确定 参数T 及 K 的数值(T,K   均大于零)。

√2F
0.x+)




图8-86 非线性系统结构图
8-25    设非线性系统如图8-87所示，其中参数K₁,K₂,T₁,T₂,M        均为正。试确定：
K
M-
o
-M



图8-87 非线性系统
(1)系统发生自振时，各参数应满足的条件；
(2)自振频率和振幅。



·439·








第九章线性系统的状态空间分析与综合

经典线性系统理论对于单输入-单输出线性定常系统的分析和综合是比较有效的，但其显著 的缺点是只能揭示输入-输出间的外部特性，难以揭示系统内部的结构特性，也难以有效处理多 输入-多输出系统。
在20世纪50年代蓬勃兴起的航天技术的推动下，1960年前后开始了从经典控制理论到现  代控制理论的过渡，其中一个重要标志就是卡尔曼系统地将状态空间概念引入到控制理论中来。 现代控制理论正是在引入状态和状态空间概念的基础上发展起来的。
现代控制理论中的线性系统理论运用状态空间法描述输入-状态-输出诸变量间的因果关 系，不但反映了系统的输入-输出外部特性，而且揭示了系统内部的结构特性，是一种既适用于单 输入-单输出系统又适用于多输入-多输出系统，既可用于线性定常系统又可用于线性时变系统 的有效分析和综合方法。
在线性系统理论中，根据所采用的数学工具及系统描述方法，又出现了一些平行的分支，目 前主要有线性系统的状态空间法、线性系统的几何理论、线性系统的代数理论、线性系统的多变 量频域方法等。由于状态空间法是线性系统理论中最重要和影响最广的分支，所以本章只介绍线 性系统的状态空间法。
9-1 线性系统的状态空间描述

1.系统数学描述的两种基本类型
·这里所谓的系统是指由一些相互制约的部分构成的整体，它可能是一个由反馈闭合的整体， 也可能是某一控制装置或被控对象。本章所研究的系统均假定具有若干的输入端和输出端，如图  9-1所示。图中方块以外的部分为系统环境，环境对系统的作用为系统输入，系统对环境的作用 为系统输出，二者分别用向量u=[u₁,u₂,…,up]T         和 y=[y₁,y₂,…,y,]T           表示，它们均为系统的
外部变量。描述系统内部每个时刻所处状况的变量为系统的内部变量，以向量x=[x₁,x₂, … , x.]T 表示。系统的数学描述是反映系统变量间因果关系和变换关系的一种数学模型。



图9-1 系统的方块图表示


系统的数学描述通常有两种基本类型。 一种是系统的外 部描述，即输入-输出描述。这种描述将系统看成为一个“黑 箱”,只是反映系统外部变量间即输入-输出间的因果关系，而 不去表征系统的内部结构和内部变量。系统描述的另一种类 型是内部描述，即状态空间描述。这种描述是基于系统内部结

构分析的一类数学模型，通常由两个数学方程组成： 一个是反映系统内部变量x=[x₁,I₂, … ,
x.]   和输入变量u=[u₁,u₂,…,up]            间因果关系的数学表达式，常具有微分方程或差分方程的
形式，称为状态方程；另一个是表征系统内部变量x=[x₁,x₂,…,x.]    及输入变量u=[u₁,u₂,
…,up]T 和输出变量y=[y₁,y₂,…,y,]             间转换关系的数学表达式，具有代数方程的形式，称为 输出方程。外部描述仅描述系统的外部特性，不能反映系统的内部结构特性，而具有完全不同内





部结构的两个系统也可能具有相同的外部特性，因而外部描述通常只是对系统的一种不完全的 描述。内部描述则是对系统的一种完全的描述，它能完全表征系统的所有动力学特征。仅当在系 统具有一定属性的条件下，两种描述才具有等价关系。
2.系统描述中常用的基本概念
无论是系统的外部描述还是系统的内部描述，下列的一些概念是常用的，现给出其定义，以 便读者在学习本章和阅读国内外有关文献时更清楚地理解系统的性质和分类。
输入和输出 由外部施加到系统上的全部激励称为输入，能从外部量测到的来自系统的信 息称为输出。
松弛性若系统的输出y(to,∞)    由输入u(to,○)    唯一确定，则称系统在t。时刻是松弛的。从 能量的观点看，系统在t。时刻是松弛的意味着系统在to 时刻不存储能量。例如一个RLC 网络，若 所有电容两端的电压和流过电感的电流在to时刻均为零(即初始条件为零),则称网络在to时 刻 是松弛的。若网络不是松弛的，则其输出不仅由输入决定，而且与初始条件有关。
对于一个松弛系统，其输入-输出描述为
y=Hu                                                                          (9-1)
式 中H  为某一算子，例如传递函数就是一种算子。
因果性若系统在t 时刻的输出仅取决于在t 时刻和t 之前的输入，而与t 时刻之后的输入无 关，则称系统具有因果性或因果关系(causal)。本书中所研究的实际物理系统均具有因果性，并 称为因果系统。若系统在t时刻的输出尚与t时刻之后的输入有关，则称系统不具有因果性。不具 有因果性的系统能够预测t时刻之后的输入并施加于系统而影响其输出。
线性一个松弛系统当且仅当对于任何输入u₁ 和 u₂以及任何实数α均有
H(u₁+u₂)=Hu₁+Hu₂                                                                   (9-2)
H(au₁)=αH(u₁)                                                                    (9-3) 则该系统称为线性的，否则称为非线性的。式(9-2)称为可加性，式(9-3)称为齐次性。若松弛系统 具有这两种特性，则称该系统满足叠加原理。
时不变性(定常性)一个松弛系统当且仅当对于任何输入u 和任何实数α,均有
HQu=Q.Hu                                                                       (9-4) 则该系统称为定常的或时不变的，否则称为时变的。式中Q。为位移算子，Qau 表示对于所有t 均有
Qau(t)=u(t-α)                                                                       (9-5)
式(9-4)又可写为
HQu=Qy                                                                       (9-6) 线性时不变(定常)系统数学方程中各项的系数必为常数，只要有一项的系数是时间的函数，则系 统是时变的。
3.系统状态空间描述常用的基本概念
在系统状态空间描述中常用如下的一些基本概念。
状态和状态变量系统在时间域中的行为或运动信息的集合称为状态。确定系统状态的一 组独立(数目最小)变量称为状态变量。
一 个用n 阶微分方程描述的系统，当n 个初始条件x(to),x(to),…,x(m-1)(to),及t≥to的 输
入u(t)  给定时，可唯一确定方程的解，即系统将来的状态，故x(t),x(t),…,x(n-1)(t)         这n 个独立





变量可选作状态变量。状态变量对于确定系统的行为既是必要的，也是充分的。n 阶系统状态变 量所含独立变量的个数为n。显然，当变量个数小于n 时，便不能完全确定n 阶系统的状态，而当 变量个数大于n 时，对于确定系统的状态有的变量则是多余的。
状态变量的选取不具有唯一性，同一个系统可能有多种不同的状态变量选取方法。状态变量 也不一定在物理上可量测，有时只具有数学意义，而无任何物理意义。但在具体工程问题中，应尽 可能选取容易量测的量作为状态变量，以便实现状态的前馈和反馈等设计要求。例如，机械系统 中常选取线(角)位移和线(角)速度作为变量，RCL 网络中则常选取流经电感的电流和电容的端 电压作为状态变量。
状态变量常用符号x₁ (t),x₂ (t),…,xn(t)表示。
状态向量把描述系统状态的n 个状态变量x₁(t),x₂(t),…,rn(t)         看作向量x(t)  的分量，即
x(t)=[x₁(t),x₂(t),…,xn(t)]
则向量x(t)称为n 维状态向量。给定t=to 时的初始状态向量x(to)及t≥to的输入向量u(t),则 t≥to的状态由状态向量x(t)唯一确定。
状 态 空 间 以n 个状态变量作为基底所组成的n 维空间称为状态空间。
状态轨线系统在任一时刻的状态，在状态空间中用一点来表示。随着时间推移，系统状态 在变化，便在状态空间中描绘出一条轨迹。这种系统状态在状态空间中随时间变化的轨迹称为状 态轨迹或状态轨线。
状态方程描述系统状态变量与输入变量之间关系的一阶微分方程组(连续时间系统)或一 阶差分方程组(离散时间系统)称为系统的状态方程。状态方程表征了系统由输入所引起的内部 状态变化，其一般形式为
x(t)=f[x(t),u(t),t]                                                                      (9-7)
或                           x(tk+1)=f[x(t),u(t),t]                                                                   (9-8)
输出方程描述系统输出变量与系统状态变量和输入变量之间函数关系的代数方程称为输 出方程，其一般形式为
y(t)=g[x(t),u(t),t]                                                                     (9-9)
或                            y(t)=g[x(t),u(t),tk]                                                                   (9-10)
输出方程表征了系统内部状态变化和输入所引起的系统输出变化，它是一个变换过程。
状态空间表达式状态方程与输出方程的组合称为状态空间表达式，又称动态方程，其一般 形式为

	x(t)=f[x(t),u(t),t] y(t)=g[x(t),u(t),t]	(9-11)
或	x(tk+1)=f[x(tk),u(th),t]	
	y(t)=g[x(th),u(t),tk]	(9-12)


自治系统若在系统的状态空间表达式中，函数f
自治系统，其状态空间表达式的一般形式为
x(t)=f[x(t),u(t)]  y(t)=g[x(t),u(t)]


和g 均不显含时间t 或 th, 则称该系统为

(9-13)



或


x(tk+1)=f[x(t),u(ta)] y(th)=g[x(t),u(t)]



(9-14)





线性系统若在系统的状态空间表达式中，f 和g 均是线性函数，则称系统为线性系统，否 则为非线性系统 。
线性系统的状态空间表达式线性系统的状态方程是一阶向量线性微分方程或一阶向量线 性差分方程，输出方程是向量代数方程。线性连续时间系统状态空间表达式的一般形式为

x(t)=A(t)x(t)+B(t)u(t) y(t)=C(t)x(t)+D(t)u(t)


(9-15)

对于线性离散时间系统，由于在实践中常取t=kT(T  为采样周期),其状态空间表达式的一般
形式可写为
.x(k(k)x)x(k(k)+)(k(k)u)u(k(k))                                 (9-16)
通常，若状态x、输入u、输出y 的维数分别为n,p,q,   则称n×n   矩阵A(t)  及G(k)  为系统矩 阵或状态矩阵或系数矩阵，称n×p   矩阵B(t)  及H(k)  为控制矩阵或输入矩阵，称q×n  矩阵C(t)   及 C(k)为观测矩阵或输出矩阵，称q×p 矩阵D(t)及D(k) 为前馈矩阵或输入输出矩阵。
线性定常系统在线性系统的状态空间表达式中，若系数矩阵A(t),B(t),C(t),D(t)          或  G(k),H(k),C(k),D(k)        的各元素都是常数，则称该系统为线性定常系统，否则为线性时变系统。

线性定常系统状态空间表达式的一般形式为	
i(t)=Ax(t)+Bu(t)  y(t)=Cx(t)+Du(t)	(9-17)
或                          x(k+1)=Gx(k)+Hu(k)	
y(k)=Cx(k)+Du(k)	(9-18)
当输出方程中D=0  时，系统称为绝对固有系统，否则称为固有系统。为书写方便，常把固有 系统(9-17)或(9-18)简记为系统(A,B,C,D) 或系统(G,H,C,D), 而记相应的绝对固有系统为系 统(A,B,C)  或系统(G,H,C)。
线性系统的结构图线性系统的状态空间表达式常用结构图表示。线性连续时间系统 (9-17)的结构图如图9-2所示，线性离散时间系统(9-18)的结构图如图9-3所示。结构图中I 为 n×n 单位矩阵，s 是拉普拉斯算子，x- ¹ 为单位延时算子，s和z 均为标量。每一方块的输入-输出关 系规定为
输出向量=(方块所示矩阵)×(输入向量) 应注意到在向量、矩阵的乘法运算中，相乘顺序不允许任意颠倒。

图9-2 线性连续时间系统结构图                     图9-3 线性离散时间系统结构图
状态空间分析法在状态空间中以状态向量或状态变量描述系统的方法称为状态空间分析 法或状态变量法。状态空间分析法的优点是便于采用向量、矩阵记号简化数学描述，便于在数字





机上求解，容易考虑初始条件，能了解系统内部状态的变化特性，适用于描述时变、非线性、连续、 离散、随机、多变量等各类系统，便于应用现代设计方法实现最优控制、自适应控制等。
4.线性定常连续系统状态空间表达式的建立
建立状态空间表达式的方法主要有两种： 一是直接根据系统的机理建立相应的微分方程或 差分方程，继而选择有关的物理量作为状态变量，从而导出其状态空间表达式；二是由已知的系 统其他数学模型经过转化而得到状态空间表达式。微分方程和传递函数是描述线性定常连续系 统常用的数学模型，后面我们将介绍已知n 阶系统微分方程或传递函数时导出状态空间表达式 的一般方法，以便建立统一的研究理论，揭示系统内部固有的重要结构特性。
(1)根据系统机理建立状态空间表达式
下面通过例题来介绍根据系统机理建立线性定常连续系统状态空间表达式的方法。
例9-1 试列写如图9-4所示RLC 网络的电路方程，选择几组状态变量并建立相应的状态 空间表达式，并就所选状态变量间的关系进行讨论。



图9-4 RLC 网络


解根据电路定律可列写如下方程：

电路输出量为


1)设状态变量 ,则状态方程为



输出方程为
其向量-矩阵形式为


y=I2






简记为


式中




x=Ax+be y=cx





2)设状态变量x₁=i,

3)设状态变量                9                              , 则
x₁=x₂+Ri,             
故


y=I₂
其向量-矩阵形式为


由上可见，系统的状态空间表达式不具有唯一性。选取不同的状态变量，便会有不同的状态 空间表达式，但它们都描述了同一系统。可以推断，描述同一系统的不同状态空间表达式之间一 定存在着某种线性变换关系。现研究本例题中两组状态变量之间的关系。


设 x₁=i,


2

x₁=   云 ，






其相应的向量-矩阵形式为
x=Px
其 中                        
以上说明只要令x=Px,P       为非奇异变换矩阵，便可将x₁,x₂   变换为云，元2。若取任意的非奇异变 换阵P,  便可变换出无穷多组状态变量，这就说明状态变量的选择不具有唯一性。对于图9-4所示 RLC 网络来说，由于电容端电压和电感电流容易测量，通常选择这些物理量作为状态变量。
(2)由系统微分方程建立状态空间表达式
按系统输入量中是否含有导数项来分别研究。
1)系统输入量中不含导数项。这种单输入-单输出线性定常连续系统微分方程的一般形 式为
ym)+a-1yn-1)+an-2ya-2)+…+a₁y+aoy=βou                                                   (9-19)





式中，y,u 分别为系统的输出、输入量；ao,a₁,…,an-1,βo是由系统特性确定的常系数。由于给定 n 个初值y(0),j(0),…,y"-¹(0)        及t≥0   的 u(t)  时，可唯一确定t>0  时系统的行为，可选取n 个状 态变量为x₁=y,x₂=j,…,x=y"-),               故式(9-19)可化为



其向量-矩阵形式为
x=Ax+bu y=cx
式中





(9-20)





(9-21)


c=[10                …0]
按式(9-20)绘制的结构图称为状态变量图，见图9-5。每个积分器的输出都是对应的状态变量，状 态方程由各积分器的输入-输出关系确定，输出方程在输出端获得。

图9-5 系统结构图
2)系统输入量中含有导数项。这种单输入-单输出线性定常连续系统微分方程的一般形 式为
y("+an-1y("-1)+an-2yn-2)+…+a₁y+aoy
=bnu("+bn-1u(n-1)+…+b₁ü+bou                                                          (9-22) 一般输入导数项的次数小于或等于系统的阶数n。首先研究bn≠0 时的情况。为了避免在状态方 程中出现输入导数项，可按如下规则选择一组状态变量，设




其展开式为





(9-23)








(9-24)



式中，ho,h₁,hz,…,h-1    是n 个待定常数。由式(9-24)的第一个方程可得输出方程

其余可得n-1   个状态方程





对x  求导数并考虑式(9-22),有
=y(")   一hou(m-h₁u("-1)-…-hn-1u=(-an-1yn-1)-a-2y(n-2) - …-a₁y-aoy+bou("+…+b₁u+bou)-hou(")-h₁u(n-1)
- …-h-1u
由式(9-24)将y(n-1),…,j,y    均以xi 及 u 的各阶导数表示，经整理可得 in=-aox₁-a₁x₂-…-an-2xn-1-an-1cn+(bn-ho)u(")
+(bn-1-h₁-an-Iho)u(n-1)+(bn-2-h₂-a-1h₁-an-zho)u(n-2) 十 … +(b₁-h-1-an-1hn-2-an-zhn-3-…-a₁ho)ü
+(b₀-a-1h-1-an-zhn-2-…-a₁h₁-a₀h₀)u
令上式中u 的各阶导数项的系数为零，可确定各h 值 ho=bn
h₁=bn-1-an-1h。
h₂=bn-z-an-Ih₁-an-zh。
:
hn-1=b₁-an-Ihn-2-an-zhn-3-…-a₁ho
记 h=bo-an-1hn-1-an-zhn-2-…-a₁h₁-a₀ho,                         故
文 = -aox₁-a₁T₂           …-an-zTn-1-an-1xn+hnu
则式(9-22)的向量-矩阵形式的动态方程为
x=Ax+bu,y=cx+du
式中

c=[10                          …0],d=h。





式(9-22)的状态变量图见图9-6。若输入量中仅含m 次导数且m<n,   可将高于m 次导数项的系 数置零，仍可应用上述所得公式。

图9-6 式(9-22)系统结构图
当bn=0 时，可以令上述公式中的ho=0 得到所需要的结果，也可按如下规则选择另一组状 态变量。设
               (9-26)
其展开式为
Tn-1=tn+an-1y-bn-1u=y+a-1y-bn-1u
Tn-2=in-1+an-2y-ba-2u=j+aʙ-1y-bn-1ü+an-2y-ba-2u :
x₂=i₃+a₂y-b₂u=y(n-2)+an-1yn-3)-bn-1u(n-3)+an-2y(n-4 -bn-2u(-4)+…+a₂y-b₂u
x₁=iz+a₁y-b₁u=y(n-1+an-1y"-2)-bn-1u(n-2)+an-2y"-3) -bn-2u(n-3)+…+a₁y-b₁u
故有(n-1)    个状态方程
n=Tn-1-an-1Tn+bn-1u
n-1=Tʙ-2-an-zTn+bn-2u :
i₂=x₁-a₁xn+b₁u 对x₁ 求导数且考虑式(9-22),经整理有
i₁=-aoxn+bou
则式(9-22)bn=0  时的动态方程为
x=Ax+bu,              y=cx                                                    (9-27)
式中



例9-2 设二阶系统微分方程为
j+2Swy+w²y=Tu+u
试求系统状态空间表达式。
解设状态变量x₁=y-hou,xz=i-hiu=y-hou-hu,          故有
y=x₁+hou,i₁=x₂+h₁u 对xz 求导数且考虑x₁,xz  及系统微分方程有
i₂=j-hoii-h₁u=(-w²y-25wy+Tu+u)-hoii-h₁u
=-w²x₁-25wx₂-hoü+(T-25wh 。-h₁)ü+(1-w²h 。-25wh₁)u 令 ü ,i 项的系数为零可得
ho=0,           h₁=T  故                      iz=-w²x₁-25wx₂+(1-25wT)u
系统的状态空间表达式为

(3)由系统传递函数建立状态空间表达式 式(9-22)所对应的系统传递函数为
(9-28)
应用综合除法有
(9-29)
式 中 ，bn是直接联系输入与输出量的前馈系数，当G(s)  的分母次数大于分子次数时，bn=0,
是严格有理真分式，其系数由综合除法得到为
βo=bo-aob β₁=b₁-a₁bn :
βn-2=bn-2-an-2bn βa-1=bn-1-an-1b
下面介绍由导出几种标准形式动态方程的方法。
1)     串联分解的情况。将 分解为两部分相串联，如图9-7所示，z为中间变量，z,y
应满足



zm+an-1zn-¹+…+a₁ż+aoz=u y=β-1zn-1)+…+β₁ż+βoz

图9-7 的串联分解
选取状态变量
x₁=z,x₂=             之 ，x₃=     艺 ， … ,x=z(n-1)
则状态方程为
i₁=X₂
i₂=x₃
:
i=-aoz-a₁z-…-an-1z(n-1)+u  =-aox₁-a₁x₂-…-an-1xn+u
输出方程为
y=-βox₁-β₁x₂-…-βn-1xn
其向量-矩阵形式的动态方程为
x=Ax+bu,      y=cx                        (9-30)
式中

请读者注意A,b  的形状特征，这种A 阵又称友矩阵，若状态方程中的A,b 具有这种形式，则称为
可控标准型。当β=β₂= … =βa-1=0   时 ，A,b 的形式不变，c=[β 。0              …0]。
时 ，A,b 不变，y=cx+bnu 。 串联分解时的可控标准型状态
变量图如图9-8所示。
当bn=0    时，若按式(9-26)选取状态变量，则系统的A,b,c  矩阵为

请读者注意A,c 的形状特征，此处A 阵是友矩阵的转置。若动态方程中的A,c 具有这种形式，则 称为可观测标准型。
由上可见，可控标准型与可观测标准型的各矩阵之间存在如下关系：







图9-8 串联分解的可控标准型状态变量图
A.=A?,b₆=c,c=b7                                                                   (9-31) 式中，下标c 表示可控标准型；o 表示可观测标准型；T 为转置符号。式(9-31)所示关系称为对偶 关系。关于系统的可控和可观测等概念，后面还要进行较详细的论述。
例9-3 列写例9-2所示系统的可控标准型、可观测标准型动态方程，并分别确定状态变量 与输入、输出量的关系。
解该系统的传递函数为

可控标准型动态方程的各矩阵为
,c=[1
由G(s)  串联分解并引入中间变量z 有
芝+25wz+w²z=u y=T   之+z
对y 求导数并考虑上述关系式则有
y=T  艺+之=(1-25wT)z-w²Tz+Tu
令xa=2,xcz=   之，可导出状态变量与输入、输出量的关系： xc=[-Ty+(1-25WT)y+T²u]/(1-25wT+w²T²)  xc=(y+w²Ty-Tu)/(1-25wT+w²T²)
可观测标准型动态方程各矩阵为
,c 。=[o
根据式(9-26)可以写出状态变量与输入、输出量的关系 Xo=y+25wy-Tu
Xo2=y
图9-9与图9-10分别示出了该系统可控标准型与可观测标准型的状态变量图。






图9-9 例9-3可控标准型状态变量图                 图9-10 例9-3可观测标准型状态变量图


2)



只含单实极点时的情况。当


只含单实极点时，除了可化为上述可控标准型或

可观测标准型动态方程以外，还可化为对角型动态方程，其A 阵是一个对角阵。 设D(s)   可分解为
D(s)=(s-λ₁)(s             一λ2)…(s-λ)
式中，λ,…,λ。为系统的单实极点，则传递函数可展成部分分式之和

在极点入处的留数，且有

若令状态变量
;i=1,2,…,n
其反变换结果为
i;(t)=λx;(t)+u(t)

展开得                     i₁=λ₁x₁+u
i₂=λ₂zz+u

i=λxn+u
y=C₁I₁+c₂X₂+…+cnTn
其向量-矩阵形式为


(9-32)





其状态变量图如图9-11(a)所示。 若令状态变量
;i=1,2,…,n
则
进行反变换并展开有
i=λ₁x₁+c₁u
i₂=λ2xz+c₂u
垂 垂 垂
in=λxn+Cnu
y=x₁+x₂+ …              十 xn
其向量-矩阵形式为


(9-33)


其状态变量图如图9-11(b) 所示。显见式(9-33)与式(9-32)存在对偶关系。










(a)                                                                     (b)
图9-11 对角型动态方程的状态变量图
3) 含重实极点时的情况。当传递函数除含单实极点之外还含有重实极点时，不仅可化
为可控、可观测标准型，还可化为约当标准型动态方程，其A 阵是一个含约当块的矩阵。设D(s) 可分解为
D(s)=(s-λ1)³(s-λ)…(s-λ)
式中，λ₁为三重实极点；λ4,…,λ。为单实极点，则传递函数可展成下列部分分式之和：

其状态变量的选取方法与只含单实极点时相同，可分别得出向量-矩阵形式的动态方程：







y=[001        1     …1]x
其对应的状态变量图如图9-12(a),(b)   所示。式(9-34)与式(9-35)也存在对偶关系。 5.线性定常连续系统状态方程的解
(1)齐次状态方程的解 状态方程
x(t)=Ax(t)
称为齐次状态方程，通常采用幂级数法和拉普拉斯变换法求解。
1)幂级数法。设状态方程式(9-36)的解是t 的向量幂级数 x(t)=bo+b₁t+b₂t²+ …+bAt*+ …
式中，x,bo,b₁, …,b, …       都 是n 维向量，则
x(t)=b₁+2b₂t+…+kbt-¹+ …
=A(b₀+b₁t+b₂t²+…+bAt*+…)
令上式等号两边t 的同次项的系数相等，则有
b₁=Ab₀

:

:
且x(0)=bo,  故







(9-34)








(9-35)









(9-36)





















(9-37)




















(b)
图9-12 约当型动态方程的状态变量图
定义                    
                                      (9-38)
则                                 x(t)=eAx(0)                                                                  (9-39)
由于标量微分方程i=ax      的 解 为x(t)=e"x(0),e           “称为指数函数，而向量微分方程式 (9-36)具有相似形式的解(式(9-39)),故把eA 称为矩阵指数函数，简称矩阵指数。由于x(t)是 由 x(0)  转移而来，对于线性定常系统，eA 又称为状态转移矩阵，记为更(t),  即
Φ(t)=eA                                                                     (9-40)
2)拉普拉斯变换法。将式(9-36)取拉氏变换，有
sX(s)=AX(s)+x(0) 则                               (sI-A)X(s)=x(0)
X(s)=(sI-A)-¹x(0)                                                                 (9-41)
进行拉氏反变换有





x(t)=-¹[(sI-A)-¹]x(0)                                                                         (9-42)
与式(9-39)相比有
eA=-'[(sI-A)-¹]                                                                             (9-43)
式(9-43)给出了e^'的闭合形式，说明了式(9-38)所示级数的收敛性。
从上述分析可看出，求解齐次状态方程的问题，就是计算状态转移矩阵Φ(t)   的问题，因而有 必要研究Φ(t)  的运算性质。
(2)状态转移矩阵的运算性质
重写状态转移矩阵Φ(t)  的幂级数展开式
             (9-44)
Φ(t)具有如下运算性质：
1)Φ(0)=I                                                                                                                                             (9-45)
2)Φ(t)=AΦ(t)=Φ(t)A                                                                                                                            (9-46)
上述性质利用式(9-44)很容易进行证明。式(9-46)表明，AD(t) 与 Φ(t)A 可交换，ψ(0)=A, 并且Φ(t)  是微分方程
Φ(t)=AΦ(t),Φ(0)=I                                                                          (9-47)
的唯一解。
3)Φ(t₁ ±t₂)=Φ(t₁)    更(±t₂)=Φ(±t₂)   更(t₁)                               (9-48)
令式(9-44)中t=t₁±t₂,        便可证明这一性质。Φ(t₁),Φ(t₂),       更(t₁±t₂)       分别表示由状态x(0)
转移至状态x(t₁),x(t₂),x(t₁±t₂)              的状态转移矩阵。该性质表明更(t₁±t₂)        可分解为更(t₁)    与
Φ(±t₂)       的乘积，且Φ(t₁)  与Φ(±t₂)  是可交换的。
4)Φ-¹(t)=Φ(-t),Φ-¹(-t)=Φ(t)                                                                                                                  (9-49)
证 明 由性质3)有
Φ(t-t)=Φ(t)Φ    ( 一t)=Φ(-t)    更(t)=I
根据逆矩阵的定义可得式(9-49)。
根据更(t)   的这一性质，对于线性定常系统，显然有 x(t)=Φ(t)x(0),x(0)=Φ-¹(t)x(t)=Φ(-t)x(t)


这说明状态转移具有可逆性，x(t)   可 由x(0)   转移而来，x(0)   也 可 由x(t)    转移而来。 5)x(t₂)=Φ(t₂-t₁)x(t₁)
证 明  由 于
x(t₁)=Φ(t₁)x(0),x(0)=Φ-¹(t₁)x(t₁)=Φ(-t₁)x(t₁)
则             x(t₂)=Φ(t₂)x(0)=Φ(t₂)                   更 ( -t₁)x(t₁)=        更(t₂-t₁)x(t₁)
即 由x(t₁)   转 移 至x(t₂)   的状态转移矩阵为Φ(t₂-t₁)。 6)Φ(t₂-to)=Φ(t₂-t₁)      更(t₁-to)
证 明  由 于
x(t₂)=Φ(t₂-to)x(to),x(t₁)=Φ(t₁-to)x(to)
x(t₂)=Φ(t₂-t₁)x(t₁)=Φ(t₂-t₁)Φ(t₁-to)x(to)
=Φ(t₂—to)x(t₀)



(9-50)





(9-51)






故式(9-51)成立。
根据转移矩阵的这一性质，可把一个转移过 程分为若干个小的转移过程来研究，如图9-13
所示。
7)[◎(t)]=Φ(kt)
证 明 由 于
[Φ(t)]=(eA')*=eAA=eA)=Φ(kt) 故式(9-52)成立。



图9-13 状态转移矩阵性质6)

8)若AB=BA,  则 ;若AB≠BA,  则e(A+B)≠eA'e'≠e'eA'。 证 明 由 于







只有当AB=BA 时，有e(A+B)-eA'e⁸'=0。
9 ) 若 Φ(t)  为x(t)=Ax(t)      的状态转移矩阵，则引入非奇异变换x=Px    后的状态转移矩
阵为
更(t)=P-¹eA'P                             (9-53)
证明  将x=Px  代入             有
Px=APx,x=P-¹APx
x(t)= 更(t)x(0)=eP⁻¹APx(0)

式中


因而式(9-53)成立。




10)两种常见的状态转移矩阵。设A=diag[λ,a₂,…,d。],即A 为对角阵，且具有互异元素，则








设 A 阵 为m×m






则



约当阵







(9-54)















(9-55)

用幂级数展开式即可证明式(9-54)和式(9-55)成立。 例9-4 设系统状态方程为

试求状态方程的解。
解用拉氏变换求解




状态方程的解为






(3)非齐次状态方程的解 状态方程
x(t)=Ax(t)+Bu(t) 称为非齐次状态方程，有如下两种解法。
1)积分法。由式(9-56)可得
e-A(x(t)-Ax(t))=e-A'Bu(t)
由于
积分可得

(9-57)
式中第一项是对初始状态的响应，第二项是对输入作用的响应。 若取to 作为初始时刻，则有


(9-58)
2)拉普拉斯变换法。将式(9-56)两端取拉氏变换，有
sX(s)-x(0)=AX(s)+BU(s) 则                          (sI-A)X(s)=x(0)+BU(s)
X(s)=(sI-A)-¹x(0)+(sI-A)-¹BU(s)
进行拉氏反变换，有
x(t)=L-¹[(sI-A)-¹]x(0)+L-¹[(sI-A)-¹BU(s)] 由拉氏变换卷积定理

在此将(sI-A)- ¹        视 为F₁(s),    将BU(s)  视 为F₂(s),    则有

结果与式(9-57)相同。上式又可表示为
(9-59)
有时利用式(9-59)求解更为方便。





例9-5 系统状态方程为

且x(0)=[x₁(0)x₂(0)] 。      试求在u(t)=1(t)       作用下状态方程的解。
解 由 于u(t)=1,u(t-t)=1,                  根据式(9-59)可得

由例9-4已求得





故

6.系统的传递函数矩阵
对于多输入-多输出系统，需要讨论传递函数矩阵。
(1)定义及表达式
初始条件为零时，输出向量的拉氏变换式与输入向量的拉氏变换式之间的传递关系称为传 递函数矩阵，简称传递矩阵。设系统动态方程为
x(t)=Ax(t)+Bu(t),y(t)=Cx(t)+Du(t)                                                        (9-60)
令初始条件为零，进行拉氏变换有
sX(s)=AX(s)+BU(s),Y(s)=CX(s)+DU(s) 则                X(s)=(sI-A)-¹BU(s)
Y(s)=[C(sI-A)-¹B+D]U(s)=G(s)Us)                                                       (9-61)
系统的传递函数矩阵表达式为
G(s)=C(sI-A)-¹B+D                                                             (9-62) 若输入u 为 p 维向量，输出y 为q 维向量，则G(s) 为q×p 矩阵。式(9-61)的展开式为

(9-63)

式中G;;(s)(i=1,2,…,q;j=1,2,…,p)                 表示第i 个输出量与第j 个输入量之间的传递函数。




例9-6 已知系统动态方程为


试求系统的传递矩阵。
解 已 知

故




(2)开环与闭环传递矩阵
设多输入-多输出系统结构图如图9-14所示。图中 U,Y,Z,E   分别为输入、输出、反馈、偏差向量；G,H  分别为 前向通路和反馈通路的传递矩阵。由图可知
Z(s)=H(s)Y(s)=H(s)G(s)E(s)                                      (9-64) 定义偏差向量至反馈向量之间的传递矩阵H(s)G(s)   为开



图9-14 多输入-多输出系统结构图

环传递矩阵，它描述了E(s)   至Z(s)  之间的传递关系。开环传递矩阵等于向量传递过程中所有部 件传递矩阵的乘积，其相乘顺序与传递过程相反，而且由于是矩阵相乘，顺序不能任意交换。
由于
Y(s)=G(s)E(s)=G(s)[U(s)-Z(s)] =G(s)[U(s)-H(s)Y(s)]
则                        Y(s)=[I+G(s)H(s)]-¹G(s)U(s)                                                          (9-65)
定义输入向量至输出向量之间的传递矩阵为闭环传递矩阵，记为Φ(s),  则
Φ(s)=[I+G(s)H(s)]-¹G(s)                                                              (9-66)
它描述了U(s)  至 Y(s)  之间的传递关系。 由于
E(s)=U(s)-Z(s)=U(s)-H(s)G(s)E(s)
则                           E(s)=[I+H(s)G(s)]-U(s)                                                                (9-67)
定义输入向量至偏差向量之间的传递矩阵为偏差传递矩阵，记为Φ。(s),则
Φ,(s)=[I+H(s)G(s)]- ¹                                                                 (9-68)
它描述了U(s)  至 E(s)   之间的传递关系。





(3)解耦系统的传递矩阵
将式(9-63)写成标量方程组
Y₁(s)=G(s)U₁(s)+G₁₂(s)U₂(s)+…+G₁p(s)Up(s)   Y₂(s)=G₂₁(s)U₁(s)+G₂₂(s)U₂(s)+…+G₂p(s)Up(s)
(9-69)
Y.S=GaCOU₁)+GaGV₂C)+…+GaCU,C)
可见一般多输入-多输出系统的传递矩阵不是对角阵，每一个输入量将影响所有输出量，而每一 个输出量也都会受到所有输入量的影响。这种系统称为耦合系统，其控制方式称为耦合控制。
对一个耦合系统进行控制是复杂的，工程中常希望实现某一输出量仅受某一输入量的控制， 这种控制方式称为解耦控制，其相应的系统称为解耦系统。解耦系统的输入向量和输出向量必有 相同的维数，传递矩阵必为对角阵，即


(9-70)


可以看出，解耦系统是由m 个独立的单输入-单输出系统
Y,(s)=G(s)U,(s);i=1,2,…,m                                                              (9-71) 组成。为了控制每个输出量，G(s)  不得为零，即解耦系统的对角化传递矩阵必须是非奇异的。在 系统中引入适当的校正环节使传递矩阵对角化，称为解耦。系统的解耦问题是一个相当复杂的问 题，研究解耦问题的人很多，解耦的方法也很多。下面介绍适用于线性定常连续系统的两种简单 解耦方法。
1)用串联补偿器G.(s) 实现解耦。系统结构图如图9-15所示。未引入G.(s) 时，原系统为耦合 系统，引入G. (s)后的闭环传递矩阵为
Φ(s)=[I+G₀(s)G.(s)H(s)]-¹G₀(s)G.(s)                                                      (9-72)
以[I+G₀ (s)G. (s)H(s)]   左乘式(9-72)两端，经整理有
G₀(s)G.(s)=          (s)[I-H(s)          更(s)]- ¹                                          (9-73)
式 中  (s)   为所希望的对角阵，阵中各元素与性能指标要求有关。由式(9-73)可见，在 H(s)    为 对角阵的条件下，[I-H(s)     (s)]-¹仍为对角阵，故G₀ (s)G. (s) 应为对角阵，且有
G.(s)=Go¹(s)Φ(s)[I-H(s)Φ(s)]                                                               (9-74)
按式(9-74)设计串联补偿器可使系统解耦。

图9-15 用串联补偿器实现解耦                 图9-16 用前馈补偿器实现解耦
2)用前馈补偿器G₄ (s) 实现解耦。系统结构如图9-16所示，G₄ (s)的作用是对输入进行适当 变换以实现解耦。未引入G₄(s)  时原系统的闭环传递矩阵Φ'(s)  为





Φ'(s)=[I+G₀(s)]-¹G₀(s)                                                           (9-75)
引入Ga(s)后解耦系统的闭环传递矩阵更(s)为
Φ(s)=Φ'(s)Ga(s)=[I+G₀(s)]-¹G₀(s)G(s)                                                  (9-76)
式中Φ(s)  为所希望的对角阵。由式(9-76)可得
G(s)=Go¹(s)[I+G₀(s)]                 (s)                                           (9-77)


按式(9-77)设计前馈补偿器可使系统解耦。
例9-7 已知双输入-双输出单位反馈系统结构图如 图9-17所示。试列写原系统的开、闭环传递矩阵，并求串 联补偿器和前馈补偿器，使解耦系统的闭环传递矩阵为

并画出解耦系统的结构图。
解求原系统开环传递矩阵G₀(s),  只需写出输出量 (y₁,y₂)  与误差量(e₁,e₂)  各分量之间的关系，即



图9-17 例9-7系统结构图



其向量-矩阵形式为

=G₀(s)E(s)
原系统开环传递矩阵为

输出量(y₁,y₂)   与输入量(u₁,u₂)   各分量之间的关系为



其向量-矩阵形式为






原系统闭环传递矩阵为

串联补偿器G₄(s)  的设计：由式(9-74)并考虑H(s)=I,       有
G.(s)=G¹(s)Φ(s)[I-Φ(s)]- ¹

式中，Ga;(s) 表 示U;(s)  至 Y;(s)(i,j=1,2)         通道的串联补偿器传递函数。可以验证这种解耦系统
的开环传递矩阵G₀(s)G.(s)   为对角阵：

用串联补偿器实现解耦的系统结构图见图9-18。 前馈补偿器G₄(s)  设计：由式(9-76),有



式中，Gd;(s)  表 示U,(s)  至 U;(s)(i,j=1,2)           通道的串联补偿器传递函数。
用前馈补偿器实现解耦的系统结构图见图9-19。


·464 ·








图9-18 用串联补偿器实现解耦的系统结构图        图9-19 用前馈补偿器实现解耦的系统结构图
7.线性离散系统状态空间表达式的建立及其解
离散系统的特点是系统中的各个变量被处理成为只在离散时刻取值，其状态空间描述只反 映离散时刻的变量组间的因果关系和转换关系，因而这类系统通常称为离散时间系统，简称为离 散系统。离散时间系统可以是一类实际的离散时间问题的数学模型，如社会经济问题、生态问题 等，也可以是一个连续系统因为采用数字计算机进行计算或控制的需要而人为地加以时间离散 化而导出的模型。线性离散系统的动态方程可以利用系统的差分方程建立，也可以利用线性连续 动态方程的离散化得到。
(1)由差分方程建立动态方程
在经典控制理论中离散系统通常用差分方程或脉冲传递函数来描述。单输入-单输出线性定 常离散系统差分方程的一般形式为
y(k+n)+an-1y(k+n-1)+…+a₁y(k+1)+aoy(k)
=bnu(k+n)+bn-1u(k+n-1)+…+b₁u(k+1)+bou(k)                                               (9-78) 式中，k 表示kT 时刻；T 为采样周期；y(k),u(k)    分别为kT 时刻的输出量和输入量；a,,b;(i=0,
1,2, …,n,    且am=1)    为表征系统特性的常系数。考虑初始条件为零时的z 变换关系有
Z[y(k)]=Y(z),Z[y(k+i)]=z'Y(z) 对式(9-78)两端取z 变换并加以整理可得

(9-79)
G(z)   称为脉冲传递函数，式(9-79)与式(9-29)在形式上相同，故连续系统动态方程的建立方法 可用于离散系统。例如，在N(z)/D(z)     的串联分解中，引入中间变量Q(z)   则有
z"Q(z)+an-1z"-¹Q(z)+…+azQ(z)+a₀Q(z)=U(z) Y(z)=β-2z"-Q(z)+…+β₁zQ(z)+β₀Q(z)
设                   X₁(z)=Q(z)
X₂(z)=zQ(z)=zX₁(z)

Xn(z)=z"-¹Q(z)=zXn-1(z)





则            z"Q(z)=-a₀X₁(z)-a₁X₂(z)-…-an-1X,(z)+U(z) Y(z)=β₀X₁(z)+β₁X₂(z)+…+βa-1X,(z)
利用z 反变换关系
z-¹[X(z)]=xi(k)
z-¹[zX,(z)]=xi(k+1)
可得动态方程为
x₁(k+1)=x₂(k)
z₂(k+1)=x₃(k) :
xn-1(k+1)=xn(k)
xn(k+1)=-aox₁(k)-a₁x₂(k)-…-an-1xn(k)+u(k)
y(k)=βox₁(k)+β₁x₂(k)+…+βn-1xn(k) 向量-矩阵形式为


(9-80a)


y(k)=[βoβ₁…βn-1]x(k)+bnu(k)                                                     (9-80b)
简记为
x(k+1)=Gx(k)+hu(k)                                                         (9-81a)
y(k)=cx(k)+du(k)                                                          (9-81b)  式中，G 为友矩阵；G,h 为可控标准型。可以看出，离散系统状态方程描述了(k+1)T   时刻的状态 与kT 时刻的状态及输入量之间的关系，其输出方程描述了kT 时刻的输出量与kT 时刻的状态及 输入量之间的关系。
线性定常多输入-多输出离散系统的动态方程为
x(k              +1)=Gx(k)+Hu(k)                                          (9-82a)
y(k)=Cx(k)+Du(k)                                                         (9-82b)
系统结构图见图9-3,图中z-¹ 为单位延迟器，其输入为(k+1)T  时刻的状态，输出为延迟一个采
样周期的kT 时刻的状态。
(2)定常连续动态方程的离散化
已知定常连续系统状态方程x=Ax+Bu      在 x(to)  及 u(t)  作用下的解为


令to=kT,    则x(to)=x(kT)=x(k);	令t=(k+1)T,         则x(t)=x[(k+1)T]=x(k+1);	在
t∈(k,k+1)  区间内，u(t)=u(k)=	常数，于是其解化为	






记                     
为了便于计算G(T), 引入变量置换，令(k+1)T-t=t',     则
                         (9-83)
故离散化状态方程为
x(k+1)=Φ(T)x(k)+G(T)u(k)                                                        (9-84)
式中 (T)  与连续系统状态转移矩阵鱼(T)   的关系为
                          (9-85) 离散化系统的输出方程仍为
y(k)=Cx(k)+Du(k)                                                            (9-86)
(3)定常离散动态方程的解
求解离散动态方程的方法有递推法和z 变换法，这里只介绍常用的递推法，对z 变换法感兴 趣的读者可参阅有关书籍。下面以解离散化状态方程为例来说明如何用递推法求解。令式(9-84) 中的k =  0,1,…,k-1,  可得到T,2T,…,kT  时刻的状态，即
k=0:                 x(1)=Φ(T)x(0)+G(T)u(0)
k=1:                 x(2)=Φ(T)x(1)+G(T)u(1)
=Φ²(T)x(0)+Φ(T)G(T)u(0)+G(T)u(1)
k=2:                 x(3)=   更(T)x(2)+G(T)u(2)
=Φ³(T)x(0)+Φ²(T)G(T)u(0)+Φ(T)G(T)u(1)+G(T)u(2)

k=k-1:             x(k)=Φ(T)x(k-1)+G(T)u(k-1)
=Φ(T)x(0)+          更 -(T)G(T)u(0)+        更 *(T)G(T)u(1) 十 … + Φ(T)G(T)u(k-2)+G(T)u(k-1)
                  (9-87)
式(9-87)为离散化状态方程的解，又称离散化状态转移方程。当u(i)=0(i=0,1,…,k-1) 时有
x(k)=Φ(T)x(0)
=Φ(kT)x(0)=Φ(k)x(0)


Φ(k)称为离散化系统状态转移矩阵。
输出方程为
y(k)=Cx(k)+Du(k)

对于离散状态方程式(9-82),其解为








(9-88)


(9-89) (9-90)





式 中G⁴ 表示k 个 G 自乘。
例9-8 已知连续时间系统的状态方程为

设 T=1,      试求相应的离散时间状态方程。
解由例9-4已知该连续系统的状态转移矩阵为


9-2  线性系统的可控性与可观测性

经典控制理论中用传递函数描述系统的输入-输出特性，输出量即被控量，只要系统是因果  系统并且是稳定的，输出量便可以被控，且输出量总是可以被测量的，因而不需提出可控性及可  观测性概念。现代控制理论中用状态方程和输出方程描述系统，输入和输出构成系统的外部变  量，而状态为系统的内部变量，这就存在着系统内的所有状态是否可受输入影响和是否可由输出  反映的问题，这就是可控性和可观测性问题。如果系统所有状态变量的运动都可以由输入来影响  和控制而由任意的初态达到原点，则称系统是完全可控的，或者更确切地说是状态完全可控的， 简称为系统可控；否则，就称系统是不完全可控的，或简称为系统不可控。相应地，如果系统所有  状态变量的任意形式的运动均可由输出完全反映，则称系统是状态完全可观测的，简称为系统可  观测；反之，则称系统是不完全可观测的，或简称为系统不可观测。
可控性与可观测性概念，是卡尔曼于20世纪60年代首先提出来的，是用状态空间描述系统 引申出来的新概念，在现代控制理论中起着重要作用。它不仅是研究线性系统控制问题必不可少 的重要概念，而且对于许多最优控制、最优估计和自适应控制问题，也是常用到的概念之一。下面 我们先举几个例子来直观地说明可控性与可观测性的物理概念，然后给出可控性与可观测性的 严格定义。
例9-9 给定系统的动态方程为


将其表示为标量方程组的形式，有
文₁=4 x₁+u





i₂=-5x₂+2u
y= 一6x₂
这表明状态变量x₁ 和 xz 都可通过选择控制量u 而由始点达到原点，因而系统完全可控。但是，输 出y  只能反映状态变量x₂,  而与状态变量x₁ 既无直接关系也无间接关系，所以系统是不完全可 观测的。
例9-10 桥式网络如图9-20所示，选取电感电流iz 和电容端电压uc 作为状态变量，u 为 输 入，输出量y=uc。
设x₁=iz,xz=uc,          由网络可以看出，如果x₂(to)=0,       则不论u 如何选取，对于所有t≥to,
z₂(t)=0,       即u 只能控制x₁ 的变化，而不能控制x₂ 的变化，x₂ 不可控。由于y=uc=0,         因而也不 可能由输出y 来反映状态变量x₁  的变化，x₁ 不可观测。故系统不可控也不可观测。
例9-11 对于图9-21所示网络，设x₁=uc₁,xz=uc₂,  输 出y=x₂ 。 当 R₁=R₂,C₁=C₂          且初始
状态x₁(to)=x₂(to)     时，则不论将输入u 取为何种形式，对于所有t≥t,      只能是x₁(t)=x₂(t),        不 可能做到x₁(t)≠x₂(t) 。  也就是说，输入u 能够做到使x₁ 和x₂ 同时转移到任意相同的目标值，但 不能将x₁ 和 x₂ 分别转移到不同的目标值。这表明此电路不完全可控，简称电路不可控。由于 y=x₁=x₂,     故可观测。

图9-20 例9-10桥式电路                        图9-21 例9-11网络
应当指出，上述对可控性和可观测性所作的直观说明，只是对这两个概念的直觉的但不严密 的描述，而且也只能用来解释和判断非常直观和非常简单系统的可控性和可观测性。为了揭示可 控性和可观测性的本质属性，并用于分析和判断更为一般和较为复杂的系统，需要对这两个概念 建立严格的定义，并在此基础上导出相应的判别准则。尽管本章主要研究线性定常系统，但由于 线性时变系统的可控性和可观测性定义更具有代表性，而线性定常系统只是线性时变系统的一 种特殊类型，因而我们用线性时变系统给出可控性和可观测性的严格定义。在研究线性定常连续 和离散系统时，再分别给出可控性及可观测性判据。
1.可控性
考虑线性时变系统的状t=A(t)x(t)+B(t)u(t),t∈T:                        (9-91)
其中，x 为 n 维状态向量；u 为 p 维输入向量；T.为时间定义区间；A(t)  和 B(t)  分别为(n×n)      和
(n×p)      矩阵。现对状态可控、系统可控和不可控分别定义如下：
状态可控 对于式(9-91)所示线性时变系统，如果对取定初始时刻to ∈T   的一个非零初始 状态x(to)=xo,      存在一个时刻t₁ ∈T,,t₁>to,         和一个无约束的容许控制u(t),t∈[to,t₁],         使状 态由x(to)=x 。 转移到t₁ 时 的x(t₁)=0,       则称此x。是 在t。时刻可控的。





系统可控  对于式(9-91)所示线性时变系统，如果状态空间中的所有非零状态都是在 to(to∈T,)   时刻可控的，则称系统在时刻t。是完全可控或一致可控的，简称系统在时刻t。可控。
系统不完全可控 对于式(9-91)所示线性时变系统，取定初始时刻to ∈T,,    如果状态空间 中存在一个或一些非零状态在时刻t。是不可控的，则称系统在时刻t。是不完全可控的，也称为系 统是不可控的。
在上述定义中只要求系统在可找到的控制u(t)  的作用下，使to 时刻的非零状态x。在 T, 上 的 一段有限时间内转移到状态空间的坐标原点，而对于状态转移的轨迹则未加任何限制和规定。所 以，可控性是表征系统状态运动的一个定性特性。定义中对控制u(t)  的每个分量的幅值并未加 以限制，可为任意大的要求值。但u(t)  必须是容许控制，即u(t)   的每个分量u;(t)(i=1,2,…,p)
均在时间区间T, 上平方可积，即

此外，对于线性时变系统，其可控性与初始时刻to 的选取有关，是相对于T,  中的一个取定时刻t。 来定义的。而对于线性定常系统，其可控性与初始时刻t。的选取无关。
状态与系统的可达 对于式(9-91)所示线性时变系统，若存在能将状态x(to)=0  转移到 x(ty)=x, 的控制作用，则称状态x,是 to时刻可达的。若x; 对所有时刻都是可达的，则称x;为 完 全可达或一致可达。若系统对于状态空间中的每一个状态都是时刻to 可达的，则称该系统是to 时 刻状态完全可达的，或简称该系统是to 时刻可达的。
对于线性定常连续系统，可控性与可达性是等价的。但对于离散系统和时变系统，严格地说 两者是不等价的。
2.可观测性
可观测性表征了状态可由输出完全反映的性能，所以应同时考虑系统的状态方程和输出

方程		
	x(t)=A(t)x(t)+B(t)u(t),t∈T,  y(t)=C(t)x(t)+D(t)u(t),x(to)=x₀	(9-92a) (9-92b)
其中，A(t),B(t),C(t)	和D(t)  分别为(n×n),(n×p),(q×n)	和 (q×p)     的满足状态方程解的


存在唯一性条件的时变矩阵。式(9-92a) 状态方程的解为




(9-93)

其中更(t,to)   为系统的状态转移矩阵。将式(9-93)代入式(9-92b) 输出方程，可得输出响应为
       (9-94)
在研究可观测性问题时，输出y 和输入u 均假定为已知，只有初始状态x。是未知的。因此，若定义


则式(9-94)可写为
y(t)=C(t)Φ(t,to)x₀                                                                 (9-95) 这表明可观测性即是x。可 由y 完全估计的性能。由于y 和 x。可取任意值，所以这又等价于研究






u=0  时 由y 来估计xo的可能性，即研究零输入方程
x(t)=A(t)x(t),x(to)=xo,to,t∈T,
y(t)=C(t)x(t)
的可观测性。式(9-94)成为
y(t)=C(t)Φ(t,to)x₀ 下面基于式(9-96)给出系统可观测性的有关定义。



(9-96a)  (9-96b)

(9-97)

系统完全可观测  对于式(9-96)所示线性时变系统，如果取定初始时刻to ∈T,,   存在一个 有限时刻t₁ ∈T,,t>to,  对于所有t∈[to,t₁],系统的输出y(t)能唯一确定状态向量的初值 x(t₀),则称系统在[to,t₁]内是完全可观测的，简称系统可观测。如果对于一切t₁>to 系统都是可 观测的，则称系统在(to, 四)内完全可观测。
系统不可观测  对于式(9-96)所示线性时变系统，如果取定初始时刻to ∈T,,   存在一个有 限时刻t₁ ∈T,,t₁>to,        对于所有t ∈[to,t₁],     系统的输出y(t)   不能唯一确定所有状态的初值 x;(to),i=1,2,…,n,即至少有一个状态的初值不能被y(t)确定，则称系统在时间区间[to,t₁]内 是不完全可观测的，简称系统不可观测。
3.线性定常连续系统的可控性判据
考虑线性定常连续系统的状态方程
x(t)=Ax(t)+Bu(t),x(0)=xo,t≥0                                                             (9-98) 其中，x 为n 维状态向量；u为p 维输入向量；A 和B 分别为n×n 和 n×p 常值矩阵。下面根据 A和B 给出系统可控性的常用判据。
格拉姆矩阵判据  线性定常连续系统式(9-98)完全可控的充分必要条件是，存在时刻t₁> 0,使如下定义的格拉姆矩阵：
                      (9-99)
为非奇异。
证明  充分性：已知W(0,t₁) 为非奇异，欲证系统完全可控。
已知W 非奇异，故W-¹ 存在。对任一非零初始状态x。可选取控制u(t)为
u(t)=-BTe-Aw-(0,t₁)xo,t∈[io,t₁]                             (9-100)
则在u()   作用下系统(9-98)在t₁ 时刻的解为


=e^³x 。-e^W(0,t₁)W-¹(0,t₁)xo=0,Vxo∈R”
这表明，对任一取定的初始状态xo≠0,    都存在有限时刻t₁>0    和控制u(t),   使状态由xo 转移到 t₁ 时刻的状态x(t₁)=0,      于是根据定义可知系统完全可控。充分性得证。
必要性：已知系统完全可控，欲证W(0,t₁)   为非奇异。
采用反证法。设W(0,t₁)   为奇异，则存在某个非零向量x。∈R", 使
W(0,t₁)x 。=0                                                            (9-101)
成立，由此可导出







                    (9-102)
其中| · Ⅱ为范数，故其必非负。于是，欲使式(9-102)成立，应当有
BTe-A⁷x。=0,Vt∈[0,t₁]                                 (9-103)
另一方面，因系统完全可控，根据定义对此非零向量x。应有
                 (9-104) 由此又可导出
                          (9-105) |x 。||²=xx。




再利用式(9-103),由式(9-106)可以得到


(9-106)

|x。 ||²=0,   即  x。=0                          (9-107)
显然，此结果与假设x≠0       相矛盾，即W(0,t₁)   为奇异的反设不成立。因此，若系统完全可控， W(0,t₁)   必为非奇异。必要性得证。至此格拉姆矩阵判据证毕。
可以看出，在应用格拉姆矩阵判据时需计算矩阵指数e, 在 A 的维数n 较大时计算e  是 困 难的。所以格拉姆矩阵判据主要用于理论分析。线性定常连续系统可控性的常用判据是直接由矩 阵A 和B 判断可控性的秩判据。由于在推导秩判据时要用到凯莱-哈密顿定理，所以下面先介绍 凯莱-哈密顿定理，然后再给出秩判据。
凯莱-哈密顿定理  设 n 阶矩阵A 的特征多项式为
f(A)=|A-A|



则 A 满足其特征方程，即 证明 由 于


=入”+an- 1x- ¹+ …+a₁λ+a 。                         (9-108)
                (9-109)
                    (9-110)

式中，B(A) 为 (N-A)       的伴随矩阵，其一般展开式为







显见B(A) 的元素均为n-1     阶多项式，由矩阵加法规则可将其分解为n 个矩阵之和，即
B(A)="-¹Bn-1+λ-²Bn-2+…+AB₁+B₀                                           (9-111)
式中B-1,B-2,…,B 。 均为n 阶矩阵。将式(9-110)两端右乘(N-A),      得
B(λ)(N-A)=f(A)I                                                        (9-112)
将式(9-111)代入式(9-112)并展开有
X"B-1+λ-¹(Bn-2-Bn-1A)+λ"-2(Bn-3-Bn-2A)+…+λ(B 。-B₁A)-B₀A
=λ"I+an-1λ"-¹I+…+a₁λ+a₀I                                                                                        (9-113)
令式(9-113)等号两边λ同次项的系数相等，可得
Bn-1=I
Bn-2-Bn-1A=an-1I
:                                          (9-114)
B₀-B₁A=a₁I
-B₀A=a₀I
将式(9-114)两端按顺序右乘A”,A"-¹,…,A,A° 得
Bn-1A”=A"
Ba-2A"-¹-Bn-1A”=an-1A"-1
:                                           (9-115)
B₀A-B₁A²=a₁A -B₀A=a₀I
将式(9-115)中各式相加，可证得
f(A)=A"+an-1A"-¹+…+a₁A+a₀I=0

推论1 矩阵A 的 k(k≥n) 次幂可表示为A 的 n-1  阶多项式
      k≥n                                                 (9-116)
证明 由于      A”=-an- 1A"  1 an-2A"-²-…-a₁A-a₀I
A"+¹=AA”=-an-1A"-an-2A"-1-…-a₁A²-a₀A  =-an-1(-an-1A"-¹-…-a₁A-a₀I)-an-2A"-1
- …-a₁A²-aA
=(a²-1-an-2)A"-¹+(an-1an-2-an-3)A"-²+ … +(a-1a₂-a₁)A²+(an-1a₁-ao)A+a-1a₀I
·473 ·

|





故上述推论成立。式(9-116)中的αm与 A阵的元素有关。此推论可用以简化矩阵幂的计算。
推论2 矩阵指数eA 可表示为A 的 n-1  阶多项式
(9-117)
证明 由于





+(an-1az-a₁)A²+(an-1a₁-ao)A+an-1a₀I]t"+1+ …




令






则有
故推论2成立。式(9-117)中的αm(t)(m=0,1,2,…,n-1)             均 为t 的幂函数，对于t ∈[0,t;],
不同时刻构成的向量组[a。(0),…,aa-1(0)],…,[ao(ts),…,an-1(ty)]是线性无关的向量组，其中 任一向量都无法表示成为其他向量的线性组合。同理，e-A'也可表示为A的n-1     阶多项式
                         (9-118)
式中







:


秩判据线性定常连续系统(9-98)完全可控的充分必要条件是
rank[B        AB         …A"-¹B]=n                                          (9-119)
其中，n 为矩阵A 的维数；S=[B    AB     …A"-¹B]称为系统的可控性判别阵。 证明 充分性：已知rankS=n, 欲证系统完全可控。
采用反证法。反设系统为不完全可控，则根据格拉姆矩阵判据可知

为奇异，这意味着存在某个非零n 维向量α使


成立。显然，由此可导出
αTe-A'B=0,Vt∈[0,t₁]                                                         (9-120)
将式(9-120)求导直至n-1     次，再在所得结果中令t=0,     得到
αTB=0,αTAB=0,αTA²B=0,…,αTA"-¹B=0                                                  (9-121)
式(9-121)又可表示为
α'[B        AB        A²B         …A"-¹B]=αTs=0                                (9-122)
由于α≠0,所以式(9-122)意味着S 为行线性相关，即rankS<n,    这显然和已知rankS=n     相矛
盾。因而反设不成立，系统应为完全可控。
必要性：已知系统完全可控，欲证rankS=n。
采用反证法。反设rankS<n,  这意味着S 为线性相关，因此必存在一个非零n 维常数向量 a 使
αTS=α'[B          AB          …A"-¹B]=0
成立。考虑到问题的一般性，由上式可导出
αTA'B=0;i=0,1,2,…,n-1                                                          (9-123)
根据凯莱-哈密顿定理，A”,A"+1,…均可表示为A的 n-1     阶多项式，因而式(9-123)又可写为
αTA'B=0;i=0,1,2,3, …                                                          (9-124)
从而对任意t₁>0     有
;Vt∈[0,t₁];i=0,1,2, …







因而有







(9-125)


(9-126)

因为已知α≠0,若式(9-126)成立，则W(0,t₁)   必为奇异，系统为不完全可控，与已知结果相矛盾。 于是有rankS=n,      必要性得证。秩判据证毕。
例9-12 桥式网络如图9-22所示，试用可控性判据判断其可控性。



图9-22 桥式网络


解该桥式网络的微分方程为 iz=i₁+i₂=i₃+i₄
R₄i₄+uc=R₃i₃
R₁i+uc=R₂i₂

选取状态变量x₁=iz,x₂=uc,          消去微分方组中
的i₁,i₂,is,ia,可得状态方程



其可控性矩阵为

当 时 ，rankS=2=n,         系统可控。但是，当电桥处于平衡状态，即R₁R₄=R₂R₃
时，及                成立，这时状态方程变为


可控性矩阵为

rankS=1<n,         系统不可控，u 不能控制x₂,x₂    是不可控状态变量。
例9-13 已 知 ,求A¹⁰0=?
解  A 的特征多项式为





根据凯莱-哈密顿定理，有
f(A)=A²-2A+I=0 A²=2A-I
故               A³=AA²=2A²-A=2(2A-I)-A=3A-2I     A⁴=AA³=3A²-2A=3(2A-I)-2A=4A-3I
根据数学归纳法有
A*=kA-(k-1)I

PBH 秩判据 线性定常连续系统(9-98)完全可控的充分必要条件是，对矩阵A的所有特征 值λ;(i=1,2, … ,n),         有
rank[λI-A                            B]=n;i=1,2,…,n                                    (9-127)
均成立，或等价地表示为
rank[sI-A                        B]=n;Vs∈C                                         (9-128)
由于这一判据是由波波夫(Popov)  和贝尔维奇(Belevitch)  首先提出，并由豪塔斯(Hautus) 最先指出其可广泛应用性，故称为PBH 秩判据。
证 明 必 要 性：已知系统完全可控，欲证式(9-127)成立。
采用反证法。反设对某个λ:有rank[λ;I-A               B]<n,则意味着[λI-A           B]为行线性相关， 因而必存在一个非零常数向量α,使
α'[λI-A                 B]=0                                                   (9-129)
成立。考虑到问题的一般性，由式(9-129)可导出
αTA=λαT,αTB=0                                                              (9-130)
进而可得
αTB=0,αTAB=λ,αTB=0,…,αTA”-B=0

于是有                    α'[B             AB            …A"-¹B]=αTs=0                                       (9-131)
因已知α≠0,所以欲使式(9-131)成立，必有
rankS<n
这意味着系统不可控，显然与已知条件相矛盾，因而反设不成立，而式(9-127)成立。考虑到[sI- A   B]为多项式矩阵，且对复数域C 上除λ;(i=1,2,…,n)   以外的所有s均 有det(sI-A)≠0, 所以式(9-127)等价于式(9-128)。必要性得证。
充分性：已知式(9-127)成立，欲证系统完全可控。
采用反证法。利用与上述相反的思路，即可证明充分性。至此，PBH 秩判据证毕。 例9-14 已知线性定常连续系统的状态方程为

十



试判别系统的可控性。
解根据状态方程可写出

考虑到A的特征值为λ₁=A₂=0,A₃=√5,A=-√5,                     所以只需对它们来检验上述矩阵的秩。
通过计算可知，当s=λ₁=λ2=0            时，有

当s=A₃=√5            时，有

当s=A=-√5            时，有

计算结果表明，充分必要条件式(9-127)成立，故系统完全可控。
对角线规范型判据 若线性定常连续系统(9-98)矩阵A 的特征值λ,λ2,…, λn两两相异，由 线性变换式(9-98)可变为对角线规范型


(9-132)


则系统(9-98)完全可控的充分必要条件是，在式(9-132)中，B 不包含元素全为零的行。
证明 可用秩判据予以证明，推证过程略。
例9-15 已知线性定常连续系统的对角线规范型为

(9-133)





试判定系统的可控性。
解 由于此规范型中B 不包含元素全为零的行，故系统完全可控。 4.输出可控性
如果系统需要控制的是输出量而不是状态，则需研究系统的输出可控性。
输出可控性若在有限时间间隔[to,t₁]   内，存在无约束分段连续控制函数u(t),t∈[to,t₁],
能使任意初始输出y(to)  转移到任意最终输出y(t₁),   则称此系统是输出完全可控，简称输出 可控。
输出可控性判据设线性定常连续系统的状态方程和输出方程为 x=Ax+Bu,x(0)=xo,t∈[0,t₁]
y=Cx+Du
式中，u为 p 维输入向量；y 为q 维输出向量；x 为n 维状态向量。状态方程(9-134)的解为

则输出为              不失一般性，令y(t₁)=0,       有





=-CBu 。(t₁)-CABu₁(t₁)-…-CA"-¹Bu-1(t₁)-Du(t₁)


(9-137)


(9-138)
So为q×(n+1)p   矩阵，称为输出可控性矩阵。输出可控的充分必要条件是，输出可控性矩阵的 秩等于输出变量的维数q, 即
rankS₀=q                                                              (9-139) 需要注意的是，状态可控性与输出可控性是两个不同的概念，二者没有什么必然的联系。
例9-16 已知系统的状态方程和输出方程为

·479 ·





y=[10]x 试判断系统的状态可控性和输出可控性。
解系统的状态可控性矩阵为

|S|=0,rankS<2,            故状态不完全可控。 输出可控性矩阵为
So=[cb          cAb          d]=[1          -10]
rankS 。=1=q,       故输出可控。
5.线性定常连续系统的可观测性判据
考虑输入u=0     时系统的状态方程和输出方程
i=Ax,x(0)=xo,t≥0,y=Cx                                                                    (9-140)
式中，x 为 n 维状态向量；y 为 q 维输出向量；A和 C 分别为n×n     和 q×n      的常值矩阵。
格拉姆矩阵判据  线性定常连续系统(9-140)完全可观测的充分必要条件是，存在有限时 刻t₁>0,  使如下定义的格拉姆矩阵：
                       (9-141)
为非奇异。
证明  充分性：已知M(0,t₁) 非奇异，欲证系统为完全可观测。 由式(9-140)可得
y(t)=CΦ(t,0)x₀=Ce^'x 。                             (9-142)
将式(9-142)左乘eA'CT, 然后从0到t₁ 积分，得
              (9-143)
已知M(0,t₁) 非奇异，即M-¹(0,t₁) 存在，故由式(9-143)得

这表明，在M(0,t₁)    非奇异的条件下，总可以根据[0,t₁]  上的输出y(t),   唯一地确定非零初始状 态xo。因此，系统为完全可观测。充分性得证。
必要性：已知系统完全可观测，欲证M(0,t₁)    非奇异。
采用反证法。反设M(0,t₁)    奇异，假设存在某一非零x∈R”,     使








成立，这意味着











(9-144)

y(t)=CeAx 。=0,Vt∈[0,t₁]
显然，x。为状态空间中的不可观测状态。这和已知系统完全可观测相矛盾，所以反设不成立，必要





性得证。至此格拉姆矩阵判据证毕。
秩判据线性定常连续系统(9-140)完全可观测的充分必要条件是
                          (9-145)
或                  rank[CT           ACT(A)²C     …(AT)"'Cr]=n                                       (9-146)
式(9-145)和式(9-146)中的矩阵均称为系统可观测性判别阵，简称可观测性阵。
证明 证明方法与可控性秩判据相似，在此不再详述。这里仅从式(9-142)出发，进一步论证 秩判据的充分必要条件。
由式(9-142),利用e    的级数展开式，可得

=[Ca₀(t)+Ca₁(t)A+…+Ca-1(t)A"-¹]x。


(9-147)

式中I, 为q 阶单位阵。已知[a₀(t)I₄…a-1(t)I,]               的 nq 列线性无关，于是根据测得的y(t)  可 唯
一确定x。的充分必要条件是

这就是式(9-145)。
例9-17 判断下列两个系统的可观测性。
x=Ax+Bu,y=Cx


1) 2)









c=[10];



观测。

观测。
PBH 秩判据  线性定常连续系统(9-140)完全可观测的充分必要条件是，对矩阵A 的所有 特征值λ;(i=1,2, … ,n),           均有




;  i=1,2,…,n                                           (9-148) 或等价地表示为
                    (9-149) 对角线规范型判据 线性定常连续系统(9-140)完全可观测的充分必要条件是：
当矩阵A的特征值λ,λ₂,…,λ两两相异时，由式(9-140)线性变换导出的对角线规范型为


(9-150)


式中C 不包含元素全为零的列。
例9-18 已知线性定常连续系统的对角线规范型为

试判定系统的可观测性。
解显然，此规范型中C 不包含元素全为零的列，故系统为完全可观测。 6.线性离散时间系统的可控性和可观测性
线性离散时间系统简称为线性离散系统。由于线性定常系统只是线性时变系统的一种特殊 类型，和前面讨论线性连续系统时的过程相似，在讨论线性离散系统时，为便于读者全面理解基 本概念，我们利用线性时变离散系统给出有关定义，而在介绍可控性和可观测性判据时，受篇幅 限制，则仅限于线性定常离散系统。
(1)线性离散系统的可控性和可达性
设线性时变离散时间系统的状态方程为
x(k+1)=G(k)x(k)+H(k)u(k),k∈T                                                     (9-151) 其中T   为离散时间定义区间。如果对初始时刻L∈T   和状态空间中的所有非零状态x(L),  都存
在时刻m ∈T,m>l,         和对应的控制u(k),   使得x(m)=0,      则称系统在时刻L为完全可控。对应
地，如果对初始时刻L∈T  和初始状态x(L)=0,  存在时刻m∈T,m>l,    和相应的控制u(k),
使x(m)  可为状态空间中的任意非零点，则称系统在时刻l 为完全可达。
对于离散时间系统，不管是时变的还是定常的，其可控性和可达性只有在一定条件下才是等 价的。其等价的条件分别为
1)线性离散时间系统(9-151)的可控性和可达性为等价的充分必要条件是，系统矩阵G(k) 对所有k∈[ Ll,m-1]  为非奇异。
2)线性定常离散时间系统
x(k+1)=Gx(k)+Hu(k);k=0,1,2, …                                                      (9-152)
的可控性和可达性等价的充分必要条件是系统矩阵G 为非奇异。





3)如果线性离散时间系统(9-151)或(9-152)是相应连续时间系统的时间离散化模型，则其 可控性和可达性必是等价的。
上述等价条件的简单证明可参阅有关参考文献，此处不再详述。
线性定常离散系统的可控性判据设单输入线性定常离散系统的状态方程为
x(k+1)=Gx(k)+hu(k)                                                           (9-153) 式中，x 为n 维状态向量；u为标量输入；G 为n×n 非奇异矩阵。状态方程(9-153)的解为



根据可控性定义，假定k=n    时 ，x(n)=0,       将式(9-154)两端左乘G-”,  则有

=-[G-'hu(0)+G-²hu(1)+…+G-"hu(n-1)]



(9-154)







(9-155)


记                        S{=[G-¹h         G-2h         …G-"h]                                          (9-156)
称S{ 为n×n   可控性矩阵。式(9-155)是一个非奇异线性方程组，含n个方程，有n个未知数u(0),    u(1),…,u(n-1) 。   由线性方程组解的存在定理可知，当矩阵Sí 的秩与增广矩阵[S'       x(0)]     的 秩相等时，方程组有解且为唯一解，否则无解。在x(0)  为任意的情况下，使方程组有解的充分必 要条件是矩阵S{满秩，即
rankS{=n                                                               (9-157)
或矩阵S{ 的行列式不为零
detS{≠0                                                                (9-158)
或矩阵S{是非奇异的。
由于满秩矩阵与另一满秩矩阵G" 相乘其秩不变，故 rankS{=rank[G"S{]
=rank[G"-Ih          …Gh          h]=n                                              (9-159)
交换矩阵的列，且记为S₁, 其秩也不变，故有
rankS₁=rank[h          Gh          …G"-¹h]=n                                  (9-160)
由于式(9-160)避免了矩阵求逆，在判断系统的可控性时，使用式(9-160)比较方便。
式(9-157)～(9-160)都称为可控性判据，Sí和S₁  都称为单输入离散系统的可控性矩阵。状 态可控性取决于G 和 h。
当rankS₁<n     时，系统不可控，表示不存在使任意x(0)   转移至x(n)=0      的控制。
以上研究了终态为x(n)=0      的情况，若令终态为任意给定状态x(n),   则式(9-154)变为
(9-161)
将式(9-161)两端左乘G-”,  有






(9-162)


当G 满秩时，该式左端只不过是任一给定的另一初态，其状态可控性条件可用以上推导方法得出 完全相同的结论。若令x(0)=0,       上述结论同样成立。可见，当G 为非奇异阵时，系统的可控性和 可达性是等价的。
上述研究单输入离散系统可控性的方法可推广到多输入系统。设系统的状态方程为
x(k+1)=Gx(k)+Hu(k)                                                              (9-163)
所谓可控性问题即是能否求出无约束控制向量序列u(0),u(1),…,u(n-1),             使系统能从任意初
态x(0)  转移至x(n)=0 。  式(9-163)的解为
                    (9-164)
令k=  n,x(n)=0,  且式(9-164)两端左乘    有


(9-165)


记                         Sz=[G-¹H           G-²H            …G-"H]                                         (9-166)
为n×np 矩阵，由子列向量u(0),u(1),…,u(n-1)  构成的控制列向量是np 维的。式(9-165)含 n个方程，但有np 个待求的控制量。由于初态x(0)  可任意给定，根据解存在定理，矩阵Sz的秩为 n 时，方程组才有解。于是多输入线性离散系统状态可控的充分必要条件是
rankS2=n                                                                  (9-167)
或               rankSz=rank[G"S]=rank[G"-¹H                 …GH                 H]=n                    (9-168)
或                      rankS₂=rank[H             GH             …G"-¹H]=n                                  (9-169)
或                                    detS₂SZ≠0                                                                  (9-170) 或                                   rankS₂SZ=n                                                                 (9-171) 式(9-167)至式(9-171)都是多输入线性离散系统的可控性判据，通常使用式(9-169)或式(9-170) 较为方便。
由于式(9-165)中方程个数少于未知量个数，方程组的解便不唯一，任意假定np-n      个控制 量，其余n 个控制量才能唯一确定。多输入线性离散系统控制序列的选择，通常具有无穷多种方 式。
由于S₂ 的行数总小于列数，因而在列写S₂ 时，只要所选取的列能判断出S₂ 的秩为n,  便不必 再将S₂ 的其余列都列写出来。由于S₂ 满秩时，SZ必满秩，n 阶方阵S₂SZ 也必满秩，这时计算一次 n 阶行列式detS₂SZ 便可确定可控性，这比多次计算S₂ 的 n 阶行列式要简单一些。





多输入线性定常离散系统由任意初态转移至原点一般可少于n 个采样周期。 例9-19 设单输入线性定常离散系统状态方程为

试判断其可控性；若初始状态x(0)=[210]T,               确定使x(3)=0        的控制序列u(0),u(1),
u(2);  研究使x(2)=0       的可能性。
解 由 题 意 知


故系统可控。可按式(9-155)求出u(0),u(1),u(2),        为了减少求逆阵的麻烦，现用递推法来求。令
k=0,1,2,       可得状态序列



令x(3)=0,  则有

其系数矩阵即可控性矩阵S₁, 是非奇异的，因而可得

若令x(2)=0,       即解方程组






容易看出其系数矩阵的秩为2,但增广矩阵

的秩为3,两个秩不等，方程组无解，意味着不能在两个采样周期内使系统由初始状态转移至原 点。若该两个秩相等，则可用两步完成状态转移。
(2)线性离散系统的可观测性 设离散系统为
x(k+1)=G(k)x(k)+H(k)u(k),                        k∈T
y(k)=C(k)x(k)+D(k)u(k)                                                                      (9-172)
若对初始时刻l∈T  的任一非零初始状态x(l)=x。,都存在有限时刻m∈T,m>l,     且可由
[l,m] 上的输出y(k) 唯一地确定xo,则称系统在时刻l是完全可观测的。
线性定常离散系统的可观测性判据 设线性定常离散系统的动态方程为
x(k+1)=Gx(k)+Hu(k),y(k)=Cx(k)+Du(k)                                                 (9-173)
式中，x(k)  为n 维状态向量；y(k)  为 q 维输出向量，其解为
                        (9-174)
             (9-175) 研究可观测性问题时，u(k),G,H,C,D     均为已知，故不失一般性，可将动态方程简化为
x(k+1)=Gx(k),y(k)=Cx(k)                                                         (9-176)
对应的解为
x(k)=G*x(0),y(k)=CG⁴x(0)                                                     (9-177)
将y(k)  写成展开式

(9-178)

其向量-矩阵形式为

(9-179)




令






(9-180)

Vf称为线性定常离散系统的可观测性矩阵，为ng×n    矩阵。式(9-179)含有nq个方程，若其中有 n个独立方程，便可确定唯一的一组x₁(0),x₂(0),…,xa(0) 。  当独立方程个数大于n 时，解会出现




矛盾；当独立方程个数小于n 时，便有无穷多解。故系统可观测的充分必要条件为
rankV{=n                                                             (9-181)
由于rankV{=rankV₁,     故线性定常离散系统的可观测性判据常表示为
rankV₁=rank[CT        GTCT         …(GT)”-¹CT]=n                           (9-182)
例9-20 已知线性定常离散系统的动态方程为
x(k+1)=Gx(k)+hu(k);y(k)=Cx(k);i=1,2
其中

试判断系统的可观测性，并讨论可观测性的物理解释。
解  当观测矩阵为c₁ 时 ，


故系统可观测。由输出方程y(k)=c₁x(k)       =x₂(    k)可见，在第k 步便可由输出确定状态变量
x₂ (k)。由于
y(k+1)=x₂(k+1)=-2x₂(k)+x₃(k)
故在第k+1    步便可确定x₃(k) 。由于
y(k+2)=x₂(k+2)=-2x₂(k+1)+x₃(k+1)
=-2[-2x₂(k)+x₃(k)]+3x₁(k)+2x₃(k) =4x₂(k)+3x₁(k)
故在第k+2  步便可确定x₁ (k)。
该系统为三阶系统，可观测意味着至多三步便可由输出y(k),y(k+1),y(k+2)             的测量值
来确定三个状态变量。
当观测矩阵为C₂ 时 ，


故系统不可观测。
根据系统动态方程可导出







可看出三步的输出测量值中始终不含x₂(k),   故 x₂(k)   是不可观测状态变量。只要有一个状态变 量不可观测，则称系统不完全可观测，简称不可观测。
(3)连续动态方程离散化后的可控性和可观测性
一个可控的或可观测的连续系统，当其离散化后并不一定能保持其可控性或可观测性，现举 例来说明。
设连续系统动态方程为

由于系统的状态方程为可控标准型，故一定可控。根据可观测性判据，有

故系统可观测。
系统的状态转移矩阵为



系统离散化后的状态方程为
x(k+1)=Φ(T)x(k)+G(T)u(k)

离散化后系统的可控性矩阵为

离散化后系统的可观测性矩阵为









当采样周期





时，可控性矩阵S₁ 和可观测性矩阵V₁ 均出现零行，rankS₁=

1<n,rankV₁=1<n,             系统不可控也不可观测。这表明连续系统可控或可观测时，若采样周期选 择不当，对应的离散化系统便有可能不可控或不可观测，也有可能既不可控又不可观测。若连续 系统不可控或不可观测，不管采样周期T  如何选择，离散化后的系统一定是不可控或不可观 测的。
7.线性定常系统的线性变换
为便于对系统进行分析和综合设计，经常需要对系统进行各种非奇异变换，例如将A 阵 对 角化、约当化、将{A,b} 化为可控标准型，将{A,c}化为可观测标准型等，本小节将介绍在线性定 常系统研究中常用的一些线性变换方法及非奇异线性变换的一些不变特性。
(1)状态空间表达式的线性变换
在研究线性定常连续系统状态空间表达式的建立方法时可以看到，选取不同的状态变量便 有不同形式的动态方程。若两组状态变量之间用一个非奇异矩阵联系着，则两组动态方程的矩阵

与该非奇异矩阵有确定关系。 设系统动态方程为
x=Ax+bu,y=cx 令                                     x=Px




(9-183) (9-184)

式中P 为非奇异线性变换矩阵，它将x 变换为x, 变换后的动态方程为
x=Ax+bu,y=cx=y                                                                    (9-185)
式中                      A=P-¹AP,b=P-1b,c=cP                                                                (9-186)
并称为对系统进行P 变换。对系统进行线性变换的目的在于使A 阵规范化，以便于揭示系统特性 及分析计算，并不会改变系统的原有性质，故称为等价变换。待获得所需结果之后，再引入反变换 关系x=P-¹x,       换算回原来的状态空间中去，得出最终结果。
下面概括给出本章中常用的几种线性变换关系。
1)化A 阵为对角型。
① 设A 阵为任意形式的方阵，且有n 个互异实数特征值λ₁,λ₂,…,λ,则可由非奇异线性变换


化为对角阵A。









(9-187)

P 阵 由A 阵的实数特征向量p₁(i=1,2,…,n)          组 成
P=[pi                 P₂…pn]                                                   (9-188)
特征向量满足
Ap=λPi;i=1,2, …,n                                                                 (9-189)





② 若A 阵为友矩阵，且有n 个互异实数特征值λ ,A₂,…,入，则下列的范德蒙特 (Vandermode)  矩 阵P 可 使A 对角化：


(9-190)


2 ) 化A 阵为约当型。
设A 阵具有m 重实特征值λ,其余为n-m   个互异实特征值，但在求解Api=A₁P; 时只有 一
个独立实特征向量p₁, 则只能使A 化为约当阵J。






(9-191)






J 中虚线示出存在一个约当块。
P.=[P₁P₂…pm                     Pm+1…pn]                                           (9-192)
式中，p₂,P₃,…,pm   是广义实特征向量，满足


(9-193)


Pm+1,…,pn是互异特征值对应的实特征向量。
3)化可控系统为可控标准型。
在前面研究状态空间表达式的建立问题时，曾得出单输入线性定常系统状态方程的可控标


准型：









(9-194)





与该状态方程对应的可控性矩阵S 是一个右下三角阵，其主对角线元素均为1,故detS≠0,    系 统 一定可控，这就是形如式(9-194)中的A,b  称为可控标准型名称的由来。其可控性矩阵S 形如



(9-195)



一个可控系统，当A,b 不具有可控标准型时，一定可以选择适当的变换化为可控标准型。设 系统状态方程为
x=Ax+bu                                                               (9-196)
进行P- ¹ 变换，即令
x=P- ¹z                                                                   (9-197)
变换为
ż=PAP- ¹z+Pbu                                                           (9-198)
要求


(9-199)


下面具体推导变换矩阵P: 设变换矩阵P 为
P=[pT      pZ       …pa]T                                              (9-200)
根据A阵变换要求，P 应满足式(9-199),有








展开为



P₁A=P₂
P₂A=P₃
:
Pn-1A=Pn
P₂A=-aoP₁-a₁P₂-…-an-1Pa




(9-201)





经整理有
P₁A=P₂
P₂A=P₁A²=P₃
:
P-1A=P₁A"-¹=Pa


由此可得变换矩阵

又根据b 阵变换要求，P 应满足式(9-199),有





(9-202)




(9-203)

即                    P₁[b         Ab          …A"-1b]=[0          …01]                                 (9-204)
故                    P₁=[0          …01][b         Ab          …A"-16]- ¹                                (9-205)
该式表明p₁ 是可控性矩阵的逆阵的最后一行，于是可得出变换矩阵P- ¹  的求法如下：
①计算可控性矩阵S=[b        Ab        …A"-1b];
②计算可控性矩阵的逆阵S-¹,  设一般形式为

(9-206)

③取出S- ¹  的最后一行(即第n 行)构成P₁ 行向量
P₁=[Sn                Sn₂…Sm]                                               (9-207)
④构造P 阵

(9-208)

⑤P-¹ 便是将非标准型可控系统化为可控标准型的变换矩阵。
(2)对偶原理
在研究系统的可控性和可观测性时，利用对偶原理常常带来许多方便。
设系统为Z₁(A,B,C),    则系统Z₂(AT,CT,BT) 为系统 ∑₁ 的对偶系统。其动态方程分别为
Z₁:x=Ax+Bu,                   y=Cx                                               (9-209)
Z₂:ż=ATz+CTv,w=BTz                                                          (9-210) 式中，x,z 均 为n 维状态向量；u,w  均为p 维向量；y,o 均为q 维向量。注意到系统与对偶系统之 间，其输入、输出向量的维数是相交换的，当Z₂ 为 ∑₁ 的对偶系统时，Z₁也 是Z₂ 的对偶系统。





不难验证，系统Z₁ 的可控性判别矩阵[B       AB        …A”-¹B]与对偶系统∑2的可观测性矩阵
[(BT)(AT)T(BT)T…((AT)T)"-¹(BT)]          完 全 相 同 ； 系 统 Z₁   的 可 观 测 性 矩 阵
[CT            ATCT…(AT)"-¹CT]与对偶系统Z₂ 的可控性判别矩阵[CT              ATCT…(AT)"-¹Cr]完
全相同。
应用对偶原理，能把可观测的单输入-单输出系统化为可观测标准型的问题转化为将其对偶 系统化为可控标准型的问题。设单输入-单输出系统动态方程为
x=Ax+bu,y=cx                                                                    (9-211)
系统可观测，但A,c  不是可观测标准型。其对偶系统动态方程为
之=ATz+cTv,w=b⁷z                                                             (9-212) 对偶系统一定可控，但不是可控标准型。可利用已知的化为可控标准型的原理和步骤，先将对偶 系统化为可控标准型，再一次使用对偶原理，便可获得可观测标准型。下面仅给出其计算步骤：
1)列出对偶系统的可控性矩阵(即原系统的可观测性矩阵V₁)
S₂=V₁=[cT                    ATcT…(AT)”-¹cT]                                    (9-213)
2)求V₁  的逆阵V¹, 且记为行向量组
                            (9-214)
3)取V¹ 的 第n 行v7,并按下列规则构造变换矩阵P:



4)求P 的逆阵P-¹,并引入P-¹ 变换，即z=P-¹z,  变换后动态方程为
之=PATP-¹z+PcTv,w=bFP-¹
5)对对偶系统再利用对偶原理，便可获得原系统的可观测标准型，结果为
x=(PATp-¹)Tx+(bTp-1)Tu=P-TAPTx+P-Tbu y=(PcT)x=cPTx
与原系统动态方程相比较，可知将原系统化为可观测标准型需要进行PT 变换，即令
x=PTx
其 中                        PT=[vn              Av 。 …A"-1vn]



(9-215)



(9-216)

(9-217) (9-218)

(9-219) (9-220)

vn为原系统可观测性矩阵的逆阵中第n 行的转置。
(3)非奇异线性变换的不变特性
从前面的研究中可以看到，为了便于研究系统固有特性，常常需要引入非奇异线性变换。例 如：将A阵对角化或约当化，需进行P 变换；将A,b 化为可控标准型，需进行P- ¹  变换；将A,c  化 为可观测标准型，需进行PT 变换。虽然这些变换中的P  阵各不相同，但都是非奇异矩阵。经过变 换后，系统的固有特性是否会引起改变呢?这当然是人们在研究线性变换时所需要回答的一个重
·493 ·





要问题。下面的研究将会表明，系统经过非奇异线性变换，其特征值、传递矩阵、可控性、可观测性 等重要性质均保持不变。下面以P 变换为例进行论证。
设系统动态方程为
x=Ax+Bu,y=Cx+Du
令x=Px,  变换后动态方程为
京=P-¹APx+P-¹Bu,y=y=CPx+Du
1)变换后系统特征值不变。变换后系统的特征值为
|N-P-¹AP|
=|AP-¹P-P-¹AP|=|P-¹AP-P-¹AP|
=|P-¹(AI-A)P|=|P-¹||A-A||P|=|P-¹||P||N-A|
=|P-¹P||A-A|=|1||N-A|=|N-A|
可见，系统变换后与变换前的特征值完全相同，这说明对于非奇异线性变换，系统特征值具有不 变性。
2)变换后系统传递矩阵不变。变换后系统的传递矩阵为
G(s)=CP(sI-P-¹AP)-¹P-¹B+D
=CP(P-¹sIP-P-¹AP)-¹p-¹B+D =CP[P-¹(sI-A)P]-¹P-¹B+D
=CPP-¹(sI-A)-¹PP-¹B+D =C(sI-A)-¹B+D=G(s)
这表明变换前与变换后系统的传递矩阵完全相同，系统的传递矩阵对于非奇异线性变换具有不 变性。
3)变换后系统可控性不变。变换后系统可控性矩阵的秩为
rankS'=rank[P-¹B(P-¹AP)P-¹B(P-¹AP)²P-¹B                                …(P-¹AP)"-IP-¹B]
=rank[P-¹B       P-¹AB       P-¹A²B        …P-¹A"-¹B]
=rankP-¹[B      AB      A²B       …A"-¹B]
=rank[B      AB      A²B      …A"-¹B]=rank      S
式中，S'为变换后系统的可控性矩阵；S为变换前系统的可控性矩阵。可见，变换后与变换前系统 可控性矩阵的秩相等，根据系统可控性的秩判据可知，对于非奇异线性变换，系统的可控性不变。
4)变换后系统可观测性不变。设变换后系统的可观测性矩阵为V', 变换前系统的可观测性 矩阵为V, 则有
rankV¹=rank[(CP)           (P-¹AP)(CP)T((P-¹AP)²)T(CP)T …((P-¹AP)"-)T(CP)]
=rank[PTC     PTATCT      PT(A²)CT      …PT(A"-1)TCT] =rankPT[CT              ATCT(A²)TCT…(A"-¹)TCT]
=rank[CT          ATCT(A²)TCT…(A"-I)TCr]=rank           V
可见，变换后与变换前系统的可观测性矩阵的秩相等，故系统的可观测性不变。




(4)线性定常系统的结构分解
系统中只要有一个状态变量不可控便称系统不可控，因而不可控系统便含有可控和不可控  两种状态变量。类似地，系统中只要有一个状态变量不可观测便称系统不可观测，不可观测系统  含有可观测和不可观测两种状态变量。从可控性和可观测性出发，状态变量便可分为可控可观测  x 、可控不可观测xc、不可控可观测xz、不可控不可观测xπ 四类。由对应状态变量构成的子空间  也分为四类，因而系统也对应分成了四类子系统，称为系统的结构分解，也有的参考文献称此为  系统的规范分解。研究结构分解可以更明显地揭示系统的结构特性、传递特性。研究方法是选取  一种特殊的线性变换，使原来的状态向量x 变换成[x!xl                    xx]T,相应地使原动态方程中  的 A,B,C  矩阵变换成某种标准构造的形式。结构分解过程可先从整个系统的可控性分解开始， 将可控与不可控的状态变量分离开，继而分别对可控和不可控子系统进行可观测性分解，便可以  分离出四类状态变量及四类子系统。当然，结构分解的过程也可以从系统的可观测性分解开始。 下面着重介绍结构分解的方法，有关证明略去。
1)系统按可控性的结构分解。设不可控系统的动态方程为
x=Ax+Bu,y=Cx                                                                  (9-221)  式中，x 为 n 维状态向量；u 为 p 维输入向量；y 为 q 维输出向量；A,B,C  为具有相应维数的矩阵。 若系统可控性矩阵的秩为r(r<n),       则可从可控性矩阵中选出r 个线性无关的列向量s₁,S₂, … ,
s,, 另外再任意选取尽可能简单的n-r    个n 维列向量S,+1,8r+2, …,sn, 使它们与{S₁,S₂,…,s,}   线 性 无关，这样就可以构成n×n    非奇异变换矩阵。
P-¹=[s₁S₂…s,                       S,+1…sn]


对式(9-221)进行非奇异线性变换

式(9-221)便变换为下列的规范形式：












(9-222)


(9-223)

式中，x.为 r 维可控状态子向量；xe为 n-r      维不可控状态子向量，并且

r列   n-r   列                    p列
CP-1=[C₁                      C₂]q     行                                  (9-224)
r 列  n-r    列
展开式(9-223),有
i.=A₁₁x.+A₁₂x₂+B₁u
xz=A2₂xe
y=C₁x.+C₂x.
将输出向量进行分解，令y=y₁+y₂,         则可得子系统动态方程，其中可控子系统动态方程为
i.=A₁₁x.+A₁₂xa+B₁u,y₁=C₁x.                                                           (9-225)
不可控子系统动态方程为





i₂=Az₂₂xe,y₂=C₂xe
上述系统结构分解方式称之为可控性规范分解，系统方块图如图9-23所示。

图9-23 可控性规范分解方块图
系统结构的可控性规范分解具有下列特点： ①由于
rank[B      AB       …A"-¹B]
=rank[PB(PAP-¹)(PB)…(PAP-¹)"-¹(PB)]

=rank[B₁A₁B₁…Ai-¹B₁]
=r                                                                                                                   (9-227)
C(sI-A)-¹B=(CP-¹)(sI-PAP-1)-¹(PB)



=C₁(sI-A₁₁)-¹B₁                                                                                                  (9-228) 因而r 维系统(A₁,B₁,C₁)    是可控的，并且和系统(A,B,C)   具有相同的传递函数矩阵。如果从传 递特性的角度分析系统(A,B,C) 时，可以等价地用分析子系统(A,B₁,C₁)  来代替，由于后者维 数降低了很多，可能会使分析变得简单。
②输入u 只能通过可控子系统传递到输出，而与不可控子系统无关，故u 到y 之间的传递函 数矩阵描述不能反映不可控部分的特性，这就从物理意义上进一步说明了可控子系统(A,B₁,
C₁) 和系统(A,B,C)   具有相同的传递函数矩阵。但是，不可控子系统对整个系统的影响是存在 的，不可忽视。因而要求A22仅含稳定特征值，以保证整个系统稳定，并且应考虑到可控子系统的 状态响应x.(t)  和整个系统的输出响应y(t)  均与不可控子系统的状态xe 有关。





③由于选取非奇异变换阵P-¹ 的列向量s₁,S₂,…,s,及 Sr+1,…,sn的非唯一性，虽然系统可 控性规范分解的形式不变，但诸系数阵不相同，故可控性规范分解不是唯一的。
④由于
det(sI-A)=det(sI-A)·det(sI-A₂₂)                                                             (9-229)
故x. 的稳定性完全由A   的特征值λ₁,d₂,…,A  决定；x  的稳定性完全由A22的特征值λ+1,…,入决  定，而A₁,λ2, … ,     都 是A 的特征值。d₁,…,A, 称为系统(A,B,C)    的可控因子或可控振型，2+1, … , λ称为不可控因子或不可控振型。
⑤可控性规范分解表达式(9-223)也为系统(9-221)的可控性判别提供了一个准则，即线性 定常系统完全可控的充分必要条件是，系统经过非奇异线性变换不能化为式(9-223)的形状，其 中A₁  的阶数r<n 。 按照上面所述的非奇异线性变换阵P- ¹  的选取方法，利用计算机进行线性变 换计算，可以比较容易地确定系统(A,B,C) 的可控性。对于维数较大系统的可控性判别，这是一
种较好的方法。
例9-21 已知系统(A,b,c), 其中

试按可控性分解为规范形式。
解系统可控性矩阵为

rankS=2<n=3
故系统不可控。从可控性矩阵中选出两个线性无关的列向量[001]T和 [ - 1 0 3 ]T,附 加 任意列向量[010],构成非奇异变换阵P-1

计算矩阵P 和变换后的各矩阵


可控子系统动态方程为

不可控子系统动态方程为
i=x,y₂=               一x





2)系统按可观测性的结构分解。系统按可观测性结构分解的所有结论，都对偶于系统按可
控性结构分解的结果。设不可观测系统的动态方程为
(9-230)
式中，x 为 n 维状态向量；u 为 p 维输入向量；y 为 q 维输出向量。系统的可观测性矩阵为

个与之




(9-231)



对式(9-230)不可观测系统进行非奇异线性变换
(9-232)
可得系统结构按可观测性分解的规范表达式
(9-233)
式中，x。为 L维可观测状态子向量；x₆ 为 n-l      维不可观测状态子向量，并且

l列   n-1  列                    p列
CT-¹=[C₁0           ]行 L列 n-l    列
展开式(9-233),有
x 。=A₁₁x 。+B₁u
x=Az₁x 。+A₂₂x₀+Bzu
y=C₁x。
可观测子系统动态方程为
x 。=Ax 。+B₁u,y₁=C₁x 。=y 不可观测子系统动态方程为
xg=A₂1x 。+A₂2x+B₂u,y₂=0 系统的结构方块图如图9-24所示。







图9-24 可观测性规范分解方块图

设

C=CT-¹=[C          0]
与可控性规范分解相类似，称系统(A,B,C)     为系统(A,B,C)   的可观测规范分解。可观测性规范 分解也有与可控性规范分解相类似的分析与结论。
例9-22 试将例9-21所示系统按可观测性进行分解。
解系统的可观测性矩阵为

rankV=2<n=3
故系统不可观测。从可观测性矩阵中选取两个线性无关行向量[1 - 11]和[2 -32], 再选取一个与之线性无关的行向量[001],构成非奇异变换矩阵

计算变换后各矩阵


cT-¹=[100]

可观测子系统动态方程为
,y₁=[10]x 。=y





不可观测子系统动态方程为
i=[-53]x 。+2x+u,y₂=0 ·

9-3 线性定常系统的反馈结构及状态观测器

无论是在经典控制理论还是在现代控制理论中，反馈都是系统设计的主要方式。但由于经典 控制理论是用传递函数来描述的，它只能用输出量作为反馈量。而现代控制理论由于采用系统内 部的状态变量来描述系统的物理特性，因而除了输出反馈外，还经常采用状态反馈。在进行系统 的分析综合时，状态反馈能提供更多的校正信息，因而在形成最优控制规律、抑制或消除扰动影 响、实现系统解耦控制等方面，状态反馈均获得了广泛应用。
为了利用状态进行反馈，必须用传感器来测量状态变量，但并不是所有状态变量在物理上都 可测量，于是提出了用状态观测器给出状态估值的问题。因此，状态反馈与状态观测器的设计便 构成了用状态空间法综合设计系统的主要内容。
1.线性定常系统常用反馈结构及其对系统特性的影响
(1)两种常用反馈结构
在系统的综合设计中，两种常用的反馈形式是线性直接状态反馈和线性非动态输出反馈，简 称为状态反馈和输出反馈。
1)状态反馈。设有n 维线性定常系统
x=Ax+Bu,y=Cx                                                                  (9-237)
式中，x,u,y   分别为n 维 、p 维 和q 维向量；A,B,C  分别为n×n,n×p,q×n                实数矩阵。
当将系统的控制量u 取为状态变量的线性函数
u=v-Kx                                                                                                 (9-238)
时，称之为线性直接状态反馈，简称为状态反馈，其中v 为p 维参考输入向量，K 为(p×n)     维实反
馈增益矩阵。在研究状态反馈时，假定所有的状态变量都是可以用来反馈的。 将式(9-238)代入式(9-237)可得状态反馈系统动态方程
x=(A-BK)x+Bv,y.=Cx                                                                (9-239)
其传递函数矩阵为
Gk(s)=C(sI-A+BK)-¹B                                                            (9-240)
因此可用{A-BK,B,C}         来表示引入状态反馈后的闭环系统。由式(9-239)可以看出，引入状态 反馈后系统的输出方程没有变化。
4
加入状态反馈后系统结构图如图9-25所示。

图9-25 加入状态反馈后系统结构图





2)输出反馈。系统的状态常常不能全部测量到，因而状态反馈法的应用受到了限制。在此情 况下，人们常常采用输出反馈法。输出反馈的目的首先是使系统闭环成为稳定系统，然后在此基 础上进 一 步改善闭环系统性能。
输出反馈有两种形式：一种是将输出量反馈至状态微分，另一种是将输出量反馈至参考 输入 。
输出量反馈至状态微分系统结构图如图9-26所示。输出反馈系统的动态方程为

图9-26 输出反馈至状态微分系统结构图
x=Ax+Bu-Hy=(A-HC)x+Bu,y=Cx                                             (9-241)
其传递函数矩阵为
GH(s)=C(sI-A+HC)-¹B                                                                      (9-242) 将输出量反馈至参考输入系统结构图如图9-27所示。当将系统的控制量u 取为输出y 的线
性函数
u=v-Fy                                                                              (9-243) 时，称之为线性非动态输出反馈，常简称为输出反馈，其中v 为 p 维参考输入向量，F 为 p×q    维 实 反馈增益矩阵。这是一种最常用的输出反馈，在一些参考书中往往只介绍这一种输出反馈，而不 介绍输出至状态微分的反馈。
将式(9-243)代入式(9-237)可得输出反馈系统动态方程
x=(A-BFC)x+Bv,y=Cx                                                                          (9-244)
其传递函数矩阵为
GF(s)=C(sI-A+BFC)-¹B                                              (9-245)

图9-27 输出反馈至参考输入系统结构图
不难看出，不管是状态反馈还是输出反馈，都可以改变状态的系数矩阵，但这并不表明二者 具有等同的功能。由于状态能完整地表征系统的动态行为，因而利用状态反馈时，其信息量大而 完整，可以在不增加系统维数的情况下，自由地支配响应特性。而输出反馈仅利用了状态变量的 线性组合进行反馈，其信息量较小，所引入的补偿装置将使系统维数增加，且难以得到任意的所




期望的响应特性。一个输出反馈系统的性能，一定有对应的状态反馈系统与之等同，例如对于图 9-27所示输出反馈系统，只要令FC=K    便可确定状态反馈增益矩阵。但是，对于一个状态反馈系 统，却不一定有对应的输出反馈系统与之等同，这是由于令K=FC    来求解矩阵F 时，有可能因F  含有高阶导数而无法实现。对于非最小相位被控对象，如果含有在复平面右半平面上的极点，并 且选择在复平面右半平面上的校正零点来加以对消时，便会有不稳定的隐患。但是，由于输出反 馈所用的输出变量总是容易测量的，实现起来比较方便，因而获得了较广泛的应用。对于状态反 馈系统中不便测量或不能测量的状态变量，需要利用状态观测器进行重构。有关状态观测器的设 计问题，后面将作进一步阐述。
(2)反馈结构对系统性能的影响
由于引入反馈，系统状态的系数矩阵发生了变化，对系统的可控性、可观测性、稳定性、响应 特性等均有影响。
1)对系统可控性和可观测性的影响。
定理9- 1 对于系统(9-237),状态反馈的引入不改变系统的可控性，但可能改变系统的可 观测性。
证明  设被控系统2。的动态方程为
x=Ax+Bu,y=Cx
加入状态反馈后系统Zk 的动态方程为
x=(A-BK)x+Bv,y=Cx
首先证明状态反馈系统Zk 可控的充分必要条件是被控系统 ∑。可控。 系统 ∑。的可控性矩阵为
S.=[B         AB          …A"-¹B]
系统 

	Sek=[B(A-BK)B	…(A-BK)"-¹B]
由于	B=[b₁b₂…bp],AB=[Ab₁Ab₂…Abp]	
(A-BK)B=[(A-BK)b₁(A-BK)b₂…(A-BK)bp] 式中，b;(i=1,2,…,p)          为列向量。将K 表示为行向量组



则


令                      Ci=k₁bi,Cz=k₂b₁,…,Cx=k,b;
式中，c;(j=1,2,…,p)  均为标量。故
(A-BK)b;=Ab₂-(c₁ib₁+c₂;b₂+…+cbp)





这说明(A-BK)B    的列是[B      AB]列的线性组合。同理有(A-BK)²B     的列是[B     AB     A²B]列
的线性组合，如此等等，故Sck的每一列均可表为S.的列的线性组合。由此可得
rankSk≤rankS.                                                           (9-246)
另一方面，∑。又可看成为Zk 的状态反馈系统，即
x=Ax+Bu=[(A-BK)+BK]x+Bu
同理可得
rankS,≤rankSk                                                           (9-247)
由式(9-246)和式(9-247)可得
rankSk=rankS.                                                           (9-248)
从而当且仅当 ∑。可控时，k 可控。
再来证明状态反馈系统不一定能保持可观测性，对此只需举一反例说明。例如，考察
,y=[11]x 其可观测性判别阵
,rankV 。=n=2
故该系统可观测。现引入状态反馈，取k=[04],          则状态反馈系统 

其可观测性判别阵
,rankV 。k=1<n=2
故该状态反馈系统为不可观测。而若取k=[05],    则通过计算可知，此时它成为可观测的。这表 明状态反馈可能改变系统的可观测性，其原因是状态反馈造成了所配置的极点与零点相对消。
定理9-2 对于系统(9-237),输出至状态微分反馈的引入不改变系统的可观测性，但可能 改变系统的可控性。
证明用对偶定理证明。设被控对象 ∑。为(A,B,C),   将输出反馈至状态微分的系统ZH 为  ((A-HC),B,C),         若(A,B,C)   可观测，则对偶系统(A⁷,CT,B)    可控，由定理9-1可知，系统(A',     CT,BT) 加入状态反馈后的系统((A⁷-CTH),CT,B)     的可控性不变，但可能改变其可观测性。 因而有
rank[CT         ATCT…(AT)”-¹CT]
=rank[CT(AT-CTHT)CT…(AT-CTHT)“-CT]
=rank[CT(A-HC)TCT…((A-HC)T)"-C"]                                                (9-249) 上式表明，系统 ∑。与系统 。可观测，则  的，输出至状态微分反馈的引入不改变系统的可观测性。
由于系统(AT,CT,BT)的可观测性判别阵为
V 。=[(BT)T(AT)T(BT)T…((AT)T)"-¹(BT)]
=[B       AB        …A"-¹B] 系统((AT-CTH),CT,BT)      的可观测性判别阵为





VoH=[(BT)T(AT-CTHT)T(BT)T…((AT-CTH)T)"-¹(BT)] =[B(A-HC)B…(A-HC)"-¹B]
系统加入状态反馈后可能改变其可观测性意味着有可能使得
rankV 。≠rankVoH                                                      (9-250) 因为V。也是系统Z  的可控性判别阵，VoH又是系统 状态微分的反馈可能改变系统的可控性。证毕。
定理9-3 对于系统(9-237),输出至参考输入反馈的引入能同时不改变系统的可控性和可 观测性，即输出反馈系统ZF 为可控(可观测)的充分必要条件是被控系统 ∑。为可控(可观测)。
证明 首先，由于对任一输出至参考输入的反馈系统都能找到一个等价的状态反馈系统，由 定理9-1知状态反馈可保持可控性，因而输出至参考输入反馈的引入不改变系统的可控性。
由于 ∑。和p   的可观测性判别阵分别为

并且

式中，c;(i=1,2,…,q)        为行向量，将F 表为列向量组{f;},  即F=[f₁f₂…f,],                      则
c;(A-BFC)=c₁A-c;B(f₁c₁+f₂c₂+…+f₄C₄)
=C₁A-[(c;Bf₁)c₁+(c;Bf₂)c₂+…+(c;Bf₄)c₄]
令式中c;Bf,=a;,a;      为标量，j=1,2, …,q,       则有
c;(A-BFC)=c₁A-(a₁C₁+a₂C₂+…+a₉Cg)
该式表明C(A-BFC)       的行是[CT  ATCT]T的行的线性组合。同理有C(A-BFC)²       的行是 [CT     ATCT(AT)²CT]的行的线性组合，如此等等。故VoF的每一行均可表为V。的行的线性组 合，由此可得
rankV 。F≤rankV 。                        (9-251)
由于 ∑。又可看成为ZF的输出反馈系统，因而有
rankV。≤rankV。f                                                       (9-252)
由式(9-251)和式(9-252)可得
rankV。=rankV。F                                                    (9-253)
这表明输出至参考输入的反馈可保持系统的可观测性。证毕。
2)对系统稳定性的影响。状态反馈和输出反馈都能影响系统的稳定性。加入反馈，使得通过 反馈构成的闭环系统成为稳定系统，称之为镇定。由于状态反馈具有许多优越性，且输出反馈系




统总可以找到与之性能等同的状态反馈系统，故在此只讨论状态反馈的镇定问题。对于线性定常 被控系统
x=Ax+Bu                                                                (9-254)
如果可以找到状态反馈控制律
u=-Kx     十v                                                            (9-255)
其中，v为参考输入，使得通过反馈构成的闭环系统
x=(A-BK)x+Bv                                                           (9-256)
是渐近稳定的，即(A-BK)     的特征值均具有负实部，则称系统实现了状态反馈镇定。
定理9-4 当且仅当线性定常系统的不可控部分渐近稳定时，系统是状态反馈可镇定的。 证明  由于{A,B} 不完全可控，则一定可引入非奇异线性变换进行结构分解，使得
(9-257)
式 中 ，A. 为可控状态子矩阵；A: 为不可控状态子矩阵；B.为可控输入子矩阵。并且对任意 K=[K₁K₂]         可导出
det(sI-A+BK)=det(sI-A+BK)

=det(sI-A.+B.K₁)det(sI-A)                                                             (9-258) 由于{A,B}   为可控系统，故必存在K₁ 使(A-B.K₁)      的特征值均具有负实部。又因为状态反馈 对不可控子系统的极点毫无影响，从而可知欲使(A-BK)      的特征值均具有负实部，只有使不可 控部分A 的特征值均具有负实部。这表明系统由状态反馈可镇定的充分必要条件是不可控部分 渐近稳定。证毕。
2.系统的极点配置
状态反馈和输出反馈都能改变闭环系统的极点位置。所谓极点配置就是利用状态反馈或输 出反馈使闭环系统的极点位于所希望的极点位置。由于系统的性能和它的极点位置密切相关，因 而极点配置问题在系统设计中是很重要的。这里需要解决两个问题：一是建立极点可配置的条 件；二是确定极点配置所需要的反馈增益矩阵。
(1)极点可配置条件
这里给出的极点可配置条件既适合于单输入-单输出系统，也适合于多输入-多输出系统。
1)利用状态反馈的极点可配置条件。
定理9-5 利用状态反馈任意配置闭环极点的充分必要条件是被控系统可控。
证明  下面就单输入-多输出系统来证明该定理。这时被控系统(A,B,C) 中 的B 为一列向 量，记为b。
充分性：若系统(A,b)  可控，则通过非奇异线性变换x=P-¹x      可变换为可控标准型
x=Ax+bu                                                                (9-259)
式中






在单输入情况下，引入状态反馈
u=v-kx=v-kP-¹x=v—kx                                                                 (9-260)
其 中
K=kP-¹=[k 。k₁…k-1] 则引入状态反馈后闭环系统的状态阵为


(9-261)


对于式(9-261)这种特殊形式的矩阵，容易写出其闭环特征方程 det[sI-(A-bk)]=s"+(an-1+kn-1)s"-¹+(an-2+kn-2)s"-2
十 … +(a₁+k₁)s+(ao+k)=0                    (9-262)
显然，该n 阶特征方程中的n 个系数，可通过κ。,k₁,…,kn-1  来独立设置，也就是说(A-bk)       的 特
征值可以任意选择，即系统的极点可以任意配置。
必要性：如果系统(A,b)  不可控，就说明系统的有些状态将不受u 的控制，则引入状态反馈 时就不可能通过控制来影响不可控的极点。证毕。
2)利用输出反馈的极点可配置条件。
定理9-6 用输出至状态微分的反馈任意配置闭环极点的充分必要条件是被控系统可观 测。
证明  下面以多输入-单输出系统为例给出定理的证明。根据对偶定理可知，若被控系统 (A,B,c) 可观测，则对偶系统(A⁷,cT,B)  可控，由状态反馈极点配置定理知(AT-cTh)    的 特 征
值可任意配置，其中h 为 n×1    输出反馈阵。由于(AT-cThT)    的特征值与(AT-cThT)T=A-hc      的特征值相同，故当且仅当系统(A,B,c)   可观测时，可以任意配置(A-hc)       的特征值。证毕。
为了根据期望闭环极点来设计输出反馈矩阵h 的参数，只需将期望的系统特征多项式与该 输出反馈系统特征多项式|N-(A-hc)|             相比即可。
对于多输入-单输出被控系统来说，当采用输出至参考输入的反馈时，反馈增益矩阵F  为 p×1     维，记为f,  则
u=v-fy                                                                         (9-263)
输出反馈系统的动态方程为
x=(A-Bfc)x+Bv,y=cx                                                                   (9-264)  若令fc=K,      该输出反馈便等价为状态反馈。适当选择f,   可使特征值任意配置。但是，当比例的 状态反馈变换为输出反馈时，输出反馈中必定含有输出量的各阶导数，于是f  阵不是常数矩阵， 这会给物理实现带来困难，因而其应用受限。可推论，当f  是常数矩阵时，便不能任意配置极点。





(2)单输入-单输出系统的极点配置算法
在这里给出一种计算状态反馈增益矩阵的规范算法。
给定可控对(A,b)   和一组期望的闭环特征值{A₁,A₂, …,λ},     要确定(1×n)  维的反馈增益向
量k,  使闭环系统状态矩阵(A-bk)      的特征值为{λ₁,A₂,…,λ}。 第1步：计算A 的特征多项式，即
det                             [sI-A]=s"+an-15"¹+…+a₁s+a。
第2步：计算由{λ₁,A₂,…,λ}所决定的希望特征多项式，即 ai(s)=(s-λ₁)(s-λ2)…(s-λ)
=s"+an-1s"-¹+…+ais+ai
第3步：计算k
k=[ai-ao                                     ai-a₁…ai-1-an-1]
第4步：计算变换矩阵

第5步：求P;
第6步：计算反馈增益向量k=kP。
应说明的是，上述规范算法也适用于单输入-多输出系统。在求解具体问题时，不一定要化 为可控标准型，可直接计算状态反馈系统的特征多项式det[sI-A+bk],            令其各项的系数与希 望特征多项式中对应项的系数相等，便可确定反馈增益向量k。
例9-23 已知单输入线性定常系统的状态方程为

求状态反馈向量k, 使系统的闭环特征值为
λ₁=-2,λ2=-1+j,λ3=-1-j
解系统的可控性判别矩阵为

rankS.=3=n 系统可控，满足可配置条件。系统的特征多项式为

希望特征多项式为
ai(s)=(s-λ₁)(s-λ2)(s-λ3)=(s+2)(s+1-j)(s+1+j)







于是可求得

变换矩阵为




K=[ai-ao


=s³+4s²+6s+4

ai-a₁ai-az]=[4




-66




-14]




或令
ao°(s)=det(sI-A+bk)

=s³+(k₁+18)s²+(18k₁+k₂+72)s+(72k₁+12kz+k₃)
于是有                              k₁+18=4
18k₁+k₂+72=6   72k₁+12k₂+k₃=4
可求得                   k₁=-14,k₂=186,k₃=-1220
k=[k₁k₂k₃]=[-14186                                     -1220]
(3)状态反馈对传递函数零点的影响
状态反馈在改变系统极点的同时，是否对系统的零点产生影响?下面来分析回答这一问题。
已知完全可控的单输入-单输出线性定常系统可经适当非奇异线性变换化为可控标准型
x=Ax+bu,y=cx                                                                    (9-265)
被控系统的传递函数为
G(s)=c(sI-A)-¹b=c(sI-A)-b

(9-266)
引入状态反馈后的闭环系统传递函数为 Gk(s)=c(sI-A+bk)-¹b=c(sI-A+bk)-b






                                (9-267)
上述推导表明，由于adj(sI-A) 与adj(sI-A+bk)   的 第n 列相同，故G(s)与Gx(s) 的分子多 项式相同，即闭环系统零点与被控系统零点相同，状态反馈对G(s) 的零点没有影响，仅使G(s) 的极点改变为闭环系统极点。然而可能有这种情况：引入状态反馈后恰巧使某些极点移到G(s)   的零点处而构成极、零点对消，这时既失去了一个系统零点，又失去了一个系统极点，并且被对消 掉的那些极点可能不可观测。这也是对状态反馈可能使系统失去可观测性的一个直观解释。
3.全维状态观测器及其设计
当利用状态反馈配置系统极点时，需要用传感器测量状态变量以便实现反馈。但在许多情况 下，通常只有被控对象的输入量和输出量能够用传感器测量，而多数状态变量不易测得或不可能 测得，于是提出了利用被控对象的输入量和输出量建立状态观测器(又称为状态估计器、状态重 构器)来重构状态的问题。当重构状态向量的维数等于被控对象状态向量的维数时，称为全维状 态观测器。
(1)全维状态观测器构成方案 设被控对象动态方程为
x=Ax+Bu,y=Cx                                                              (9-268) 构造一个动态方程与式(9-268)相同且能用计算机实现的模拟被控系统
=Ax+Bu,y=Cx                                                     (9-269) 式中，&,y 分别为模拟系统的状态向量和输出向量，是被控对象状态向量和输出向量的估值。当 模拟系统与被控对象的初始状态向量相同时，在同一输入作用下，有x=x,    可用x 作为状态反馈 所需用的信息。但是，被控对象的初始状态可能很不相同，模拟系统中积分器初始条件的设置又
只能预估，因而两个系统的初始状态总有差异，即使两个系统的A,B,C 阵完全一样(完全一样通 常是不可能的),也必定存在估计状态与被控对象实际状态的误差(x-x),      难以实现所需要的状 态反馈。但是，(x-x)      的存在必定导致(y-y)       的存在，而被控系统的输出量总是可以用传感器
测量的，于是可根据一般反馈控制原理，将(y-y)  负反馈至x 处，控制(y-y)  尽快逼近于零，从 而使(x-x)      尽快逼近于零，便可以利用x 来形成状态反馈。按以上原理构成的状态观测器及其 实现状态反馈的结构图如图9-28所示。状态观测器有两个输入，即u 和y, 输出为x。观测器含n 个
积分器并对全部状态变量作出估计。H 为观测器输出反馈阵，它把(j-y)       负反馈至x 处，是为配 置观测器极点，提高其动态性能，即尽快使(x-x)     逼近于零而引入的，它是前面所介绍过的一种 输出反馈。
(2)全维状态观测器分析设计
由图9-28可列出全维状态观测器动态方程
x=Ax+Bu-H(y-y),y=Cx                                                 (9-270)






图9-28 状态观测器及其实现状态反馈结构图
故有            &=Ax+Bu-HC(x-x)=(A-HC)x+Bu+Hy                                                    (9-271)
式中，(A-HC)      称为观测器系统矩阵。观测器分析设计的关键问题是能否在任何初始条件下， 即尽管x(to)与 x(to)不同，但总能保证
                        (9-272) 成立。只有满足式(9-272),状态反馈系统才能正常工作，式(9-270)所示系统才能作为实际的状 态观测器，故式(9-272)称为观测器存在条件。
由式(9-271)与式(9-268)可得
x-c=(A-HC)(x-x)                                                               (9-273)
其解为                x(t)-&(t)=e(4-AC)(-[x(to)-x(to)]                                                   (9-274)
显见当x(to)=x(to)      时，恒有x(t)=x(t),        所引入的输出反馈并不起作用。当x(to)≠x(to)       时 ， 有x(t)≠x(t),输出反馈便起作用了，这时只要(A-HC)   的特征值具有负实部，初始状态向量 误差总会按指数衰减规律满足式(9-272),其衰减速率取决于极点配置。由前面的输出反馈定理  可知，若被控对象可观测，则(A-HC)      的极点可任意配置，以满足x 逼 近x  的速率要求，因而保 证了状态观测器的存在性。
定理9-7 若被控系统(A,B,C) 可观测，则其状态可用形如
x=Ax+Bu-HC(x-x)=(A-HC)x+Bu+Hy                                                     (9-275) 的全维状态观测器给出估值，其中矩阵H 按任意配置极点的需要来选择，以决定状态误差衰减 的速率。
选 择H 阵参数时，应注意防止数值过大带来的实现困难，如饱和效应、噪声加剧等，通常希 望观测器响应速度比状态反馈系统的响应速度要快些。
例9-24 设被控对象传递函数为

试设计全维状态观测器，将极点配置在-10,-10。 解被控对象的传递函数为






根据传递函数可直接写出系统的可控标准型
x=Ax+bu,y=cx

,c=[20]
显然，系统可控可观测。n=2,q=1,     输出反馈向量h 为2×1向量。全维状态观测器系统矩阵为

观测器特征方程为
X-(A-hc)|=λ²+(2h 。+3)λ+(6h 。+2h₁+2)=0 期望特征方程为
(λ+10)²=λ²+20λ+100=0
令两特征方程同次项系数相等，可得
2h 。+3=20,6h 。+2h₁+2=100
因而有                        ho=8.5,h₁=23.5
ho,h₁分别为由(y-y)  引至交，2的反馈系数。被控对象及全维状态观测器的状态变量图如
图9-29所示。

图9-29 例9-24全维状态观测器及被控对象的状态变量图
4.分离特性
当用全维状态观测器提供的状态估值x 代替真实状态x 来实现状态反馈时，为保持系统的





期望特征值，其状态反馈阵K 是否需要重新设计?当观测器被引入系统以后，状态反馈系统部分 是否会改变已经设计好的观测器极点配置，其观测器输出反馈阵H 是否需要重新设计?为此需 要对引入观测器的状态反馈系统作进一步分析。整个系统的结构图如图9-28所示，是一个2n 维

的复合系统，其中
u=v-Kx
状态反馈子系统动态方程为
x=Ax+Bu=Ax-BKx+Bv,y=Cx
全维状态观测器动态方程为
x=Ax+Bu-H(j-y)=(A-BK-HC)x+HCx+Bv
故复合系统动态方程为





(9-276) (9-277)
(9-278)


(9-279a)

(9-279b)

不用状态估值x,  而用状态误差(x-x),       将会使分析研究更加直观方便。由式(9-277)和
式(9-278)可得
x-€=(A-HC)(x-x)                                                                   (9-280)  该式与u,v  无关，即(x-x)       是不可控的。不管施加什么样的控制信号，状态误差总会衰减到零， 这正是所希望的，是状态观测器所具有的重要性质。对式(9-279)引入非奇异线性变换





则有







(9-281)

(9-282a)

(9-282b)

由于线性变换后系统传递函数矩阵具有不变性，由式(9-282)可导出系统传递函数矩阵
         (9-283) 利用分块矩阵求逆公式
                    (9-284)
可得                        G(s)=C[sI-(A-BK)]-¹B                                                               (9-285)
式(9-285)正是引入真实状态x 作为反馈的状态反馈系统
x=Ax+B(v-Kx)=(A-BK)x+Bv
y=Cx                                                                                                    (9-286)  的传递函数矩阵。这说明复合系统与状态反馈子系统具有相同的传递特性，与观测器部分无关， 可用估值状态x 代替真实状态x 作为反馈。2n 维复合系统导出了n×n  传递矩阵，这是由于





(x-x)      的不可控造成的。
由于线性变换后特征值具有不变性，由式(9-282)易导出其特征值满足关系式
(9-287)
该式表明复合系统特征值是由状态反馈子系统和全维状态观测器的特征值组合而成，且两部分 特征值相互独立，彼此不受影响，因而状态反馈矩阵K 和输出反馈矩阵H 可根据各自的要求来 独立进行设计，故有下述分离定理。
定理9-8(分离定理) 若被控系统(A,B,C)   可控可观测，用状态观测器估值形成状态反馈 时，其系统的极点配置和观测器设计可分别独立进行，即K 和 H  阵的设计可分别独立进行。
9-4  李雅普诺夫稳定性分析

稳定性是系统的重要特性，是系统正常工作的必要条件，它描述初始条件下系统方程的解是 否具有收敛性，而与输入作用无关。经典控制理论中已经建立了代数判据、奈奎斯特判据、对数判  据、根轨迹判据来判断线性定常系统的稳定性，但不适用于非线性、时变系统。分析非线性系统稳 定性及自振的描述函数法，要求系统的线性部分具有良好的滤除谐波的性能。而相平面法则只适 合一阶、二阶非线性系统。1892年俄国学者李雅普诺夫提出的稳定性理论是确定系统稳定性的  更一般性理论，它采用了状态向量描述，不仅适用于单变量、线性、定常系统，而且适用于多变量、 非线性、时变系统。在分析一些特定的非线性系统的稳定性时，李雅普诺夫理论有效地解决了用 其他方法所不能解决的问题。李雅普诺夫理论在建立一系列关于稳定性概念的基础上，提出了判  断系统稳定性的两种方法：一种方法是利用线性系统微分方程的解来判断系统稳定性，称之为李 雅普诺夫第一法或间接法；另一种方法是首先利用经验和技巧来构造李雅普诺夫函数，进而利用 李雅普诺夫函数来判断系统稳定性，称为李雅普诺夫第二法或直接法。由于间接法需要解线性系  统微分方程，求解系统微分方程往往并非易事，所以间接法的应用受到了很大限制。而直接法不 需解系统微分方程，给判断系统的稳定性带来极大方便，获得了广泛应用，并且在现代控制理论  的各个分支，如最优控制、自适应控制、非线性系统控制、时变系统控制等方面，不断得到应用与 发展。在今后的学习与工作中，读者还有可能会接触到超稳定性理论。尽管超稳定性理论有着许  多优点，在系统的分析与综合中提供了不少方便和灵活性，但其应用范围主要是线性定常系统或  线性慢时变系统，不如李雅普诺夫稳定性理论应用广泛。限于篇幅，这里主要介绍李雅普诺夫第 二法(直接法)的一些基本定理和在线性系统稳定性分析中的应用，对于该理论在非线性系统分  析设计中的一些卓著研究成果未予涉及。
1.李雅普诺夫意义下的稳定性 设系统方程为
x=f(x,t)                                                                    (9-288)
式中，x 为 n 维状态向量，且显含时间变量t;f(x,t)      为线性或非线性、定常或时变的n 维向量函
数，其展开式为
i;=f₁(x₁,x₂,…,xn,t);i=1,2,…,n                                                            (9-289) 假定方程的解为x(t;xo;to),   式 中xo 和t。分别为初始状态向量和初始时刻，则初始条件xo 必满足 x(to;xo,to)=x₀。




(1)平衡状态
李雅普诺夫关于稳定性的研究均针对平衡状态而言。对于所有t, 满足
文，=f(x,,t)=0                                                               (9-290) 的状态x, 称为平衡状态。平衡状态的各分量相对于时间不再发生变化。若已知状态方程，令x=0    所求得的解x, 便是一种平衡状态。
线性定常系统x=Ax,    其平衡状态满足Ax,=0,      当 A 为非奇异矩阵时，系统只有唯一的零 解，即只存在一个位于状态空间原点的平衡状态。若A 为奇异矩阵，则系统存在有无穷多个平衡 状态。对于非线性系统，可能有一个或多个平衡状态。
(2)李雅普诺夫意义下的稳定性
设系统初始状态位于以平衡状态x, 为球心、8为半径的闭球域S(8)   内，即
llxo-x.|≤δ,t=to                                                                      (9-291)
若能使系统方程的解x(t;xo,t₀)    在 t→0      的过程中，都位于以x, 为球心、任意规定的半径为e 的
闭球域S(e) 内，即
llx(t;xo,to)-xo≤e,t≥to                                                                  (9-292) 则称系统的平衡状态x, 在李雅普诺夫意义下是稳定的。该定义的平面几何表示如图9-30(a)  所 示。式中Ⅱ · Ⅱ为欧几里得范数，其几何意义是空间距离的尺度。例如|xo-x.|      表示状态空间 中xo 点 至x.点之间距离的尺度，其数学表达式为
lx。-x.l=[(x₁-Tr)²+…+(xn-tm)²]  立            (9-293)
实数δ与e 有关，通常也与t。有关。如果δ与to无关，则称平衡状态是一致稳定的。









(a)                                         (b)                                       (c)
图9-30 有关稳定性的平面几何表示
(a)李雅普诺夫意义下的稳定性；(b)渐近稳定性；(c)不稳定性
应当注意，按李雅普诺夫意义下的稳定性定义，当系统作不衰减的振荡运动时，将在平面描 绘出一条封闭曲线，但只要不超出S(e),则认为是稳定的，这与经典控制理论中线性定常系统稳 定性的定义是有差异的。经典控制理论中的稳定性，指的是渐近稳定性。
(3)渐近稳定性
若系统的平衡状态x, 不仅具有李雅普诺夫意义下的稳定性，且有
(9-294)
则称此平衡状态是渐近稳定的。这时，从S(8)  出发的轨迹不仅不会超出S(e),   且当t→ 四时收敛 于x,, 其平面几何表示如图.9-30(b)  所示。显见经典控制理论中的稳定性定义与此处的渐近稳定





性对应。
若δ与t。无关，且式(9-294)的极限过程与to无关，则称平衡状态是一致渐近稳定的。
(4)大范围(全局)渐近稳定性
当初始条件扩展至整个状态空间，且平衡状态均具有渐近稳定性时，称此平衡状态是大范围 渐近稳定的。此时δ →0,S(8)→∞ 。 当t→ ○    时，由状态空间中任一点出发的轨迹都收敛至x
对于严格线性的系统，如果它是渐近稳定的，则必定是大范围渐近稳定的，这是因为线性系 统的稳定性与初始条件的大小无关。而对于非线性系统来说，其稳定性往往与初始条件的大小密 切相关，系统渐近稳定不一定是大范围渐近稳定。
(5)不稳定性
如果对于某个实数ε>0和任一个实数8>0,不管这两个实数有多么小，在S(8)   内总存在 着 一个状态xo,使得由这一状态出发的轨迹超出S(e),则平衡状态x. 称为是不稳定的，见 图9-30(c)。
下面介绍李雅普诺夫理论中判断系统稳定性的方法。 2.李雅普诺夫第一法(间接法)
李雅普诺夫第一法是利用状态方程解的特性来判断系统稳定性的方法，它适用于线性定常、 线性时变以及非线性函数可线性化的情况。由于本章主要研究线性定常系统，所以在此仅介绍线 性定常系统的特征值判据。
定理9-9 对于线性定常系统x=                     有
1)系统的每一平衡状态是在李雅普诺夫意义下稳定的充分必要条件是，A的所有特征值均 具有非正(负或零)实部，且具有零实部的特征值为A 的最小多项式的单根。
2)系统的唯一平衡状态x=0      是渐近稳定的充分必要条件是，A的所有特征值均具有负 实部。
证 明 1 ) 设x, 为 x=Ax    的平衡状态，则由性质x,=0    和Ax,=0     可知，对于所有t≥0     均 有

x,=eAx 。                                 (9-295)
于是，考虑到x(t;xo,0)=eAxo,        有
x(t;xo,0)-x,=eA(x 。-x 。),Vt≥0                                                            (9-296)
这表明，当且仅当||eA|≤k<0              时，对任给的一个实数e>0,     都对应存在和初始时刻无关的
一个实数 δ(e)=E/k,      使得由满足不等式
l|xo-x.|≤8(e)                                                                     (9-297)
的任一初态x。出发的受扰运动都满足不等式
(9-298)
从而由定义知，系统的每一个平衡状态均为李雅普诺夫意义下稳定。再引入非奇异变换阵P, 使 得A=P-¹AP      为矩阵A 的约当规范型，则又有
leA' ||≤||P-¹ | · ||eA     · ||Pli                   (9-299)
因而 | |eAⅡ 有界等价于||eA:|Ⅱ 有界。但是，由A 为约当规范型可知eA 每一元的形式为
ti:e+,a+juy=A(A)=λ;(A)                                                                 (9-300)





式中，2;( ·)为( ·)的特征值；β为特征值的重数。注意到式(9-300)中，当a<0   时对任何正整数 β₁,此元在[0,x] 上为有界，而a;=0 时只对β=0此元在(0,0)上为有界。同时，eA'的每一个 元有界意味着|eA'Ⅱ有界。由此可知，当且仅当A 的所有特征值均具有负或零实部，且具有零实 部的特征值为单根时， |eA'||为有界，也就是系统的每一个平衡状态为李雅普诺夫意义下的稳 定。结论1)证毕。
2)由式(9-296)可知，当且仅当||eA|Ⅱ对 一切t≥0 为有界，且当t→0 时 | |eAⅡ→0, 零 平衡状态x.=0  为渐近稳定。如上所证，当且仅当A 的所有特征值均具有负或零实部时，||eAⅡ
有界。又根据式(9-299)和式(9-300)可知，当且仅当t→ ○     时 te+i→0,          可保证t→0    时
l      eA'||→0,这等价于A 的特征值均具有负实部。结论2)证毕。
由于所讨论的系统为线性定常系统，当其为稳定时必是一致稳定，当其为渐近稳定时必是大 范围一致渐近稳定。
3.李雅普诺夫第二法(直接法)
根据古典力学中的振动现象，若系统能量(含动能与位能)随时间推移而衰减，系统迟早会 达到平衡状态，但要找到实际系统的能量函数表达式并非易事。李雅普诺夫提出，可虚构一个能 量函数，后来便被称为李雅普诺夫函数，一般它与x₁,2,…,x       及 t 有关，记以V(x,t) 。 若不显含 t, 则记以V(x) 。它是一个标量函数，考虑到能量总大于零，故为正定函数。能量衰减特性用 V(x,t)   或 V(x)    表示。李雅普诺夫第二法利用V 及 V 的符号特征，直接对平衡状态稳定性作出 判断，无需求出系统状态方程的解，故称直接法。用此方法解决了一些用其他稳定性判据难以解 决的非线性系统的稳定性问题，遗憾的是对一般非线性系统仍未找到构造李雅普诺夫函数的通 用方法。对于线性系统，通常用二次型函数xTPx 作为李雅普诺夫函数。
这里不打算对李雅普诺夫第二法中的诸稳定性定理在数学上作严格证明，而只着重于物理 概念的阐述和应用。
(1)标量函数定号性的简要回顾
正定性  标量函数V(x)  对所有在域S 中的非零状态x 有 V(x)>0      且 V(0)=0,      则在域 S( 域S 包含状态空间的原点)内的标量函数V(x) 称为是正定的。
如果时变函数V(x,t)   由一个定常的正定函数作为下限，也就是说，存在一个正定函数 W(x),  使得
V(x,t)>W(x),V(0,t)=0,t≥to                                                          (9-301)
则称时变函数V(x,t)   在域S( 域S 包含状态空间的原点)内是正定的。
负 定 性 如 果 -V(x)  是正定函数，则标量函数V(x)  称为负定函数。
正半定性 如果标量函数V(x)  除了原点及某些状态处等于零外，在域S 内的所有状态都 是正定的，则V(x) 称为正半定函数。
负半定性 如果 -V(x)  是正半定函数，则标量函数V(x)  称为负半定函数。
不定性  如果在域S  内，不论域S 多么小，V(x)  既可为正值也可为负值，则标量函数V(x) 称为不定函数。
(2)李雅普诺夫第二法主要定理
定理9-10(时变系统大范围一致渐近稳定判别定理) ·考察连续时间非线性时变自由系统  x=f(x,t),t≥to                                                                (9-302)





中 f(0,t)=0,   即状态空间的原点为系统的平衡状态。如果存在一个对x 和 t 具有连续一阶偏 数的标量函数V(x,t),V(0,t)=0,           且满足如下条件：
1)V(x,t)      正定且有界，即存在两个连续的非减标量函数α(||x|l)    和β(| x|||),      其中
(0)=0,β(O)=0,            使对一切t≥to    和一切x≠0     均有
βC||x||)≥V(x,t)≥α(|lx)>0                                                       (9-303)   2)V(x,t) 对时间t的导数V(x,t)负定且有界，即存在一个连续的非减标量函数r(||x||),
其 中r(0)=0,  使对一切t≥to和一切x≠0 均有
V(x,t)≤-r(lx|)<0                               (9-304)
3 ) 当 |x||→ ○ 时 ，ae||x||)→ ○,V(x,t)→0, 系统的原点平衡状态为大范围一致渐近稳定。
定理9-11(定常系统大范围渐近稳x定=x定) 于定常系统              (9-305)
甚 中f(0)=0,         如果存在一个具有连续一阶导数的标量函数V(x),V(0)=0,         并且对于状态空间
中的 一 切非零点x 满足如下条件： 1)V(x)    为正定；
2)V(x)     为负定；
3 ) 当 |x||→ ∞时V(x)→0。
则系统的原点平衡状态是大范围渐近稳定的。 例9-25 设系统状态方程为
i₁=Iz-x₁(z²+x²)
iz=-x₁      一x₂(x²+x²)
里
试确定系统的稳定性。
解  显然，原点(x₁=0,z₂=0)          是该系统唯一的平衡状态。选取正定标量函数V(x)  为
V(x)=x²+x²
则沿任意轨迹V(x) 对时间的导数
V(x)=2x₁i₁+2x₂iz=-2(x²+x²)²
是负定的。这说明V(x)  沿任意轨迹是连续减小的，因此V(x) 是一个李雅普诺夫函数。由于当 x|l→0   时 V(x)→0,  所以系统在原点处的平衡状态是大范围渐近稳定的。
一般地说，对于相当一部分系统，要构造一个李雅普诺夫函数V(x) 使其满足定理9-11中所 要求的V(x) 为负定这一条件，常常不易做到。同时，从直观上也容易理解，要求V(x) 为负定不 免过于保守。下面给出将这一条件放宽后的定常系统大范围渐近稳定判别定理。
定理9-12(定常系统大范围渐近稳定判别定理2)对于定常系统(9-305),如果存在一个具  有连续一阶导数的标量V(x),V(0)=0,     并且对状态空间X 中的一切非零点x 满足如下的条件：
1)V(x)    为正定；
2)V(x)     为负半定；
3)对任意x∈X,V(x(t;xo,0))≠0; 4 ) 当 |x|→0   时V(x)→0。






则系统的原点平衡状态是大范围渐近稳定的。 例9-26 已知定常系统状态方程为
i₁=x₂
tz=-x₁-(1+x₂)²x₂
试确定系统的稳定性。
解  易知原点(x₁=0,xz=0)    为系统唯一的平衡状态。现取V(x)=  x²+x²      ,且 有
1)V(x)=x²+x²           为正定。
2)V(x)=2x₁ i₁+2xziz=-2x²(1+x₂)²。       容易看出，除了①x₁ 任意，x₂=0;②x₁      任意，
x₂=-1   时 ，V(x)=0  以外，均有V(x)<0。  所以，V(x) 为负半定。
3)检查是否V(x(t;xo,0))≠0。考虑到使得V(x)=0   的可能性只有上述①和②两种情 况，所以问题归结为判断这两种情况是否为系统的受扰运动解。先考察情况①:设x(t;xo,0)=
[x₁(t)0]T,       则由x₂(t)=0      可导出i₂(t)=0,         将此代入系统状态方程可得
i₁(t)=x₂(t)=0
0=i₂(t)=-(1+x₂(t))²x₂(t)-x₁(t)=-x₁(t)
这表明，除了点(x₁=0,xz=0)          外 ，x(t;xo,0)=[x₁(t)0]                不是系统的受扰运动解。再考察情
况②:设x(t;xo,0)=[x₁(t)-1],                   则由x₂(t)=-1         可导出i₂(t)=0,       将此代入系统状态方
程可得
i₁(t)=x₂(t)=-1
0=i₂(t)=-(1+x₂(t))²x₂(t)-x₁(t)=-x₁(t)
显然这是一个矛盾的结果，表明x(t;xo,0)=[x₁ (t)   -1]   也不是系统的受扰运动解。综合以
上分析可知，V(x(t;xo,0))≠0。
4 ) 当 |x|→0   时，显然有V(x)=|x||²→0。
于是，根据定理9-12可判定系统的原点平衡状态是大范围渐近稳定的。
由于上述给出的所有判别定理都只提供了充分条件，如果经多次试取李雅普诺夫函数都得  不到确定的答案时，就要考虑其为不稳定的可能性。下面的定理给出了判别不稳定的充分条件。
定理9-13(不稳定的判别定理) 对于时变系统(9-302)或定常系统(9-305),如果存在一 个具有连续一阶导数的标量函数V(x,t)或 V(x), 其中V(0,t)=0,V(0)=0,    和围绕原点的域 2,使得对于一切x∈Ω   和一切t≥to    满足如下条件：
1)V(x,t) 为正定且有界或V(x) 为正定；
2)V(x,t)     为正定且有界或V(x)   为正定。 则系统平衡状态为不稳定。
4.线性定常系统的李雅普诺夫稳定性分析
下面介绍李雅普诺夫第二法在线性定常系统稳定性分析中的应用。
(1)线性定常连续系统渐近稳定性的判别
设线性定常系统状态方程为x=Ax,x(0)=xo,t≥0,A           为非奇异矩阵，故原点是唯一平衡状
态。设取正定二次型函数V(x)=xTPx     作为可能的李雅普诺夫函数，考虑到系统状态方程，则有 V(x)=xTPx+xTPx=xT(ATP+PA)x                                                 (9-306)


令 于 根 定白 足 夫知

会 是5 系乡 便

分业 成工

为； 定， 分业

存在 为

一舟 用来


试用






特征





则有




ATP+PA=-Q                                                           (9-307) 于是有                           V(x)=-xTQx                                                             (9-308) 根据定常系统大范围渐近稳定判别定理1,只要Q 正定(即V(x)   负定),则系统是大范围渐近稳 定的。于是线性定常连续系统渐近稳定的充分必要条件可表示为：给定一正定矩阵P, 存在着满 足式(9-307)的正定矩阵Q, 而xTPx是该系统的一个李雅普诺夫函数，式(9-307)称为李雅普诺 美矩阵代数方程。
但是，按上述先给定P、再验证Q 是否正定的步骤去分析系统稳定性时，若P 选取不当，往往 会导致Q 非正定，需反复多次选取P 阵来检验Q 是否正定，使用中很不方便。因而在应用时，往往 是先选取Q 为正定实对称矩阵，再求解式(9-307),若所求得的P 阵为正定实对称矩阵，则可判定 系统是渐近稳定的。由于使用中常选取Q 阵为单位阵或对角线阵，比起先选P 阵再检验Q 阵要方 便得多，所以在判定系统的稳定性时常利用下述定理：
定理9-14  线性定常系统x=A x,x(0)=xo,t≥0 的原点平衡状态x=0  为渐近稳定的充 分必要条件是，对于任意给定的一个正定对称矩阵Q, 有唯一的正定对称矩阵P 使式(9-307)
成立 。
需要说明的是，在利用上述定理判断线性定常系统的渐近稳定性时，对Q 的唯一限制是其应 为对称正定阵。显然，满足这种限制的Q 阵可能有无穷多个，但判断的结果即系统是否为渐近稳 定，则和Q 阵的不同选择无关。上述定理的实质是给出了矩阵A 的所有特征值均具有负实部的充 分必要条件。
根据定常系统大范围渐近稳定判别定理2可以推知，若系统任意的状态轨迹在非零状态不 存在V(x) 恒为零时，Q 阵可选择为正半定的，即允许Q 取半正定对角阵时主对角线上部分元素 为零，而解得的P 阵仍应正定。
由于利用上述定理判断线性定常系统是否渐近稳定时需要求解李雅普诺夫方程(9-307),但 一般地说求解李雅普诺夫方程并非易事，因而这种方法往往不用来判定系统的渐近稳定性，而是 用来构造线性定常连续渐近稳定系统。
例9-27 已知线性定常连续系统状态方程为
i₁=x₂,iz=2x₁-x₂
试用李雅普诺夫方程判定系统的渐近稳定性。
解 为便于对比，先用特征值判据判断。系统状态方程为


特征值为-2,1,故系统不稳定。令
ATP+PA=-Q=-I


则有




展开有         4P¹2=-1,2P¹₂-2P²z=-1,P₁-P¹₂+2P₂₂=0
解得                      
由 于 事,故P 不定，可知系统非渐近稳定。由特征值判据知系统是
不稳定的。
(2)线性定常离散系统渐近稳定性的判别 设线性定常离散系统状态方程为
x(k+1)=Φx(k),x(0)=xo;k=0,1,2, …                                                           (9-309)
式中，Φ阵非奇异；原点是平衡状态。取正定二次型函数
V(x(k))=xT(k)Px(k)                                                            (9-310)
以 AV(x(k)) 代 替V(x) 有
△V(x(k))=V(x(k+1))-V(x(k))                                                         (9-311)
考虑到状态方程(9-309)有
△V(x(k))=xT(k+1)Px(k+1)-xT(k)Px(k)
=[Φx(k)]TP[Φx(k)]-xT(k)Px(k)
=x⁷(k)(ΦTPO-P)x(k)                                                               (9-312)
令                                 ΦTPφ-P=-Q                                                                     (9-313)
于是有                       △V(x(k))=-xT(k)Qx(k)                                                        (9-314)
定理9-15 系统(9-309)渐近稳定的充分必要条件是，给定任一正定对称矩阵Q,存在一个 正定对称矩阵P 使式(9-313)成立。
xT(k)Px(k)   是系统的一个李雅普诺夫函数，式(9-313)称为离散的李雅普诺夫代数方程，通 常可取Q=I。
如果△V(x(k))    沿任一解的序列不恒为零，则Q 可取为正半定矩阵。 9-5  控制系统状态空间设计
例9-28 内模控制器
在许多实际场合，单纯的状态变量反馈方法并不是一种改善系统性能的实用方法。其主要原 因为：状态变量反馈往往要求用具有无限带宽的PD 控制器或PID 控制器来实现，但实际部件和 控制器都只有有限的带宽。
内模控制器是另一类校正控制器，能以零稳态误差渐近跟踪各类参考输入信号，如阶跃信 号、斜坡信号及正弦信号等。众所周知，在经典控制理论中，对于阶跃输入信号，I 型系统可以实 现零稳态误差跟踪。如果在校正控制器中引入参考输入的内模，则可以在状态空间设计法中推广 这一结论。采用类似的内模控制器方法，可以在更多的情况下实现零稳态误差跟踪。
设单输入-单输出系统的状态空间表达式为





x(t)=Ax(t)+bu(t) y(t)=cx(t)	(9-315)
式 中 ，x∈R” 为状态向量；u 为标量输入；y 为标量输出；A,b 和 c 维数适当。 生成参考输入信号r(t)  的线性系统为
x,(t)=A,x,(t)	


(9-316)
r(t)=d,x,(t)
其中，初始条件未知。此外，参考输入信号r(t)  的生成系统也可以等效为	
r(m)(t)=α-1r(n-1)(t)+α-2r(n-2)(t)+…+a₁r(t)+aor(t)	(9-317)
首先考虑参考输入r(t)为单位阶跃信号时的内模控制器设计。此时，r(t)可由下列方程 生成：
i,(t)=0,r(t)=x,(t)                                                                     (9-318)
或等价为
r(t)=0                                                                        (9-319)
定义跟踪误差
e(t)=r(t)-y(t)
于是有                        e(t)=-y(t)=-cx(t)                                                                    (9-320)
现在，引入两个中间变量z(t) 和 w(t),   定义为
z(t)=x(t),w(t)=ù(t)
故有                        ż(t)=x(t)=Ax(t)+bu(t)
=Az(t)+bw(t)                                                                    (9-321)
则式(9-320)与式(9-321)构成如下增广系统方程：
                      (9-322) 当增广系统(9-322)可控时，即有
             (9-323) 总可以找到反馈信号
w(t)=-k₁e(t)-k₂z(t)                                                                 (9-324) 使该系统渐近稳定。这表明跟踪误差e(t)  是渐近稳定的，因此系统输出能以零稳态误差跟踪参考 输入信号。对式(9-324)求积分，可得系统内部的反馈控制信号为
(9-325)
与此对应的框图模型如图9-31所示。由图可见，在校正控制器中，除包含有状态变量反馈外，还 包含了参考阶跃输入的内模(图中积分器环节),故称为内模控制器。
下例为一个具体系统的单位阶跃输入内模控制器的设计过程。设有

y(t)=[10]x(t)







图9-31 阶跃输入的内模设计
要求系统输出能以零稳态误差跟踪单位阶跃参考输入信号。由式(9-322)知，增广系统方程为

由于可控性矩阵

满秩，增广系统可控，故通过状态反馈

式中k=[k₁k₂k₃],              可任意配置闭环增广系统

的极点。如果要求闭环极点为s1,2=-1±j,s₃=-10,          则希望特征方程为 (s+1+j)(s+1-j)(s+10)=s³+12s²+22s+20=0
而实际特征方程为

4

=s³+(k₂2+2k₃+2)s²+(2-k₁+4k₂-2k₃)s-4k₁=0
令上述两个特征方程式的对应项系数相等，解得
k₁=-5,k₂=5,k₃=2.5
则由式(9-325)得内模控制律为

相应的单位阶跃输入内模控制系统的结构图如图9-32所示。






图9-32 单位阶跃输入内模控制系统
显然，本例设计的内模控制系统是渐近稳定的。对任意初始跟踪误差e(0),反馈控制信号都 可以保证在t→ ○  时 ，e(t)→0 。在MATLAB  的Simulink  环境下，根据结构图9-32搭建内模控制系 统模型，运行后可得图9-33,其直观地表明了系统在单位阶跃参考输人时，跟踪误差的渐近收 敛性。

Time/sec
图9-33 单位阶跃输人下内模控制系统的跟踪误差响应(MATLAB)
考虑参考输入为斜坡信号的内模设计问题。设单位斜坡参考输人信号为r(t)=t, 并由下列 系统生成：

r=d,x,=[10]x,
且有r(t)=0,       则对于单输入-单输出系统(9-315),定义跟踪误差e=r-y,       有
e(t)=-y(t)=-cx(t)
令中间变量
z=x,w=ü

有                                 z=x=Ax+bu








构造增广系统




若系统(9-326)可控，即




则存在状态反馈




使增广闭环系统


i=Ax+bü=Az+bw e=-j=-cx=-cz
















(9-326)









(9-327)








(9-328)

渐近稳定。其中，k₁,k₂  和k₃ 可由要求的闭环增广系统(9-328)的极点位置来确定。这样，当t→ ○ 时，必有e(i)→0。
对式(9-327)作二次积分，可得含有输入内模信息的反馈控制信号

斜坡输入的内模设计系统框图如图9-34所示。

图9-34 斜坡输入的内模设计
由图9-34可见，虚框表示的控制器中含有两个积分器，这正是斜坡输入的内模形式。类似 地，可以将内模方法推广到处理其他参考输入形式。此外，如果将扰动信号的生成模型也纳入校 正控制器中，还可以通过扰动内模设计来克服持续扰动对系统性能的影响，请参见本章习题。





例9-29 打印机皮带驱动器
在计算机外围设备中，常用的低价位打印机都配有皮带驱动器，用于驱动打印头沿打印页面 横向移动。打印头可能是喷墨式或针式的。图9-35是一个装有直流电机的皮带驱动式打印机，其 光传感器用来测定打印头的位置，皮带张力变化用于调节皮带的实际弹性状态。
设计要求：
1)建立系统的状态空间模型，选择合适的电机参数、滑轮参数和控制器参数；
2)研究皮带弹性系数k 对打印机抗外界扰动性能的影响。
解 1)状态空间建模及系统参数选择。图9-36为打印机皮带驱动器的基本模型。模型中记 皮带弹性系数为k, 滑轮半径为r, 电机轴转角为θ,右滑轮的转角为θ。,打印头质量为m, 打印头 位移为y(t) 。 光传感器用来测量y(t),   光传感器的输出电压为v₁, 且v₁=k₁y 。 控制器输出电压为 v₂, 对系统进行速度反馈，即有

图9-35 打印机皮带驱动系统

图9-36 打印机皮带驱动模型 系统参数取值情况如表9-1所示。
下面推导系统的运动方程。注意到y=rθ,,可知皮带张力T₁   和T₂  分别为 T₁=k(rθ-rθ,)=k(rθ-y),T₂=k(y-rθ)
式中，k 为皮带弹性系数。于是，作用在质量m 上的皮带净张力为
T₁-T₂=2k(rθ-y)=2kx₁




表9-1 打印装置的参数

质   量	m=0.2kg
光传感器	ki=1V/m
滑轮半径	r=0.015m
电   机

电感	L≈0
电机和滑轮的摩擦系数	f=0.25N ·m ·s
电枢电阻	R=20
电机传递系数	Km=2kg ·m/A
电机和滑轮的转动惯量	J电机十J潜轮=J=0.01kg ·m²

其中，x₁=rθ-y       为第一个状态变量，表示打印头实际位移y 与预期位移rθ 之间的位移差。显


然，质量m 的运动方程为

取第二个状态变量为 ,于是有

定义第三个状态变量为 ,则x₁ 的导数








(9-329)


(9-330)

接着，推导电机旋转的运动方程：当L=0   时，电机电枢电流 ,而电机转矩为Mm=Kmi, 于是有
                              (9-331)
设作用在驱动皮带上的扰动转矩为Ma, 则电机驱动皮带的有效转矩为M=Mm-Ma 。 显然，只有
有效转矩驱动电机轴带动滑轮运动，因此有



由于

故得
在上式中，代入式(9-331)以及


T₁-T₂=2kx1




v₁=k₁y,







得到
最后可得










(9-332)

式(9-330),(9-329)及(9-332)构成了描述打印机皮带驱动系统的一阶运动微分方程组，其


向量-矩阵形式为









(9-333)

式(9-333)的信号流图如图9-37所示，图中还表示了扰动力矩Ma 的节点。

图9-37 打印机皮带驱动系统的信号流图模型
2)皮带弹性系数的影响。为了研究如何抑制扰动Ma 对系统性能的影响，可由图9-37确定传 递函数X₁(s)/Ma(s) 。  利用梅森增益公式，可得

其中回路增益




因而有

代入表9-1所示参数值，得

·527 ·







为了抑制扰动Ma 对打印头位移差x₁=rθ-y     的影响，需要选择合适的皮带弹性系数k 和 速
度反馈系数k₂ 。令

显然，k与 k₂ 的选择应首先保证闭环系统的稳定性。系统的闭环特征方程为 s³+25s²+10.05ks+k(250+15k₂)=0
列劳斯表如下：

由劳斯判据知，使闭环系统稳定的充分必要条件为  25×10.05k-k(250+15k₂)>0
以及
k(250+15k₂)>0
整理得
k>0,0<k₂<0.0833
在系统稳定的前提下，由终值定理可知，打印头稳态位移差

打印头在运动过程中受单位阶跃扰动力矩作用下的动态特性，取决于皮带弹性系数k 和速度反 馈系数k₂ 的选取。通常，k在1~40范围内取值，k₂<1。一组合适的取值为k=20  和k₂=0.08,
此时

对上式进行部分分式分解，有

其中，A₁=-0.0018;A₂=0.0018;A₃=-0.045 。      由于留数A₁ 和A₂  比 之A₃ 小得多，其影响可
略，故

查本书附录A, 可得
x₁(t)≈-3.17×10-³sin(14.18t)
其动态响应如图9-38所示。由图可见，该系统可将外来阶跃扰动的影响抑制到相当微弱的程度， 实现了预期的设计目标。
MATLAB 文本： k=20;k2=0.08;






num=[-1.50];
den=[12510.05*kk*(250+15*k2)]; sys=tf(num,den);
t=0:0.01:3;
step(sys,t);grid

Time/sec
图9-38 打印头位移差x₁(t) 对阶跃扰动的响应(k=20,MATLAB) 例9-30 自动检测系统
电气开关面板上有各种开关、继电器和指示灯，若采用手工方式检测，会降低产量并造成较 大的检验误差。图9-39是一个自动检测系统示意图，该系统通过直流电机来驱动一组探针，使探 针穿过零件的引线，以便检测零件的导通性能、电阻及其他功能参数。

图9-39 自动检测系统
该自动检测系统利用直流电机上的编码器来测量电压和探针的位置，如图9-40所示。其结 构图模型如图9-41所示，其中K。为所需要的功率放大系数。
设状态变量选择为：x₁=θ,xz=dθ/dt,xs=ig;          假定这些状态变量均可测，且能用于反馈。图 9-42所示为其闭环系统，其中控制律
u=-K₁x₁-K₂x₂-K₃x₃
本例的设计目标是：合理选择放大器增益K。和状态反馈增益K₁,K₂    和 K₃, 使系统单位阶







图9-40 装有编码轮盘的直流电机

图9-41 结构图模型


图9-42 自动检测反馈控制系统
跃响应的调节时间小于2s(△=2%),   超调量小于4%。
解首先列写系统的状态方程。由图9-42可见，当系统状态反馈未接入时，有 x(t)=Ax(t)+bu(t)

当系统接入状态反馈控制律，并令K₁=1  时，得闭环系统方程为

令det(sI-A)=0,  得闭环系统特征方程
s³+(6+K.K₃)s²+[5+K(K₂+K₃)]s+K 。=0
上式可写为

其等效闭环特征方程为







以 K.K₃  为可变参数，绘制等效系统的根轨迹图，并适当选择待定参数，使系统性能满足设计 指标。
根据给定的性能指标要求，应有
0%=100e-M-B%<4%
    (△=2%)
故可求得
5>0.72,wn>3.1
则系统希望主导极点在复平面上的有效取值区域，如图9-43(a) 中阴影线区域所示。
为了把根轨迹拉向图9-43(a) 所示阴影线区域，将等效系统的开环零点取为s=-4±j2       (位于
阴影线区域内),且令

Real Axis
(a)自动检测系统的根轨迹
clc;clear;
num-[1820];den=[1650]; rlocus(num,den);hold on
%
zeta=0.72,wn=3.1;
x=-10:0.1:-zeta*wm;y-(sqt(1-zeta^2)zeta)*x; xc=-10:0.1:-zeta*wn;c-sqrt(wn^2-xc.^2);
plot (x,y,':'x,-y,':',xe,c,':',xc,-c,':) axis([-101-1010]);
(b)MATLAB文本
图9-43 自动检测系统设计(MATLAB)



7



=s²+8s+20

即有

解出                           K₂=0.35,K₃=0.05
运行图9-43(b) 所 示MATLAB  文本，可以画出以K.K₃  为可变参数的根轨迹图，如图9-43 (a) 所示。由图可见，当取根轨迹增益K.K₃=12    时，闭环极点位于有效取值区域之内。从而满足 设计指标要求。本例最终设计结果为：K 。=240.00,K₁=1.00,K₂=0.35,K₃=0.05。
最后，校验设计参数，系统的单位阶跃响应曲线如图9-44所示。由图得，设计后系统的o%= 2%,t  ₂=0.88s(△=2%),      系统确实满足了设计要求。
MATLAB 文本：
Ka=240;K1=1;K2=0.35;K3=0.05;
A=[010;0-11;-Ka-Ka*K2-5-Ka* K3];
b=[00        Ka];
c=[100]; d=0;
sys=ss(A,b,c,d); t=0:0.01:3;
step(sys,t);grid
例9-31 磁盘驱动读取系统(续)
现代磁盘在每厘米宽度内有5000个磁 道，每个磁道的典型宽度仅为1μm, 因此磁盘
驱动读取系统对磁头的定位精度和磁头在磁道间移动的动态过程有严格的要求。

于
图9-45 磁头控制系统的开环模型
当不考虑磁场电感影响时，磁头控制系统的二阶开环模型如图9-45所示，采用状态反馈控 制器后的闭环系统如图9-46所示。设计要求：
1)选择放大器增益K。和反馈系数K₂,  使系统二阶模型响应满足表9-2所示性能指标 要求；
2)若考虑磁场电感的影响，且设电感L 为 1mH, 则磁盘驱动读取系统中的电机传递函数为

其 方







图9-46 具有两条状态变量反馈回路的闭环系统 表9-2 磁盘驱动控制系统的设计要求和实际性能
性能指标	期望值	二阶模型响应	三阶模型响应
超调量	<5%	<2%	0%
调节时间/ms	<50	40.2	40.3
单位阶跃扰动的响应峰值	5.2×10-3	5.2×10-5	5.2×10-5
解首先建立系统的状态空间模型。选择状态变量为：x₁(t)=y(t),x₂(t)=dy(t)/dt= dx₁(t)/dt,    由图9-45知，开环系统的二阶模型的状态方程为

假定磁头的位置及速度均可以测量，根据图9-46所示的状态反馈闭环系统，可得闭环系统的状
态方程为

在上式中代入K₁=1,    可 由det(sI-A)=0       (其中A 为闭环系统阵),得

于是，闭环系统的特征方程为
s²+(20+5K₂Ka)s+5K 。=0
为了满足设计指标要求，根据
	
c%=100e-~1-F%<5%   (△=2%)
应有5>0.69以及ζw>88。 考虑到磁盘读取系统对动态过程的严格要求，现取
5=0.9,ζw=125
其对应的动态性能指标为o%=1.53%   和 t,=35.2ms, 比较满意。在此情况下，预期的闭环特征
方程为
·533 ·






s²+25wns+w²=s²+250s+19290=0
令实际系统的闭环特征方程与预期闭环特征方程的对应项系数相等，得 5K 。=19290
20+5K₂K 。=250
求得放大器增益Ka=3858,  反馈增益K₂=0.012 。 采用仿真方法计算闭环系统的实际响应，所得 动态性能指标如表9-2中第3列所示。结果表明，所选择的系统参数满足对系统的设计指标 要求。
如果考虑磁场电感影响，图9-45中的G₁ (s)=5 应变为

从而得到系统更精确的三阶开环模型。仍然沿用二阶系统模型时选取的系统参数，即K=3858,
K₁=1,K₂=0.012,      对闭环系统的实际响应进行仿真计算，其结果如表9-2中第4列所示。表明： 三阶闭环系统同样满足设计要求，其动态性能与二阶闭环系统性能相近，这说明二阶开环模型足  以精确地描述磁盘驱动读取系统。
三阶模型单位阶跃响应的MATLAB   仿真结果如图9-47所示。

Time/sec
图9-47 磁盘驱动系统三阶模型的时间响应(MATLAB)

习     题

9-1 已知电枢控制的直流伺服电机的微分方程组及传递函数为


Mm=Cmia








(1)设状态变量x₁=θm,x₂=0m,x₃=Ö,              输出量y=θm,     试建立其动态方程；
(2)设状态变量x₁=ia,     元z=θm,=0m,y=θm,               试建立其动态方程；
(3)设x=Tx,      确定两组状态变量间的变换矩阵T。 9-2 设系统微分方程为
ü+3i+2x=u
式 中u 为输入量，x 为输出量。
(1)设状态变量x₁=x,xz=         元，试列写动态方程；
(2)设状态变换x₁=x₁+    2,x₂=-x-                2 元2,试确定变换矩阵T 及变换后的动态方程。 9-3  设系统微分方程为
j+6j+11y+6y=6u
式中u,y  分别为系统的输入、输出量。试列写可控标准型(即A 为友矩阵)及可观测标准型(即A 为友矩阵转置)状态空间表达式，并画出状态变量图。
9-4 已知系统结构图如图9-48所示，其状态变量为x₁,x₂,x₃ 。 试求动态方程，并画出状态
变量图。

图9-48 习题9-4系统结构图 9-5 已知双输入-双输出系统状态方程和输出方程
i₁=x₂+u1
i₂=x₃+2u₁-u₂
s=-6x₁-1lz₂-6x₃+2u₂
yi=I1     一T2
y₂=2x₁+z₂-A₃ 写出其向量-矩阵形式并画出状态变量图。
9-6 已知系统传递函数为

试求可控标准型(A 为友矩阵)、可观测标准型(A 为友矩阵转置)、对角线型(A 为对角阵)动态 方程。
9-7  已知系统传递函数







试求约当型(A 为约当阵)动态方程。 9-8  已知矩阵

试求A 的特征方程、特征值、特征向量，并求出变换矩阵将A 对角化。 9-9 已知矩阵

试用幂级数法及拉普拉斯变换法求出矩阵指数(即状态转移矩阵)。 9-10    试求下列状态方程的解：

9-11  已知系统状态方程为

初始条件为x₁(0)=1,x₂(0)=0 。       试求系统在单位阶跃输入作用下的响应。 9-12 已知线性系统状态转移矩阵

试求该系统的状态阵A。
9-13 已知系统动态方程

y=[001]x
试求传递函数G(s)。
9-14 试求习题9-5所示系统的传递函数矩阵。 9-15    已知差分方程
y(k                                    +2)+3y(k+1)+2y(k)=2u(k+1)+3u(k)
试列写可控标准型(A  为友矩阵)离散动态方程，并求出u(k)=1      时的系统响应。给定y(0)=0,
y(1)=1。
9-16 已知连续系统动态方程为
,y=[10]x
设采样周期T=1s,     试求离散化动态方程。 9-17 试判断下列系统的状态可控性：








9-18 已知ad=bc,     试计算 9-19 设系统状态方程为

设状态可控，试求a,b。
9-20   设系统传递函数为

设状态可控，试求a。
9-21   判断下列系统的输出可控性：



000]x。


9-22 试判断下列系统的可观测性：






(4) 
9-23 试确定使下列系统可观测的a,b:
,y=[1                   -1]x
9-24 已知系统各矩阵为

试用传递矩阵判断系统可控性、可观测性。
9-25    将下列状态方程化为可控标准型：

9-26    已 知系统传递函数为

试写出系统可控不可观测、可观测不可控、不可控不可观测的动态方程。 9-27    已知系统各矩阵为

试求可控子系统与不可控子系统的动态方程。
9-28  系统各矩阵同习题9-27,试求可观测子系统与不可观测子系统的动态方程。 9-29 设被控系统状态方程为

可否用状态反馈任意配置闭环极点?求状态反馈阵，使闭环极点位于-10,-1±j√3,     并画
出状态变量图。
9-30 设被控系统动态方程为
y=[10]x
试设计全维状态观测器，使闭环极点位于-r,-2r(r>0),              并画出状态变量图。
9-31 设系统传递函数为

试问能否利用状态反馈将传递函数变成






若有可能，求出一个满足要求的状态反馈阵K, 并画出状态变量图。(提示：状态反馈不改变原传 递函数零点。)
9-32 试用李雅普诺夫第二法判断下列线性系统平衡状态的稳定性：
i₁=-x₁+x₂,                   2=2x₁-3x₂
9-33    已知系统状态方程为

当 Q=I     时 ，P=?      若 选Q 为正半定矩阵，Q=?    对 应P=?     判断系统稳定性。
9-34 设线性定常离散系统状态方程为

试求使系统渐近稳定的k 值范围。
9-35 设工业机器人如图9-49所示，其中两相伺服电机转动肘关节之后，通过小臂移动机 器人的手腕。假定弹簧的弹性系数为k, 阻尼系数为f,   并选取系统的如下状态变量：
x₁=P₁    一中2,

试列写该机器人的状态方程。

图9-49 工业机器人
9-36 为了完成空间站装配、卫星捕获等空间操作，航天飞机的货舱内装备了一种可膨胀机
械臂的遥操作系统，如图9-50(a)所示。柔性机械臂的模型如图9-50(b)所示，其中J 是驱动电机 的转动惯量，u 为电机驱动转矩，θ₁和θ₂为柔性臂转角，k 为柔性臂的弹性系数，M 和I  分别为负
载质量与转动惯量，l 为机械臂在负载上的作用点到负载重心的距离。若选取状态变量为x₁=θ₁, x₂=θ₁,x₃=θ₂,x=02,  试列写柔性机械臂系统的线性化状态方程。
9-37 设磁悬浮试验系统如图9-51所示。在该系统上方装有一个电磁铁，产生电磁吸力F,    以便将铁球悬浮于空中。系统的下方装有一个间隙测量传感器，以测量铁球的悬浮间隙。由于没 有引入反馈，该磁悬浮试验系统不能稳定工作。
假定电磁铁电感为L=0.508H,     电阻为R=23.2Ω,     电流为i₁=I₀+i,       其 中I₀=1.06A     是 系




统的标称工作电流。再假定铁球的质量为m=1.75kg,     铁球悬浮间隙μ=X₀+x,    其 中X 。= 4.36mm  为标称磁悬浮间隙。若电磁吸力满足如下条件：
F=k(i/μg)²
式中k=2.9×10⁻⁴kg·m²/A² 。    选 择Z₁=x,  ,x₃=i   i为状态变量，试利用F  的泰勒展开式，
列写磁悬浮试验系统的线性化状态空间表达式。



(a)

图9-50 遥操作系统




图9-51 磁悬浮系统




尼器系统

K₂ 和 K₃ 的合适取值，使闭环系统的三个特征根位于s=-3 之间。另外，还要求确定前置增益K, 值，使系统对阶跃输入的稳态误差为零。




9-40  在图9-54(a) 所示的新型游船上，采用了浮桥和稳定器来减少波浪对游船摇摆的影 响，游船摇摆控制系统如图9-54(b) 所示。图中，X₁,X₂  和 X₃ 为状态变量，K₂ 和 K₃  为状态反馈
增益。试确定K₂ 和K₃  的合适取值，使闭环特征根为s₁.2=-2±j2,s₃=-15,              并画出系统在单位
阶跃扰动作用下的响应曲线。
9-41 设内模控制系统如图9-55所示。试设计合适的内模控制器 G₄ (s) 和状态反馈增益向





量kz, 使系统闭环极点s₁=sz=s₃=-2,          且对阶跃输入的稳态跟踪误差为零，最后绘出系统的单
位阶跃响应曲线。

图9-53 汽车悬架系统


(a)
N(S)
R(s)=0-    ±        68
摇摆角

K₃



(b)
图9-54 游船摇摆控制系统


图9- 55 内模控制系统
9-42 设单位斜坡内模控制系统如图9-56所示，其中被控对象







x₁(t) 和x₂(t)   为状态变量。试设计合适的内模控制器


图9-56 单位斜坡内模控制系统
及状态反馈增益k₃ 和k,  使系统的闭环极点为s₁=s₂=s₃=s₄=-2,           且系统对单位斜坡输入的稳态
跟踪误差为零，最后绘出系统的单位斜坡响应曲线。 9-43 已知被控对象的动态方程
x(t)=Ax(t)+bu(t) y(t)=cx(t)
其中
   ,c=[10]
要求设计单位斜坡输入时的内模控制器，使系统闭环极点为s1,2=-1±jl,s₃=s₄=-10,                并给出
单位斜坡内模控制系统结构图及跟踪误差e(t)  的响应曲线。 9-44 设单输入-单输出系统的状态空间表达式为
x(t)=Ax(t)+bu(t) y(t)=cx(t)
式中，x∈R” 为状态向量；u 为标量输入；y 为标量输出；A,b,c   维数适当。设参考输入r(t)=sin(t), 定义跟踪误差e(t)=r(t)-y(t) 。     试论证系统能以零稳态误差跟踪正弦参考输入信号。
9-45 设带有扰动n(t)  的单输入-单输出系统的状态空间表达式为
x(t)=Ax(t)+bu(t) y(t)=cx(t)+n(t)
式 中 ，x∈R" 为状态向量；u 为标量输入；y 为标量输出；A,b,c 维数适当。设参考输入r(t)=t,扰 动信号n(t)=1(t),      为阶跃扰动。试论证可设计扰动内模控制器，使系统输出能以零稳态误差渐 近跟踪斜坡输入t,  且不受阶跃扰动n(t)  的影响。
9-46 设有系统

y(t)=[10]x(t)+n(t)
式 中 ，n(t)=3t²     为输出端扰动信号。要求系统输出能以零稳态误差跟踪斜坡参考输入信号，并克 服输出端加速度扰动对跟踪性能的影响。








第十章动态系统的最优控制方法

20世纪60年代初，由于空间技术的迅猛发展和计算机的广泛应用，动态系统的优化理论得 到迅速发展，形成了最优控制这一重要的学科分支，并在控制工程、经济管理与决策以及人口控 制等领域得到了成功的应用，取得了显著的成效。最优控制在被控对象参数已知的情况下，已经 成为设计复杂系统的有效方法之一。本章将介绍动态系统最优控制的基本原理和常用方法，以及 若干工程应用。
10-1 最优控制的一般概念

1.最优控制的基本概念
最优控制是现代控制理论的核心。最优控制研究的主要问题是：根据已建立的被控对象的数 学模型，选择一个容许的控制律，使得被控对象按预定要求运行，并使给定的某一性能指标达到 极小值(或极大值)。从数学观点来看，最优控制研究的问题是求解一类带有约束条件的泛函极值 问题，属于变分学的范畴。然而，经典变分理论只能解决控制无约束，即容许控制属于开集的一类 最优控制问题，而工程实践中所遇到的多为控制有约束，即容许控制属于闭集的一类最优控制问 题。为了满足工程实践的需要，20世纪50年代中期，出现了现代变分理论，其中最常用的方法是 动态规划和极小值原理。
动态规划是美国学者R.E.  贝尔曼于1957年创立的。贝尔曼依据最优性原理，发展了变分 学中的哈密顿-雅可比方程，解决了控制有闭集约束的变分问题。极小值原理是前苏联科学院院 士 πC.庞特里亚金于1958年创立的。庞特里亚金在力学哈密顿原理的启发下，推测并证明了极 小值原理，同样解决了控制有闭集约束的变分问题。动态规划和极小值原理的提出，极大地丰富 了最优控制理论的内涵。
2.最优控制问题
最优控制是一门工程背景很强的学科分支，其研究的问题都是从具体工程实践中归纳和提


炼出来的。例如，1969年美国阿波罗11号实现了人类历史上 的首次载人登月飞行，任务要求登月舱在月球表面实现软着 陆，即登月舱到达月球表面时的速度为零，并在登月过程中， 选择登月舱发动机推力的最优控制律，使燃料消耗最少，以便 宇航员完成月球考察任务后，登月舱有足够的燃料离开月球 与母船全合，从而安全返回地球。由于登月舱发动机的最大推 力是有限的，因而这是一个控制有闭集约束的最小燃耗控制 问题。设登月舱软着陆示意图如图10-1所示。图中，m(t) 为登 月舱质量；h(t)  为高度；v(t)  为登月舱垂直速度；g 为月球重力 加速度；u(t)  为登月舱发动机推力。设登月舱不含燃料时的质 量为M, 登月舱所载燃料质量为F, 登月舱发动机工作的末端


h(I) u()
m(1)


-v(I)      mg


月球
图10-1 登月舱软着陆示意图





时刻为ty, 发动机最大推力为umax。已知登月舱登月时的初始高度为ho, 初始垂直速度为vo, 登 月 舱初始质量为mo, 则控制有约束的最小燃耗控制问题可归纳如下：
运动方程

m(t)=-ku(t),                   k=const
边界条件
初始条件：h(0)=ho,v(0)=vo,m(0)=mo=M+F
末端条件：h(t;)=0,v(tp)=0 控制约束
0≤u(t)≤umax
性能指标
J=m(ty)
最优控制任务是在满足控制约束条件下，寻求发动机推力的最优变化律u"(t),    使登月舱由 已知初态转移到要求的末态，并使性能指标J=m(t)=max,          从而使登月过程中燃料消耗量 最小。
登月舱的燃耗最优控制表明，任何一个最优控制问题均应包含以下四个方面内容：
(1)系统数学模型
在集总参数情况下，被控系统的数学模型通常以定义在[to,tŋ] 上的状态方程来表示：
x(t)=f[x(t),u(t),t],                       x(to)=x₀                                            (10-1)
式中，x(t)∈R”,为状态向量；u(t)∈R",为控制向量，且在[to,tf]上分段连续；f( ·)∈R", 为连续 向量函数，且对x(t)  和t 连续可微。
(2)边界条件与目标集
动态系统的运动过程，是系统从状态空间的一个状态到另一个状态的转移，其运动轨迹在状 态空间中形成轨线x(t) 。 为了确定要求的轨线x(t),   需要确定轨线的两点边界值。因此，要求确 定初态x(to) 和末态x(tp),   这是求解状态方程(10-1)必需的边界条件。
在最优控制问题中，初始时刻to和初始状态x(to)通常是已知的，但是末端时刻tr和末端状 态x(tf)  则视具体控制问题而异。一般来说，末端时刻ty 可以固定，也可以自由；末端状态x(ty) 可 以固定，也可以自由，或者部分固定、部分自由。对于tr和 x(ts)的这种要求，通常用如下目标集 加以概括：
ψLx(tr),ty]=0                                                                  (10-2)
式中，ψ( ·)∈R',为连续可微向量函数，r≤n。
(3)容许控制
在属于闭集的控制中，控制向量u(t)  的取值范围称为控制域，以Ω标志。由于u(t)  可在Ω的 边界上取值，故凡属集合Ω且分段连续的控制向量，称为容许控制，以u(t)∈Ω   标志。
(4)性能指标
在状态空间中，可以采用不同的控制向量函数去实现使系统由已知初态到要求的末态(或目 标集)的转移。性能指标则是衡量系统在不同控制向量作用下工作优良度的标准。
性能指标的内容与形式，取决于最优控制问题所要完成的任务。不同的最优控制问题，有不






同的性能指标，其一般形式可以归纳为




(10-3)

式中，φ ·)和L(·)    为连续可微的标量函数。[x(tj),t;]         称为末值项，
过程项，两者均有具体的物理含意。
根据最优控制问题的基本组成部分，可以概括最优控制问题的一般提法：在满足系统方程 (10-1)的约束条件下，在容许控制域Ω中确定一个最优控制律u·(t),    使系统状态x(t)  从已知初 态xo 转移到要求的目标集(10-2),并使性能指标(10-3)达到极值。
通常，最优控制问题可用下列泛函形式表示：

s.t.①x(t)=f[x(t),u(t),t],x(to)=x。
②ψ[x(ty),t]=0 3.最优控制的应用类型
最优控制在航空、航天及工业过程控制等许多领域得到了广泛应用，因而难以详尽归纳最优 控制在工程实践中的应用类型。考虑到最优控制的应用类型与性能指标的形式密切相关，因而可 按性能指标的数学形式进行大致的区分。性能指标按其数学形式有如下三类：
(1)积分型性能指标 数学描述为
                         (10-4) 积分型性能指标表示在整个控制过程中，系统的状态及控制应该满足的要求。采用积分型性能指 标的最优控制系统，又可分为以下几种应用类型：
1)最小时间控制。
                           (10-5) 最小时间控制是最优控制中常见的应用类型之一。它表示要求设计一个快速控制律，使系统在最 短时间内由已知初态x(to)转移到要求的末态x(ty)。例如，导弹拦截器的轨道转移即属于此类 问题。


2)最少燃耗控制。







(10-6)

式中 表示燃料消耗。这是航天工程中常遇到的重要问题之一。由于航天器所能携带的
燃料有限，希望航天器在轨道转移时所消耗的燃料尽可能地少。图10-1所示的登月舱软着陆控 制，即属于此类问题。


3)最少能量控制。







(10-7)





对于一个能量有限的物理系统，如通信卫星上的太阳能电池，为了使系统在有限的能源条件 下保证正常工作，就需要对控制过程中消耗的能量进行约束。显然，式(10-7)中的uFu 表示与消 耗的功率成正比的控制能量。
(2)末值型性能指标 数学描述为
J=q[x(ty),t;]                                                                   (10-8) 式中，末端时刻t 可以固定，也可以自由。末值型性能指标表示在控制过程结束后，对系统末态 x(ty) 的要求，例如要求导弹的脱靶量最小等，而对控制过程中的系统状态和控制不作任何要求。
(3)复合型性能指标
数学描述如式(10-3)所示。复合型性能指标是最一般的性能指标形式，表示对整个控制过程 和末端状态都有要求。采用复合型性能指标的最优控制系统，主要有以下两种应用类型：
1)状态调节器。
          (10-9) 式中，F=FT≥0,Q=Q⁷≥0,R=RT>0,               称为加权矩阵。为了便于设计，权阵F,Q  和 R 通常取为 对角阵。性能指标(10-9)表示对于运行在某一平稳状态的线性控制系统，在系统受扰偏离原平衡 状态时，控制律u*(t)   使系统恢复到原平衡状态附近时所要求的性能。其中，x(t)Qx(t)     表示控制 过程中的状态偏差；uF(t)Ru(t)  表示控制过程中消耗的控制能量，x⁷(tp)Fx(ty)    表示控制过程结 束时的末态偏差，1/2是为便于进行二次型函数运算而加入的标量因子。采用式(10-9)作为性能 指标的线性控制系统有许多种，例如导弹的横滚控制回路以及发电厂的电压调节系统，都属于状 态调节器范畴。


2)输出跟踪系统。




(10-10)

式 中 ，e(t)=z(t)-y(t)           为跟踪误差；z(t)  为理想输出向量，与实际输出向量y(t)  同维；加权矩阵
F,Q 和 R 的要求同式(10-9)。式(10-10)中各组成部分的物理意义与性能指标与式(10-9)类似。 许多实际控制系统，例如飞机、导弹及航天器的指令信号跟踪、模型跟踪控制系统中的状态或输 出跟踪等，均采用式(10-10)形式的性能指标。
4.最优控制的研究方法
当系统数学模型、约束条件及性能指标确定后，求解最优控制问题的主要方法有以下三类：
(1)解析法
解析法适用于性能指标及约束条件有明显解析表达式的情况。 一般先用求导方法或变分法 求出最优控制的必要条件，得到一组方程式或不等式，然后求解这组方程式或不等式，得到最优 控制的解析解。解析法大致又可分成两类：当控制无约束时，采用经典微分法或经典变分法；当控 制有约束时，采用极小值原理或动态规划。如果系统是线性的，性能指标是二次型形式的，则可采 用状态调节器理论求解。
(2)数值计算法
若性能指标比较复杂，或无法用变量显函数表示，则可以采用直接搜索法，经过若干次迭代， 搜索到最优点。数值计算法又可分为：





1)区间消去法，又称一维搜索法。适用于求解单变量极值问题，主要有裴波那西法、黄金分 割法和多项式插值法等。
2)爬山法，又称多维搜索法。适用于求解多变量极值问题，主要有坐标轮换法、步长加速法、 方向加速法等。
(3)梯度型法
这是一种解析与数值计算相结合的方法，其中包括：
1)无约束梯度法。主要有陡降法、拟牛顿法、共轭梯度法和变尺度法等。
2)有约束梯度法。主要有可行方向法和梯度投影法等。
在上述最优控制研究方法中，数值计算法和梯度型法可参考《最优化方法》一书。本书仅介绍 最优控制的解析求解方法，包括变分法、极小值原理、动态规划以及线性二次型最优控制法。

10-2  最优控制中的变分法

当系统的数学模型由向量微分方程来描述，性能指标由泛函来表示时，确定控制无约束时的 最优解问题，就成为在微分方程约束下求泛函的条件极值问题，其数学基础为经典变分理论。
1. 泛函与变分
泛函与变分有如下基本概念。
(1)泛函与泛函算子
设对于自变量t,存在一类函数{x(t)}。如果对于每个函数x(t),有一个J 值与之对应，则变 量J  称为依赖于函数x(t)  的泛函数，简称泛函，记作J[x(t)]。
由上述泛函定义可见，泛函为标量，可以理解为“函数的函数”,其值由函数的选取而定。例 如，函数的定积分是一个泛函。设
                          (10-11) 当x(t)=t     时，有J[x]=1/2;      当x(t)=cost     时，有J[x]=sin1 。  表明式(10-11)确为泛函。
在最优控制问题中，如果取如下形式的积分型性能指标：
                      (10-12) 则J  的数值取决于n 维向量函数x(t),   故式(10-12)为泛函，常称为积分型指标泛函。
指标泛函可以看作是线性赋范空间中的某个子集到实数集的映射算子，其定义如下：设R"

为n 维线性赋范空间，R 为实数集，若存在一一对应关系：	
y=J[x],      ,     Vx∈R",y∈R	(10-13)
则称J[x]  为R"到 R 的泛函算子，记作J[x]:R"→R。
为了对泛函进行运算，常要求泛函J[x] 具有连续性和线性。
(2)连续泛函与线性泛函
如果式(10-13)满足下列线性条件：	
1)J[x₁+x₂]=J[x₁]+J[x₂];Vx₁,x₂∈R"	(10-14)
2)J[ax]=αJ[x],Vx∈R"
则称J[x]:R"→R    为线性泛函算子，其中α为标量。	






为了讨论泛函J[x] 的性质和运算，需要J[x] 为连续的，其定义如下：设J[x] 是线性赋范空 间R" 中子集D(J)   到实数集R 上的泛函算子，D(J)  为泛函J[x]   的定义域。若对于收敛于点x。 的点列xn, 其 中xo,xn∈D(J),    均有
                           (10-15) 则称泛函J  在 x。处连续；若J[x]   在子集D(J)   上的每一点都连续，则称J[x]    在D(J)  中连续。
由于泛函J[x] 定义在线性赋范空间上，因此对于线性泛函J[x], 若 l|xn-x||→0(n→ ○),       Vxn,x∈R"
时，必有

则线性泛函J[x] 是连续的，称J[x] 为线性连续泛函。
在用变分法求解最优控制问题时，要求指标泛函J[x]  为线性连续泛函，以使得J[x]   在任一 点上的值均可用该点附近的泛函值任意逼近。应当指出，在有限维线性空间上，任何线性泛函都 是连续的。
(3)泛函的变分
研究泛函的极值问题，需要采用变分法。变分在泛函研究中的作用，如同微分在函数研究中 的作用一样。泛函的变分与函数的微分，其定义式几乎完全相当。
为了研究泛函的变分，应先研究宗量的变分。设J[x]为连续泛函，x(t)∈R" 为宗量，则宗量 变分可表示为
δx=x(t)-x,(t),       Vx(t),x。(t)∈R"                 (10-16)
宗量变分δx 表 示R" 中 点x(t)   与xo(t)  之间的差。由于 δx 存在，必然引起泛函数值的变化，并以  J[Lx+eox]  表示。其中，0≤e≤1  为参变数。当e=1   时，得增加后的泛函值J[x+8x];      当ε=0时， 得泛函原来的值J[x]。
1)泛函变分的定义
定义10- 1 设 J[x]   是线性赋范空间R” 上的连续泛函，若其增量可表示为 △J[x]=J[x+δx]-J[x]
=L[x,8x]+r[x,ox]                                                          (10-17)
式中，L[x,8x]   是关于 δx 的线性连续泛函，r[x,8x]   是关于8x 的高阶无穷小，则
δJ=L[x,8x]
称为泛函J[x] 的变分。
上述定义表明，泛函变分就是泛函增量的线性主部。当一个泛函具有变分时，亦称该泛函可 微。如同函数的微分一样，泛函的变分可以利用求导的方法来确定。
2)泛函变分的求法
定理10- 1 设 J[x]   是线性赋范空间R” 上的连续泛函，若在x=x 。 处 J[x]    可微，其中x, x₀ ∈R", 则 J[x]   的变分为





0≤E≤1


(10-18)

证 明 因 在xo 处 J[x] 可微，故必在x。处存在变分。因J[x] 连续，故由式(10-17)知    的
增量为
△J=J[x 。+eδx]-J[x 。]





=L[x₀,eox]+r[x₀,eox] 由于L[xo,eox]  是 eδx 的线性连续泛函，故
L[x₀,eox]=eL[x₀,ox] 又因r[xo,eox]是eox的高阶无穷小，故

于是


=δJ[xo,ox]
3)泛函变分的规则。由变分定义可以看出，泛函的变分是一种线性映射，因而其运算规则类 似于函数的线性运算。设L₁  和L₂ 是函数x,x 和t的函数，则有如下变分规则：
①8(L₁+L₂)=δL₁+8L₂;
②8(L₁L₂)=L₁OL₂+L₂OL;


例10-1 已知连续泛函为

式中，x 和 i  为标量函数。试求泛函变分8J。 解根据定理10-1,可得



(4)泛函的极值与变分预备定理
可以证明，泛函极值与达到极值的条件与函数类同。
1)泛函极值的定义。
定义10-2 设 J[x] 是线性赋范空间R”上某个子集D 中的线性连续泛函，点x₀∈D, 若存在 某一正数σ以及集合
U(x₀,o)={x||x-xol<σ,x∈R"} 在x∈U(xo,o)CD    时，均有
△J[x]=J[x]-J[x 。]≥0                                                          (10-19)
或者
△J[x]=J[x]-J[x 。]≤0                                                           (10-20)





则称泛函J[x] 在x=x。 处达到极小值(或极大值)。
2)泛函极值的必要条件。
定理10-2 设 J[x]   是在线性赋范空间R” 上某个开子集D  中定义的可微泛函，且在x=x。 处达到极值，则泛函J[x] 在x=x。 处必有
δJ[x₀,δx]=0                                                                   (10-21)
定理表明，泛函一次变分为零，是泛函达到极值的必要条件。
3)变分预备定理。为了深入研究无约束泛函极值条件和有约束泛函极值条件，以及用变分 法求解控制无约束的最优控制问题，需要应用变分预备定理。
定理10-3(变分预备定理)设5(t)是时间区间[to,t₁]上连续的n 维向量函数，η(t)为任意 的 n 维连续向量函数，且有η(to)=η(t₁)=0 。   若满足

则必有
5(t)=0,       ,      Vt∈[to,t₁]
2 . 欧拉方程
欧拉方程又称欧拉-拉格朗日方程，是无约束泛函极值及有约束泛函极值的必要条件。在推 导欧拉方程的过程中，应用了式(10-21)所示的泛函极值的必要条件，并且为了便于讨论，假定了 to和 ty给定，且初态x(to)和末态x(ts)为两端固定的情况。
(1)无约束泛函极值的必要条件
定理10-4 设有如下泛函极值问题：
古
式中，L(x,x,t)    及 x(t)   在[to,tj]   上连续可微，to及 tr 给定。已知x(to)=xo,x(ty)=xr,x(t)∈R",


则极值轨线x'(t)满足如下欧拉方程

及横截条件




(10-22)


(10-23)

证明 设 x"(t) 是满足边界条件x(to)=xo 和 x(t;)=x, 的极值轨线，x(t)是 x'(t)邻域中的 一条容许轨线。x(t)  与 x*(t)  之间有下列关系：
x(t)=x*(t)+δx(t),      x(t)=x*(t)+δx(t)
以 及                 x(to)=x"(to)=xo,                   x(ty)=x*(tj)=xf
取泛函增量
△J[x]=J[x°+δx]-J[x·]





式 中HOT  代表泰勒展开式中的高阶项。由变分定义知，取上式主部可得

对上式中的第二项作分部积分，有

由定理10-2,令δJ=0,    再由定理10-3,考虑到 δx 任意，立即证得本定理的结论式(10-22)和
式(10-23)。
在一般情况下，欧拉方程是一个时变二阶非线性微分方程，求解时所需的两点边界值由横截 条件式(10-23)提供。由于在两端固定情况下，必有δx(to)==0和 δx(t;)=0, 因此定理10-4中的 横截条件退化为已知边界条件x(to)=xo 和 x(t;)=x。
应当指出，欧拉方程是泛函极值的必要条件，而不是充分必要条件。在处理实际泛函极值问 题时，可从实际问题的性质出发，判断泛函极值的存在性，并直接利用欧拉方程求出极值轨线 x"(t)。
例10-2 设有泛函

已知边界条件为x(0)=0,x(π/2)=2。 求使泛函达到极值的极值轨线x"(t)。
解 本 例L(x,i)=x²-x²,           因

故欧拉方程为
#(t)+x(t)=0
其通解为.
x"(t)=c₁cost+c₂sint
在上式中，分别代入已知边界条件x(0)=0 和 x(π/2)=2, 可求出c₁=0,c₂=2。  于是求出
x*(t)=2sint _ (2)有等式约束泛函极值的必要条件
·在求解实际系统的最优控制问题时，要求使指标泛函取极值的极值轨线同时满足系统的运 动微分方程式。因此，控制系统的最优控制问题，要求确定在微分方程等式约束条件下的泛函极 值，即条件极值变分问题。
在讨论条件极值的变分问题时，我们仍然先考虑最简单的两端固定情况。利用拉格朗日乘子 法，可以将有等式约束的泛函条件极值问题化为无约束泛函极值问题。
定理10-5 设有如下条件泛函极值问题：

s.t.           f(x,x,t)=0
式中，f(x,x,t)=0       为系统运动微分方程；g(x,x,t)      及x(t)   在[to,t₇]  上连续可微；x,x,f(·)∈R";
to及ty 给定。已知x(to)=xo,x(t;)=x,,          则极值轨线x'(t)    满足如下欧拉方程及相应的横截条件：





式

其 中                  L(x,x,λ,t)=g(x,x,,t)+λT(t)f(x,x,t) 为拉格朗日函数，λ(t)∈R”为待定拉格朗日乘子。
证 明 设 λ(t)∈R”待定，构造广义泛函


于是，原性能泛函的条件极值问题，转化为广义泛函的无约束极值问题。根据定理10-4,本定理 得证。
与定理10-4情况相同，在两端固定情况下，定理10-5的横截条件退化为已知的两点边界 条件。
例10-3 设人造地球卫星姿态控制系统的状态方程为

7

x

试求使指标泛函取极值的极值轨线x"(t)   和极值控制u"(t)。 解本例为有等式约束泛函极值问题。由题意






故拉格朗日标量函数


欧拉方程


AT=[λ₁λ₂]





λ₁=a

λz=-at+b
u=at-b





式中常数a,b  待定。 由状态约束方程
iz=u=at-b,

式中常数c,d  待定。代入已知边界条件：x₁(0)=1,x₂(0)=1,x₁(2)=0,x₂(2)=0,                   可求得
a=3,             b=3.5,              c=d=1
于是极值轨线
x₁"(t)=0.5t³-1.75t²+t+1 x₂"(t)=1.5t²-3.5t+1
极值控制
u"(t)=3t-3.5
3.横截条件
求解欧拉方程，需要由横截条件提供两点边界值。前面研究的两端固定，且初始时刻to 和 末 端时刻ty 同时固定的情况，是一种最简单的情况。在实际工程问题中，初始时刻to 和初始状态 x(to)往往是固定的，但末端时刻tr可以固定，也可以自由；末端状态x(ty)可以固定，可以自由， 也可以受约束。下面将讨论tr固定和ty自由时的各种横截条件，同时指出，在不同横截条件情况  下，欧拉方程的形式总是不变的。
(1)末端时刻固定时的横截条件
当tr固定时，由泛函极值的必要条件可知，横截条件的一般表达式为式(10-23)。在x(to)= x。固定情况下，因δx(to)=0,   故横截条件及边界条件的一般形式应为
(10-24)
显然，当末端固定x(t;)=x       时，末端状态变分δx(tp)=0,    横截条件及边界条件式(10-24)退 化为边界条件x(ty)=x, 和 x(to)=xo; 当末端状态x(t) 自由时，末端状态变分δx(t;)≠0,横 截 条件及边界条件式(10-24)演变为




x(to)=x。


(10-25)



(2)末端时刻自由时的横截条件
tr自由且x(ty)自由或受约束情况，属 于变动端点情况。在变动端点问题中，可以 证明：极值仅在欧拉方程的解x=x(t,c₁,
c₂)上达到。其中，待定系数c₁, 和c₂ 由横截 条件确定。因此，泛函极值由x(t,c₁,c₂)一 类函数确定。
设tr  自由，起点固定x(to)=xo,     末 端 有约束x(ty)=c(ty)     的变分问题如图10-2 所示。图中，x"(t) 为极值轨线；x(t)为




图10-2 末端时刻自由时的变分问题





x"(t)邻域内的任一条容许轨线；(xo,to)表示起点；点(xf,ty)到 点(xr+8xy,ty+δty)表示变动端； c(t) 表示端点约束曲线，要求x(ty)=c(t;);8t;        为微变量，表示末端时刻的变分。例如，利用地空 导弹截击按程序机构控制飞行轨迹的高空无人侦察机即属于这类问题。其中，导弹轨迹x(t)   和

无人机轨迹c(t) 都随时间而变，但要求有x(ty)=c(tj)。
由图10-2可见，在末端受约束时，存在如下近似关系式： δx(ty)=δx,-x(ty)δty
δxy=c(ty)δty
如果末端x(tp)自由，由于约束曲线c(t)不存在，故仅存在关系式(10-26)。 设性能指标泛函为下列连续泛函：

容许轨线x(t)与极值轨线x"(t)之间有如下关系：
x(t)=x"(t)+δx(t),      x(t)=x"(t)+δx(t)
当末端由(x,tf)    位置移动到(x+δxp,ty+δty)       位置时，产生如下泛函增量：



对于式(10-30)右端第一项，根据积分中值定理可得

式中0<θ<1。由于函数L(·)    是连续的；因此
L(x*+δx,x"+δx,t)l=1+&,=L(x*,x",t)|s,+e₁
式中e₁→0, 故有

对于式(10-30)右端第二项，将被积函数在极值轨线处展成泰勒级数，有


取上式右端中第二项进行分部积分，得





(10-26) (10-27)


(10-28)

(10-29)






(10-30)








(10-31)




(10-32)


(10-33)

将式(10-33)代入式(10-32),所得结果代入式(10-30),同时将式(10-31)也代入式(10-30), 然后对式(10-30)表示的泛函增量取线性主部，即得泛函变分
(10-34)





令式(10-34)表示的δJ=0,   同时考虑到δx(to)=0,   立即得到tr  自由、末端变动时泛函极值


的必要条件：欧拉方程

横截条件及边界条件




(10-35)


(10-36)

由式(10-35)和式(10-36)的推导过程和推导结果可见：
1)tr   自由、末端变动时的欧拉方程(10-35)的形式，与t   固定、末端固定时的欧拉方程(10- 22)完全相同，这一结论同样适用于有等式约束的泛函极值问题。
2)tr   自由、末端变动时的横截条件及边界条件通式(10-36),包含了tr 固定、末端固定时的 横截条件及边界条件通式(10-24),因为在tr 固定的情况下必有δty=0。
(3)末端时刻自由、末端状态变动时的横截条件
1)末端自由时的横截条件。当末端x(tp)自由时，关系式(10-26)成立：
δx(ty)=δx;-x(tp)δty
将上式代入式(10-36),整理得

x(to)=xo                                                                                                     (10-37)
因为 δx 和δtf均任意，故tr自由、x(ty)自由时的横截条件和边界条件为
x(t₀)=x₀
                                   (10-38)

2)末端受约束时的横截条件。设末端约束方程为
x(ty)=c(ty)
此时， δx,不能任意。由式(10-27)知
δx;=c(t;)δtf
将上式代入式(10-37),整理得
x(to)=x。

因为δt;任意，故tr自由、x(ty)受约束时的横截条件和边界条件为 x(to)=x₀
x(ty)=c(ty)                                                                                   (10-39)

在初始时刻to 及初始状态x(to)=x 。 固定的情况下，不同末端时刻和不同末端边界所对应




的横截条件与边界条件，见表10-1。
表10-1不同边界情况下的横截条件

	横截条件与边界条件
ty固定
(x(to)固定)	x(ty)固定	r(to)=Yo, r(tf)=r
	x(ty)自由	

tr自由

(x(to)固定)	
x(tp)自由	

	
x(ty)约束	)=xo,x(ty)=c(ty)



例10-4 设性能指标泛函

式中末端时刻ty 未给定。已知x(0)=1,     要求
x(ty)=c(t)=2-t
求使泛函为极值的最优轨线x*(t)及相应的tj和 J°。


图10-3 例10-4的最优轨线	解本例为起点固定、r 自由、末端受约束的泛函极值问 题。显然，所给出的指标泛函就是x(t)的弧长，约束方程c(t) =2-t 为平面上的斜直线，如图10-3所示。本例问题的实质是 求从x(0)到直线c(t)并使弧长最短的曲线x*(t)。 图中，x(t) 为一条任意的容许轨线。
由题意
L(x,  文，t)=(1+i²)1/2
其偏导数为

根据欧拉方程

求得

式中c 为积分常数，a 为待定常数。因而
i(t)=a,      x(t)=at+b
其中b 也是待定常数。
由x(0)=1,     求 出b=1;   由横截条件


性


式! L( 集

其 知

函 式






中


古






解得i(tr)=1 。  因 为i(t)=a,      所以有a=1 。 从而最优轨线为
x'(t)=t+1
当t=tr   时 ，x(tg)=c(tr),     即
ty+1=2-t
求出最优末端时刻tr"=0.5 。  将 x*(t)   及 tr" 代入指标泛函，可得最优性能指标J'=0.707。
4.变分法解最优控制问题
在控制向量不受约束，且是时间的连续函数情况下，可用变分法导出最优控制解的必要条 件。在变分法问题中，以复合型指标泛函、末端受约束的情况最有代表性。
设系统状态方程为
x(t)=f(x,u,t),                    x(to)=x₀                                                (10-40)
性能指标泛函为
                    (10-41)
式中，x∈R”;u∈R",   无约束，且在[to,tr]   上连续；在[to,t;]   上，向量函数f(·) 、   标量函数φ( ·)和 L(·)   连续且可微；末端时刻ty 可以固定，也可以自由；末端状态x(ty)  受约束，其要求的目标 集为
ψ[x(ty),ty]=0                                                                 (10-42) 其中ψ∈R',r≤n 。 最优控制问题是：确定最优控制u'(t)    和最优轨线x"(t),    使系统(10-40)由已 知初态x。转移到要求的目标集(10-42),并使给定的指标泛函(10-41)达到极值。
显然，上述问题是一个有等式约束的泛函极值问题，可以采用拉格朗日乘子法，把有约束泛 函极值问题化为无约束泛函极值问题。构造哈密顿函数
H(x,u,λ,t)=L(x,u,t)+λT(t)f(x,u,t)                                                          (10-43)
式中λ∈R” 为拉格朗日乘子向量。则最优解的必要条件可以分别讨论如下。
(1)末端时刻固定时的最优解
当tr 固定时，引入拉格朗日乘子向量：λ(t)∈R",Y∈R',   构造如下广义泛函：


由于分部积分

故广义泛函可表示为
Ja=9[x(ty)]+Yψ[x(tp)]-iT(t,)x(t;)+AT(to)x(to)
(10-44)





对广义泛函式(10-44)取一次变分，注意到待定乘子向量λ(t) 和Y 不变分，以及δx(to)=0,
可得

(10-45) δx(tf)  的任意性，及变分

(10-46) (10-47)
横截条件
(10-48)
由于引进哈密顿函数形式(10-43),使得
(10-49)
上式与式(10-46)形成正则形式，其右端都是哈密顿函数的适当偏导数，故将式(10-49)和式(10- 46)称为正则方程。因为式(10-49)是众知的状态方程，故称式(10-46)为协态方程，相应的乘子向 量λ(t)称为协态向量。
正则方程(10-49)和(10-46)是2n 个一阶微分方程组，初始条件x(to)=xo    和横截条件(10-  48)正好为正则方程提供2n个边界条件，根据对f(·),L(·)           和φ( · )的连续性和可微性假设， 正则方程可以唯一确定状态向量x(t)和协态向量λ(t)。
对于确定的x(t)  和λ(t),  哈密顿函数H(·)     是控制向量u(t)  的函数。式(10-47)表明，最优 控制u'(t)    使哈密顿函数H(·)     取驻值，因此式(10-47)通常称为极值条件或控制方程。由极值 条件(10-47),可以确定最优控制u*(t)  与最优轨线x*(t)  和协态向量λ*(t)  之间的关系。
应当指出，正则方程(10-49)、(10-46)与极值条件(10-47),形成变量间相互耦合的方程组， 其边界条件由初始条件、横截条件(10-48)和目标集(10-42)提供，其中目标集条件(10-42)用于 联合确定待定的拉格朗日乘子向量Y。
上述讨论，可以归纳为如下定理。(为便于书写，今后凡不致混淆之处，均省略“*”号)。 定理10-6 对于如下最优控制问题：

s.t.①x(t)=f(x,u,t),x(to)=x₀
②ψ[x(tp)]=0
式中，x∈R”;u∈R",   无约束且在[to,t;]   上连续；ψ∈R′,r≤n;     在[to,tf]   上 ，f(·),ψ(·),φ(·)                 和
L(·)    连续且可微；tr 固定。最优解的必要条件为 1)x(t)    和λ(t) 满足正则方程






式中                 H(x,u,λ,t)=L(x,u,t)+λT(t)f(x,u,t)
2)边界条件与横截条件
x(to)=xo,    ψ[x(ty)]=0

3)极值条件

定理10-6是tr 固定、末端x(tr) 受约束时泛函极值的必要条件，通过适当修改，其结论可以 移植到末端自由和末端固定时的情况。
当末端时刻ty固定、末端x(tp) 自由时，由于不存在目标集条件(10-42),因此在定理10-6的 结论中，删除向量ψ[x(tp)],即为tr固定、x(t)自由时泛函极值的必要条件。这一结论，通过定理 10-6的推导过程明显可见。
当末端时刻tf 固定、末端x(t;)=x;     固定时，由于δx(to)=0   以及δx(tr)=0,     广义泛函J。的
一次变分(10-45)变成
               (10-50)
式中，δx 是任意的，但容许控制变分δu 不再是完全任意的，必须满足某些限制条件。卡尔曼曾经 论证：若系统完全可控，同样可以导出a       H/au=0的极值条件。因此，在系统可控条件下，令 式(10-50)为零，由变分预备定理得

应当特别注意的是，因为δx(ts)=0,    所以横截条件式(10-48)不成立，也不可能是λ(tj)=aφ/
ax(ty);  当α · )=0时，a(ty)=0    也不能成立。此时，已知的x(to)=x 。和 x(ty)=xy,   就是求解正 则方程的两端边界条件。
例10-5 设系统方程为
i₁(t)=x₂(t) ₂(t)=u(t)
求从已知初态xo(0)=0 和 x₂ (0)=0, 在ty=1 时转移到目标集(末端约束) x₁(1)+x₂(1)=1
且使性能指标

为最小的最优控制u'(t)和相应的最优轨线x'(t)。
解本例控制无约束，可用变分法求解，属积分型性能指标、t; 固定、末端受约束的泛函极值 问题。由题意：
4[x(ty)]=0,              
ψ[x(tp)]=x₁(1)+x₂(1)-1
构造哈密顿函数
·559 ·








由协态方程


由极值条件

由状态方程
i₂=u=c₁t-C₂,

根据已知初态x₁(0)=x₂(0)=0,         求出



λ₁(t)=C₁

λ₂(t)=-cit+c₂


u(t)=-λ₂(t)=c₁t-C₂





C₃=c₄=0
再由目标集条件x₁(1)+x₂(1)-1=0,            求得
4c₁-9c₂=6
根据横截条件

得到λ₁ (1)=λ₂ (1),故有 。于是解出

从而，本例最优解为



(2)末端时刻自由时的最优解
当tr自由时，末端状态又可区分为受约束、自由和固定等三种情况。其中，以复合型性能指 标、末端受约束的泛函极值问题最具一般性，所得到的结果可以方便地推广到末端自由和末端固定 情况。末端时刻自由时所讨论的问题，除tr 自由外，其余与末端时刻固定时所讨论的内容相同。
定理10-7 对于如下最优控制问题：

s.t.①x(t)=f(x,u,t),x(to)=x。
②ψ[x(tp),tj]=0





式中tr自由，其余假设同定理10-6,则最优解的必要条件为 1)x(t)   和λ(t) 满足正则方程

其中
H(x,u,λ,t)=L(x,u,t)+λT(t)f(x,u,t)
2)边界条件与横截条件
x(to)=xo,    ψ[x(ts),tj]=0

3)极值条件


4)在最优轨线末端哈密顿函数变化律

证明 引入拉格朗日乘子向量λ(t)∈R”和 Y∈R',构造广义泛函

式中，哈密顿函数H(x,u,λ,t)     定义同式(10-43)。
当末端位置由(xr,tj)   移动到(x;+δxf,ty+δt;)      时，产生如下广义泛函增量： △Ja=9[x'(ty)+δx,ty+δt;]-9[x*(tp),tŋ]
+YT{ψ[x*(t;)+δx,,ty+δt;]-ψ[x"(ty),t₅]}


将上式展成泰勒级数并取主部，以及应用积分中值定理并考虑到δx(to)=0,可得广义泛函 变分表达式

(10-51)
由式(10-26)知，如下关系式成立：
δx(ty)=δx;-x(tp)δt; 将式(10-26)代入式(10-51),整理得







(10-52)
令上式δJa=0,   考虑到式中各微变量δtf,oxy,ox   和 δu均是任意的，由变分预备定理立即证 得本定理的各项结论。
定理10-7的结论同样可方便地推广至末端自由和末端固定的情况，其注意事项与末端时刻 固定时最优解的情况相同。不同末端状态边界条件下求最优解的必要条件列于表10-2,以供使 用时参考。
表10-2用变分法求最优解的必要条件


s.t.k(t)=f(x,u,t) x(to)=xo
ψ[x(t),t]=0
H=L(x,u,t)+λTf(x,u,t)	

正则  方 程 、	

极值 条件	

边界条件与横截条件	

H变化律



tr固定	末端约束	







	







	x(to)=xo,ψ[x(t)]=0
	
	末端自由			x(to)=xo
	
	末端固定  (系统可控)			x(to)=xo x(ty)=x	




t自由	
末端约束			x(to)=x
ψ[x(ty),t]=0
	

	末端自由			x(to)=xo
	
	末端固定  (系统可控)			x(to)=xo x(tr)=x	
例10-6 设一阶系统方程为
i(t)=u(t)
已知x(0)=1,     要求x(tf)=0,      试求使性能指标

为极小的最优控制u*(t),    以及相应的最优轨线x'(t) 、 最优末端时刻tr" 、最小指标J' 。 其中，末
端时刻t; 未给定。
解本例为复合型性能指标、t;自由、末端固定、控制无约束的泛函极值问题。 由已知的系统方程知，系统是可控的。令






因 ,故λ(t)=a=const。 再 由

u"(t)=-λ(t)=-a
可使H=min 。 由状态方程
i(t)=u=-a,
代入x(0)=1,     解出
x'(t)=1-at
利用已知的末态条件
x(ty)=1-aty=0,                      tr=1/a
最后，根据H  变化律条件



求得
于是，本例最优解如下：





a=√2

u ·=- √2,       x'(t)=1- √2t
tr=√2/2,J'=√2

10-3   极小值原理及其应用

应用经典变分法求解最优控制问题，要求控制向量不受任何约束，而且要求哈密顿函数对控 制向量连续可微。但是，在实际工程问题中，控制变量往往受到一定的限制。例如，高性能飞机的 舵偏角一般不超过±5°;又如，采用空气舵的地-空战术导弹，容许的最大偏舵角一般不超过 ±20°。这就使得飞机和导弹的控制力矩受到一定的限制，容许控制集合形成一个有界闭集，在容 许控制集合边界上，控制变分δu 不能任意，最优控制的必要条件aH/au=0   亦不满足。
为了解决控制有约束的变分问题，庞特里亚金提出并证明了极小值原理，其结论与经典变分 法的结论有许多相似之处，能够应用于控制变量受边界限制的情况，并且不要求哈密顿函数对控 制向量连续可微，因此获得了广泛应用。
1.连续系统的极小值原理
为方便阐述，先研究定常系统、末值型性能指标、末端自由时的极小值原理，然后将所得结果 加以推广。
(1)末端自由时的极小值原理
定理10-8 对于如下定常系统、末值型性能指标、末端自由、控制受约束的最优控制问题

s.t.x(t)=f(x,u),        x(to)=xo
式中，x(t)∈R";u(t)∈ΩCR",       为任意分段连续函数，Ω2为容许控制域；末端状态x(t;)   自由；末端





时刻tr固定或自由。假设：
1)向量函数f(x,u)    和标量函数φ(x) 都是其自变量的连续可微函数。
2)在有界集上，函数f(x,u)    对变量x 满足利普希茨条件。
|f(x¹,u)-f(x²,u)|≤a|x¹-x²|,                                   a>0
则对于最优解u*(t),ty   和 x*(t),    必存在非零的λ(t)∈R",   使下列必要条件成立：
1)正则方程

式中哈密顿函数
H(x,u,λ)=λT(t)f(x,u)


2)边界条件与横截条件
x(to)=xo,
3)极小值条件

4)沿最优轨线哈密顿函数变化律(ty 自由时用)
H[x"(ty*),u"(tr*),λ(ty*)]=0
应当指出，定理10-8中的必要条件3)又可表示为

上式表示，对所有t ∈[to,tj],u(t)      遍取Ω中所有点，使H  为绝对极小值的u(t)=u*(t) 。   因 而 庞
特里亚金原理一般称为极小值原理。
与经典变分法相比，极小值原理的重要意义有如下几方面：
1)容许控制条件放宽了。极小值条件对通常的控制约束均适用。
2)最优控制使哈密顿函数取全局极小值。当满足经典变分法的应用条件时，其极值条件 a      H/au=0是极小值原理中极小值条件的一种特例。
3)极小值原理不要求哈密顿函数对控制向量的可微性，因而扩大了应用范围。
4)极小值原理给出的是最优解的必要而非充分条件。如果由实际工程问题的物理意义可以 判定解是存在的，而由极小值原理求出的控制又是唯一的，则该控制为要求的最优控制。实际遇 到的工程问题往往属于这种情况。
例10-7 设系统方程及初始条件为
i₁(t)=-x₁(t)+u(t),                          x₁(0)=1
i₂(t)=x₁(t),                                    x₂(0)=0
式中 u|t) | ≤1。 若系统末态x(tg)自由，试求u*(t)使性能指标
J=x₂(1)=min
解本例为定常系统、末值型性能指标、末端自由、tr. 固定、控制受约束的最优控制问题。由 题意
9[x(ty)]=x₂(1),                .ty=1
令                        H(x,u,λ)=λ₁         ( 一x₁+u)+λ₂x₁























其F







由协态方程







λ₂(t)=.C₂

λ₁(t)=c₁e+c₂

式 中c₁ 和c₂ 为待定常数。 由横截条件

解出c₁=-e-¹,c₂=1 。    故 有A:(t)=1-e'- ¹。
由极小值条件

易 知                     λ₁(t)=1-e-¹>0,                     Vt∈(0,1)
λ₁(t)=0,                                  t=1
故所求最优控制

定理10-8是适用于定常系统、末值型性能指标、末端自由时的极小值原理，但许多常见的最 优控制问题都可以化为这种形式，例如可推广于时变系统。
定理10-9 对于如下时变系统、末值型性能指标、末端自由、控制受约束的最优控制问题

s.t.x(t)=f(x,u,t),                        x(to)=x₀      式 中tr固定或自由，假设同定理10-8。则最优解的必要条件如下：
1)正则方程

其中哈密顿函数
H(x,u,λ,t)=XT(t)f(x,u,t)
2)边界条件与横截条件
x(t₀)=xo,              
3)极小值条件

4)沿最优轨线哈密顿函数变化律(tf 自由时用)

证明 令辅助变量xn+1(t)=t,则有
in+1(t)=1,               Zn+1(to)=to,            n+1(ty)=ty




构造增广向量

于是，该时变问题转化为如下定常问题：
minJ=4[x(t)]=4[x(t),xa+1(tr)]
s.t.   文(t)=     了[x(t),u(t)],              x(to)=x。
令辅助协态变量为λ+1(t),  构造增广协态向量
(10-53)
哈密顿函数
H(x,u,A)=XT(t)        了(x,u)=AT(t)f(x,u,t)+λ+1(t) =H(x,u,λ,t)+λa+1(t)
其 中             H(x,u,λ,t)=λT(t)f(x,u,t)
由定理10-8,协态方程为

代入式(10-53)和(10-54),得
(10-56)
由式(10-55),下式显然成立

从而证明了本定理的结论1)。 根据定理10-8,横截条件

代入X(tp)和x(ts)表达式，易得
(10-57)
于是，证明了本定理的结论2)。 由定理10-8,极小值条件为

代入式(10-54),上式可写为

立即证得本定理的结论3)。
根据定理10-8中的沿最优轨线哈密顿函数变化律以及式(10-54),有
H                   [x*(t"),u'(t),X(ty°)]
=H[x*(tf"),u*(tr),λ(tr"),tr']+λ+1(tr")=0






代入式(10-57),证得本定理结论4):

比较定理10-9与定理10-8可见，时变性并不影响极小值原理中的正则方程、横截条件和极 小值条件，但却改变了哈密顿函数沿最优轨线的变化律。
定理10-8的形式还可推广于积分型性能指标的问题。
定理10-10 对于如下定常系统、积分型性能指标、末端自由、控制受约束的最优控制问题

s.t.x(t)=f(x,u),       x(to)=x₀ 式中tr固定或自由，假设同定理10-8。则最优解的必要条件为
1)正则方程

其中哈密顿函数
H(x,u,λ)=L(x,u)+λT(t)f(x,u)
2)边界条件与横截条件
x(to)=xo,             λ(ty)=0
3)极小值条件

4)沿最优轨线哈密顿函数变化律(tr自由时用)
H[x*(t;"),u*(tr"),λ(tr")]=0
证 明  令辅助变量 ,则有
io(t)=L(x,u),                 xo(to)=0

构造增广向量

于是，积分型性能指标问题转化为如下末值型性能指标问题：

s.t.文(t)= 了(x,u),x(to)=x。 令λo(t) 为辅助协态变量，构造增广协态向量




及哈密顿函数




H(x,u,X)=XT(t)        了(x,u)=λ₀L(x,u)+ATf(x,u)


(10-58)






=H₀(x,u,λ)+λL(x,u)
由定理10-8,协态方程为

代入式(10-58)及(10-59),得

因而有
λ₀(t)=const

再由定理10-8的横截条件可得

因Lx(ty)]=xo(tp),       故上式可表示为

从而
哈密顿函数
H(x,u,λ)=L(x,u)+ATf(x,u)=H(x,u,A)
由定理10-8,其状态方程为

代入x(t)和 X(t)的增广形式，证得
,        io(t)=L(x,u)
再将式(10-62)代入式(10-61),有

由定理10-8,其极小值条件为

已证H(x*,u,X)=H(x,u,λ),            立即证得

由定理10-8,在最优轨线末端有


(10-59)











(10-60) (10-61)












(10-62)



代,

条1 其

这-


其


为 哈

此






其


求 !

显 最1


将


解





H[x"(tf"),u(ty"),X(ty")]=0 代入式(10-62),立即证得H'(ty")=0。
比较定理10-10、定理10-8可见，积分型性能指标改变了哈密顿函数的形式，也影响了横截  条件表达式。应当指出，不论是复合型性能指标，还是积分型性能指标，抑或是末值型性能指标， 其哈密顿函数的统一形式应为
H(x,u,λ)=L(x,u)+λT(t)f(x,u)                                                           (10-63)
这一规定，对时变系统同样适用。 例10-8 设一阶系统方程为
i(t)=x(t)-u(t),                         x(0)=5
其中控制约束：0.5≤u(t)≤1 。 试求使性能指标

为极小值的最优控制u*(t)及最优轨线x*(t)。
解本例为定常系统、积分型性能指标、f 固定、末端自由、控制受约束的最优控制问题。令 哈密顿函数
H=x+u+λ(x-u)=x(1+A)+u(1-A)
由于H  是 u 的线性函数，根据极小值原理知，使H  绝对极小就相当于使性能指标极小，因 此要求u(1-A)   极小。因u  的取值上限为1,下限为0.5,故应取

由协态方程

其解为λ(t)=ce⁻-1,         其中常数c 待定。
由横截条件
λ(1)=ce-¹-1=0
求出c=e。 于 是
λ(t)=e¹--1
显然，当A(t,)=1   时 ，u'(t)    产生切换，其中t, 为切换时间。令A(t,)=e¹--1=1,            得t₂=0.307,    故
最优控制

将u'(t)代入状态方程，有

解得






代入x(0)=5,    求出c₁=4,   因而
x"(t)=4e⁴+1,                 0≤t<0.307
在上式中，令t=0.307,     可以求出0.307≤t≤1   时 x(t)   的初态x(0.307)=6.44,         从而求得
c₂=4.37 。于是，最优轨线为

问是
本例最优解曲线如图10-4所示。
(2)末端约束时的极小值原理
对于具有目标集约束条件的最优控制问题，需要 把极小值原理的原始形式推广到末端受约束时的最 优控制问题。
定理10-11 对于如下定常系统、末值型性能指 标、末端受约束、控制也受约束的最优控制问题

s.t.①x(t)=f(x,u),                    x(to)=x。
②ψ[x(tp)]=0
式中，tf固定或自由；ψ( ·)∈R',r≤n,在[to,tr]上连 续可微；其余假设同定理10-8。则必存在非零常向量 Y∈R'和λ(t)∈R”,使最优解满足如下必要条件：
1)正则方程

图10-4 例10-8最优解曲线
其中哈密顿函数
H(x,u,λ)=λT(t)f(x,u)
2)边界条件与横截条件
x(to)=xo,    ψ[x(ty)]=0

则量
3)极小值条件

4)沿最优轨线哈密顿函数变化律(tr自由时用)
H[x"(ty"),u*(ty"),λ(ty")]=0
证明 引入拉格朗日乘子向量λ(t)∈R”和 Y∈R',构造等价末值型性能指标
J(u)=F[x(tp)]=9Lx(tp)]+YTψ[x(tp)] 则最优控制问题等同于定理10-8。
根据定理10-8,横截条件为







其余结论同定理10-8,故本定理得证。
不难证明，上述定理可以推广到时变情况。
定理10-12 对于如下时变系统、末值型性能指标、末端受约束、控制也受约束的最优控制 问 题

s.t.①x(t)=f(x,u,t),                            x(to)=x₀
②ψ[x(tf),tr]=0
式中tr  固定或自由，假设条件同定理10-11。则必存r 维非零常向量Y 和 n 维向量λ(t),   使最优
解满足如下必要条件：
1)正则方程

其中哈密顿函数
H(x,u,λ,t)=λT(t)f(x,u,t)
2)边界条件与横截条件
x(to)=xo,     ψ[x(ty),t₁]=0

3)极小值条件

4)沿最优轨线哈密顿函数变化律(tf  自由时用)

证明 引入拉格朗日乘子λ(t)∈R" 和 Y∈R', 构造等价末值型性能指标
J(u)=q[x(t;),t;]=q[x(t;),tj]+YTψ[x(ty),t}]
则最优控制问题等同于定理10-9。 根据定理10-9,横截条件为

沿最优轨线哈密顿函数变化律为

最优解必要条件中其余的结论与[x(tp),tŋ]      无关，等同于定理10-9。于是，本定理得证。
利用扩充变量法，还可以导出其他各种情况下的极小值原理形式。表10-3分别给出了各种 具体最优控制问题的极小值原理结论，以供查阅。






表10-3连续系统极小值原理的必要条件

末端 时刻	性能指标	末端状态	正则方程	极小值条件	边界条件与横截条件	H变化律









t 自 由	
J=f[x(t),t7]	
末端约束	





其中
H=L+λT	



















	x(to)=xo,ψ[x(tp),t7]=0
	H'(t")=

		
末端自由			x(to)=xo
	

		
末端约束			x(to)=xo,ψ[x(tp),t]=0
	

		末端自由			x(to)=xo,λ(ty)=0	H'(ty')=0
		末端固定			x(to)=xo,x(ty)=xy	H'(t')=0
	

J=f[x(tp),t]	
末端约束	

其中
H=λTf		x(to)=xo,ψLx(t),t]=0
	H'(ty')=

		
末端自由			x(to)=xo
	











t 固 定	
J=f[x(tp),t]
	
末端约束	






其中  H=L+xT		x(to)=xo,ψ[x(tp),t]=0
	
		
末端自由			x(to)=xo
	
	



	
末端约束			x(to)=xo,ψ[x(tp),t]=0
	
		
末端自由			x(to)=xo λ(ty)=0	
		
末端固定			x(4o)=x x(ty)=x/	
	

J=g[x(tp),t7]	
末端约束	

其中
H=λf		x(to)=xo,ψ[x(tp),t]=0
	
		
末端自由			x(to)=xo
	













2

下


文

























日

注：对于定常系统，当t固定时，最优解的必要条件同本表中t的固定情况；当自由时，除H变化律均为H'(tr')=0 外，其余同本表中t 的自由情况。





例10-9 设宇宙飞船登月舱的质量为m(t),  高度为h(t),   垂直速度为v(t),   发动机推力为 u(t),  月球表面重力加速度为常数g, 不含燃料时登月舱质量为M, 初始燃料的总质量为F 。已 知 登月舱的状态方程为
h(t)=v(t),                h(0)=h。
,v(0)=vo
m(t)=-ku(t),m(0)=M+F 要求登月舱在月球表面实现软着陆，即目标集为
ψ=h(ty)=0,                 ψz=v(ty)=0
发动机推力u(t)  的约束为 ·
u(t)∈2,          Ω={u(t)|0≤u(t)≤a},                     Vt∈[0,ty]
试确定最优控制u*(t),   使登月舱由已知初态转移到要求的目标集，并使登月舱燃料消耗 J=-m(ty)=min
解本例为时变系统、末值型性能指标、tr自由、末端约束、控制受约束的最优控制问题。构 造哈密顿函数

式中A₁(t),A₂(t) 和A₃(t)为待定的拉格朗日乘子。根据题意
φ=-m(ty)
由协态方程



由横截条件



式中Y₁和Y₂为待定的拉格朗日乘子。 将哈密顿函数整理成

由极小值条件，H 相对u"(t)取绝对极小值。因此，最优控制

·573 ·






上述结果表明，只有当登月舱发动机推力在其最大值和零值之间进行开关控制，才有可能在 软着陆的同时，保证登月舱的燃料消耗最少。
2.离散系统的极小值原理
随着数字计算机的日益普及，计算机控制系统日益增多，因此离散系统最优控制问题的研究 显得十分重要。其原因是多方面的：例如，许多实际问题本身就是离散的，这类问题有经济与资源 系统的优化问题、交通管制问题、河流污染控制问题等；又例如，对有约束的连续系统最优控制问 题，需要采用计算机求数值解，使得连续最优控制中难以求解的两点边界值问题，化为易于用计 算机求解的离散化两点边界值问题。
离散系统极小值原理的普遍论述比较复杂，证明过程也十分冗长。为简单起见，仅讨论控制 向量序列不受约束、末端时刻(数据窗口长度)固定、末端自由或受约束情况下的离散极小值原 理，然后不加证明地推广到控制向量序列受约束的情况。
(1)末端约束时的离散极小值原理
定理10-13 设离散系统状态差分方程为
x(k+1)=f[x(k),u(k),k],                         x(0)=x₀
(k=0,1,…,N-1)                                                                   (10-64)
性能指标
                  (10-65)
式中，N 固定；f( ·),φ( ·)和 L( ·) 都是其自变量的连续可微函数；x(k)∈R";u(k)∈R",  其约 束u(k)∈0,Q    为容许控制域。末端状态受下列目标集约束：
ψ[x(N)]=0                                                             (10-66)
式中ψ( ·)∈R′ 且连续可微，r≤n。
若u'(k)   是使性能指标(10-65)为最小的最优控制序列，x*(k) 是相应的最优轨线序列，则必 存在r 维非零常向量Y 和n 维向量序列 · λ(k),  使得最优解满足如下必要条件：
1)x(k)    和λ(k)  满足差分方程
                        (10-67)
                                (10-68) 式中离散哈密顿函数
H(k)△H[x(k),u(k),λ(k),k]
=L[x(k),u(k),k]+λT(k+1)f[x(k),u(k),k]                                                (10-69)
2)边界条件与横截条件
x(0)=xo,             4[x(N)]=0
                       (10-70)
3)离散哈密顿函数对最优控制序列取极小值
                          (10-71) 若u(k)  无约束，则极值条件为
























所









令








当




7






(10-72)
证明 引入拉格朗日乘子λ(k)和Y,构造离散广义泛函

+λT(k+1)[f(x(k),u(k),k)-x(k+1)]}
令离散哈密顿函数
H(k)=L[x(k),u(k),k]+λT(k+1)f[x(k),u(k),k] 则式(10-73)可表示为

因为“离散分部积分”



所以，离散广义泛函可写为

+λT(0)x(0)-λT(N)x(N)
对上式取一次变分，考虑到δx(0)=0,    可得


令δJa=0,   考虑到变分δx(k) 和δx(N)   是任意的，可得


对于
当 u(k)  不受约束时，δu(k) 是任意的，故必有

当u(k)∈Ω时，不加证明得

(2)末端自由时的离散极小值原理
如果离散系统末端自由，则离散极小值原理的形式如下，其证明过程类似于定理10-13。读者 不妨自行推证。





定理10-14 设离散系统状态差分方程为
x(k+1)=f[x(k),u(k),k],                         x(0)=x₀
(k=0,1,…,N-1)
性能指标
所
式中，N 固定，末端状态x(N)  自由，其余假设同定理10-13。
若u*(k)  是使性能指标为极小的最优控制序列，x"(k)  为相应的最优轨线序列，则必存在n 维向量序列λ(k),  使得最优解满足如下必要条件：
1)x(k)    和λ(k) 满足下列差分方程：

式中，离散哈密顿函数
H(k)△H[x(k),u(k),λ(k),k]
=L[x(k),u(k),k]+λT(k+1)f[x(k),u(k),k]
2)边界条件与横截条件
x(0)=xo,
令

若控制变量不受约束，则极值条件为

上述定理10-13及定理10-14表明，离散系统最优化问题归结为求解一个离散两点边值问 题，且使离散性能指标泛函为极小与使离散哈密顿函数为极小是等价的。
例10-10 设离散系统状态方程为

已知边界条件

试用离散极小值原理求最优控制序列，使性能指标

取极小值，并求出最优轨线序列。
解本例为控制无约束，N 固定，末端固定的离散最优控制问题。构造离散哈密顿函数 H(k)=0.05u²(k)+A₂(k+1)[x₁(k)+0.1x₂(k)]+A₂(k+1)[x₂(k)+0.1u(k)]
式中，λ₁(k+1)   和λ₂(k+1)   为待定拉格朗日乘子序列。 由协态方程，有











所 以

由极值条件




λ₂ (0)=0.1λ₁ (1)+λ₂ (1) λ₂ (1)=0.1λ₁ (2)+λ₂ (2)




故                               u(k)=-λ₂(k+1)
可 使H(k)=min。  令 k =0 和      得
u*(0)=-λ₂(1),                  u(1)=-λ₂(2)
将u · (k)表达式代入状态方程，可得
x₁(k+1)=x₁(k)+0.1x₂(k)    x₂(k+1)=x₂(k)-0.1λ₂(k+1)

令k 分别等于0和1,有	
x₁(1)=x₁(0)+0.1x₂(0),	z₂(1)=z₂(0)-0.1λ₂(1)
x₁(2)=x₁(1)+0.1x₂(1),	x₂(2)=x₂(1)-0.1λ₂(2)
由已知边界条件	
x₁(0)=1,	x₂(0)=0
x₁(2)=0,	x₂(2)=0
不难解出最优解	
u"(0)=-100,                 u*(1)=100


3.最小时间控制
最小时间控制，是可用极小值原理求最优解的一种控制类型。最小时间控制问题，又称时间  最优控制问题，它要求在容许控制范围内寻求最优控制，使系统以最短的时间从任意初始状态转 移到要求的目标集。 一般来说，求非线性系统和任意目标集的时间最优控制的解析解十分困难， 这里仅考虑线性定常系统且目标集为状态空间原点，即末端固定时的时间最优控制问题。
(1)最小时间控制问题
问题10-1 设线性定常系统
x(t)=Ax(t)+Bu(t)                                                                 (10-74) 是完全可控的，x(t)∈R",u(t)∈R",A,B        为维数适当的常阵。求满足下列不等式约束的容许





控制：
|u;(t) | ≤1;    j=1,2,…,m
使系统(10-74)从已知初态x(0)=x 。 转移到x(ty)=0,    并使性能指标
(10-75)

求解问题10-1之前，应首先判断该问题是否可用极小值原理求解?可以证明，只有当系统


(10-74)正常时，才能应用极小值原理求得最优解。
(2)正常情况与奇异情况
对于问题10-1,构造哈密顿函数
H(x,u,λ)=1+λTAx+λTBu
根据极小值条件 ,有

上式又可表示为

设                              B=[b₁b₂…bm] g;(t)=XT(t)b,
式中b;∈R”,j=1,2, …,m,        则式(10-76)可用下列符号函数表示：











(10-76)

(10-77) (10-78)


白


显见，若g;(t)≠0,V           t ∈[0,tj],则可用极小值原理确定u;(t),j=1,2,…,m 。    这种情况称为
正常(平凡)情况，相应的系统(10-74)称为正常系统。
若g;(t)=0,Vt∈[ti,t₂]C[0,t₅],                则 因u;'(t)     不定，无法应用极小值原理确定u;"(t),    只 能
取满足约束条件 u|;(t) |≤1的任意值。这种情况称为奇异(非平凡)情况，相应的系统(10-74)称 为奇异系统。
(3)奇异性的充分必要条件
定理10-15 对于问题10-1,设矩阵
G,=[b;Ab;…A"-¹b,];                 j=1,2,…,m                                         (10-79)
式中bj∈R”, 为矩阵B 的列向量。当且仅当m 个 G, 矩阵中至少有一个G, 是奇异矩阵，问题10-1 是奇异的。
证明构造哈密顿函数
H(x,u,λ)=1+λT(t)[Ax(t)+Bu(t)]                                                         (10-80)
由极小值原理知，应有H*(tf")=0,       所以在式(10-80)中，必有
λ(t)≠0,               Vt∈[0,t;]                                               (10-81)
由协态方程







其解为                     λ(t)=e-Aa(0),                  a(0)≠0
因而                        g;(t)=λT(t)b;=λT(0)e-~b; 设存在奇异区间[t₁,t₂]C[0,tr],使得
g,(t)=λT(0)e-b,=0,                       Vt∈[t₁,t₂] 对上式求导n-1   次，并根据矩阵指数性质，有
(-1)”-¹g;"-1(t)=AT(0)e-A"-b,=0
将g;(t)   各次导数表达式写为矩阵形式，有
AT(0)[e-b;e-"Ab,…e-A"-b;]=0                                                            (10-82)
由矩阵论知，向量λ(0)有非零解的充分必要条件为系数矩阵奇异，因此式(10-82)成立的充 分必要条件为
det[e-~b,e-"Ab,…e-A"-¹b,]
=dete-det[b;Ab,…A"-¹b,]=0                                                             (10-83)
因 为e-^ 为状态转移矩阵，是非奇异的，故式(10-83)成立的充分必要条件为 detG;=det[b;Ab;…A"-1b,]=0;                               Vj=1,2,…,m
由上述定理，立即可得问题10-1正常的充分必要条件。 定理10-16 问题10-1是正常的，当且仅当
rankG,=n;             Vj=1,2,…,m                                                    (10-84)
式中，b,∈R",由式(10-77)定义；G;为 n×n 矩阵，由式(10-79)定义。
事实上，正常系统与可控系统存在包含关系。在矩阵G, 中，若增加一些线性无关的列，则G, 的行秩不变。因此，式(10-84)可写为
rank[b,Ab;…A"-1b,]
=rank[b₁Ab₁…A"-b₁                       …      bm        Abm       …A"-1bm]=n             (10-85)
对式(10-85)进行列初等变换，并考虑到式(10-77),则式(10-85)又可写为
rank[B         AB          …A"-¹B]=n                                            (10-86)
上式正好是系统(10-74)完全可控的充分必要条件。因此，正常子空间包含于可控子空间。这种包 含关系表明，系统可控是系统正常的前提条件。因此，在问题10-1中提出了可控要求。显然，对于 单输入系统，j=1,   系统正常与系统可控彼此等价。
(4)Bang-Bang   控制原理
对于线性定常系统，若系统正常，则可应用极小值原理求解时间最优控制问题，其最优控制 在容许控制域内，从一个边界值来回切换到另一个边界值，形成Bang-Bang 控制特色。其主要结 果可以归纳为如下定理。
定理10-17   对于问题10-1,若系统(10-74)正常，则最优解的必要条件为
1)正则方程
)


式中哈密顿函数
H(x,u,λ)=1+λT(t)[Ax(t)+Bu(t)]
·579 ·





2)边界条件
x(0)=xo,     x(ty)=0
3)极小值条件
相应的

式中，b,∈R",为矩阵B 的列向量。
4)沿最优轨线H  变化律
H*(ty")=0
例10-11 设系统状态方程为
i₁(t)=x₂(t),                 i₂(t)=u(t)
边界条件为
x₁(0)=x10,x₂(0)=X20,x₁(ty)=x₂(ty)=0 控制变量的不等式约束为|u(t)|≤1,      性能指标

求最优控制u"(t),使J 极小。
解本例为二次积分模型的最小时间控制问题。不难验证，系统可控，因而正常，故时间最优 控制必为Bang-Bang  控制，可用极小值原理求解。构造哈密顿函数
H=1+λ₁x₂+A₂u
由定理10-17知，最优控制
曲 由式(
由协态方程

由图1
λ₂(t)=-c₁t+c₂
式中c₁ 和c₂ 为待定常数。
状态方程的解为
i₂(t)=1,                              x₂(t)=t+x₂0
₁(t)=t+T₂0,                        中，消去t, 求得相应的最优轨线方程
2 u'(t)
上式表示一簇抛物线，如图10-5中实线所示。图中曲线上的箭头表示时间t 的增加方向，由于 x₂ (t)=t+x₂0, 故x₂ (t) 随t的增加而增大。显然，满足末态要求的最优轨线为AO, 表示为
优 控 4
上的：






i₂(t)=-1,                               x₂(t)=-t+x₂0
i₁(t)=-t+x20,                       
相应的最优轨线方程为

上式也描绘了一簇抛物线，如图10-5中虚线所示。显然满足末态要求的最优轨线为BO, 可以表
示 为
(10-88)








优

图10-5 时间最优控制的最优轨线                 图10-6 相平面上的开关曲线
曲线Y+和Y_在相平面上组合成曲线Y,称为开关曲线，如图10-6中BOA所示。其表达式可 由式(10-87)和(10-88)导出为
               (10-89) 由图10-6可见，曲线Y 将相平面分割为R+ 和 R_ 两个区域，作为状态的集合，可以表示如下：
                   (10-90)
                   (10-91) 当初始状态(x10,I₂o) 为不同情况时，系统的最优控制和运动轨线可以讨论如下：
1)若(x10,T₂o)位于Y- 上，则在u=-1     作用下，沿BO运动至要求的原点，此时最优控制为
u*(t)=-1,t∈[0,ty]。
2 ) 若(x10,T₂o)位 于Y+上，则在u=+1     作用下，沿AO运动至要求的原点，此时最优控制为
u*(t)=+1,t∈[0,t]。
3)若(x10,T₂o)位于R+ 区域，则状态转移分两段进行。首先，在u=+1     作用下，沿u=+1   的
某一条抛物线转移至BO上的某点，然后在交点处控制改变为u=-1     沿γ_转移至原点。此时，最 优控制u*(t)={+1,-1},          控制作用在Y-曲线的交点处产生一次切换。
4)若(x10,T₂0)位于R- 区域，则在u=-1     作用下，沿u=-1     的某一条抛物线转移至Y+曲线 上的某一点，然后在交点处控制改变为u=+1,  沿Y+ 转移至原点。此时，最优控制u*={-1,





+1},控制作用在Y+ 曲线的交点处产生一次切换。
由上述讨论可见，不论初始状态位于R+ 区域或R-  区域，将状态由已知初态向要求末态 x(ty)=0   转移时，都必须在Y曲线上改变控制的符号，产生控制切换，故式(10-89)表示的Y曲 线 称为开关曲线。于是，本例的时间最优控制为

最 后 ，
4.最小能量控制
最小能量控制也是极小值原理获得成功应用的一个重要方面。最小能量控制问题是指在有 限时间的控制过程中，要求控制系统的能量消耗为最小。
设线性定常系统的状态方程为
作
x(t)=Ax(t)+Bu(t),        x(to)=x。
式中，x(t)∈R”;u(t)∈R",      控制约束|u,(t)|≤M,M>0,j=1,2,…,m;                 末端状态x(ts)=xf,tf      给
定。要求确定最优控制u'(t),    使性能指标

控制乡
上述最小能量控制问题可用极小值原理求解。构造哈密顿函数 H=uT(t)u(t)+λT(t)Ax(t)+λT(t)Bu(t)
角
(10-92)

.E
s(t)=BTλ(t)=[s₁(t)s₂(t)…sm(t)]
由协态方程

解得                              a(t)=e-Aa(to)
因为                B=[b₁b₂…bm],               b,∈R";j=1,2,…,m
故开关向量函数可求得
s(t)=BTλ(t)=BTe-Aa(to)                                   (10-93)
其分量                  s;(t)=b,"e-A²A(to);     j=1,2,…,m                              (10-94)
由 于                                   (10-95)
将上式代入式(10-92),哈密顿函数可表示为

将上
由极小值条件知，u*(t)应使H 为极小，即u,(t)应 使H 函数中[u;(t)+u;(t)s,(t)]为极小。
若u;(t)  无约束，可令
解得






j=1,2,…,m
上式表明，在u;(t)  无约束条件时，最优控制与开关函数s;(t)  成正比。但是，u;(t)  是有约束的，要 求 |u,(t)|≤M,      因此式(10-96)仅在 s|,(t)|≤2M       范围内成立。当|s,(t)|>2M      时，最优控制取
u;*(t)=-Msgn{s;(t)}                                                             (10-97)
最后，线性定常系统最小能量控制的最优控制律可以归纳如下：

(10-98)
有
j=1,2,…,m
例10-12 设系统状态方程为
i₁(t)=x₂(t),                 t₂(t)=u(t)
给
边界条件
x₁(0)=x₂(0)=0,
控制约束 |u(t)|≤1,     末端时刻t   自由。试确定最优控制u*(t),    使性能指标

解本例为系统定常、末端固定、tr 自由的最小能量控制问题。构造哈密顿函数
2)
由极小值条件知

由协态方程
λ₁(t)=c₁
3) 4)
式中c₁ 和 c₂ 为待定常数。
因为末端固定，不能由横截条件确定c₁ 和 c₂,需采用试探法。通常，最小能量控制问题的控 制量较小，可首选线性最优控制函数，即

将上式代入状态方程，有
卜。

解得






以及
解得                       根据初始条件x₁(0)=x₂(0)=0,         可得
C₃=C₄=0
根据末态条件，得
                      (10-99)
                      (10-100) 根据H 沿最优轨线变化律，有
H(ts)=u²(ts)+λ₁(ts)z₂(ty)+A₂(t)u(tr)=0
代入u(ty),x₂ (ts),A₁ (ts)及λ₂(t) 表达式，得
c₁-(c₂-c₁ty)²=0                                                                 (10-101)
联立求解式(10-99)～(10-101),可得
   ,tr=3
此时，最优控制

显然，应校验在[0,t;]  区间上，是否满足|u(t)|≤1      的约束条件。经校验，u(ty)=tj/18=1/6<1,


性能指


式中， ∈R',     FT≥0    (10-1(
右 F,Q(t
在 1


上式表 1/2是
由
2



A₂ (tf)=-c₁tf=-1/3,   满足 |u(t)|≤1及 |A₂ (t) |≤2的条件，故所作选择是正确的。最后得最优
轨线

拉格朗日乘子

最优性能指标


10-4   线性二次型问题的最优控制

如果所研究的系统是线性的，且性能指标为状态变量和控制变量的二次型函数，则最优控制 问题称为线性二次型问题。由于线性二次型问题的最优解具有统一的解析表达式，且可导致一个 简单的线性状态反馈控制律，易于构成闭环最优反馈控制，便于工程实现，因而在实际工程问题 中得到了广泛应用。
1.线性二次型问题
设线性时变系统的动态方程为
x(t)=A(t)x(t)+B(t)u(t),                          x(to)=x₀


上式表 统 在 的控制
3



因为扌
制过程 」
跟踪认 人
阵，不 本质。
纟 (  不















1-99) 100)



101)







;<1,  最 优













控 制 (一个 问 题





y(t)=C(t)x(t)                                                              (10-102)
性能指标为
     (10-103)
式 中 ，x(t)∈R";u(t)∈R",       无约束；y(t)∈R',0<l≤m≤n;           输出误差向量e(t)=z(t)-y(t);z(t)
∈R',  为理想输出向量；A(t),B(t),C(t)       为维数适当的时变矩阵，其各元连续且有界；权阵F=
F≥0,Q(t)=Q⁷(t)≥0,R(t)=R'(t)>0;to                        及 ty 固定。要求确定最优控制u'(t),     使性能指标
(10-103)极小。
在今后讨论中，若非特别指出，以上假设始终满足。为了便于工程应用，式(10-103)中的权阵 F,Qt)    和R(t)  多取为对角阵，则其对称性自然满足。
在二次型指标(10-103)中，其各项都有明确的物理含意，可分述如下：
1)末值项。若取F=diag(f,f₂, … ,fi),             则有

上式表明，末值项是末态跟踪误差向量e(ty) 与希望的零向量之间的距离加权平方和。式中，系数 1/2是为了便于运算，e;(ty) 为 e(ty)  的变量。
由此可见，末值项的物理含意是表示在控制过程结束后，对系统末态跟踪误差的要求。
2)积分项 。若取Q(t)=diag{q₁(t),q₂(t), … ,qi(t)},             则有

上式表明，该积分项表示在系统控制过程中，对系统动态跟踪误差加权平方和的积分要求，是系 统在控制过程中动态跟踪误差的总度量，几何上以面积大小表示。该积分项与末值项反映了系统 的控制效果。
3)积分项 。若取R(t)=diag{r₁(t),r₂(t), … ,rm(t)},             则 有

因为控制信号的大小往往正比于作用力或力矩，所以上式表明，该积分项定量地刻画了在整个控 制过程中所消耗的控制能量。
上述分析表明，使二次型指标(10-103)极小的物理意义是：使系统在整个控制过程中的动态 跟踪误差与控制能量消耗，以及控制过程结束时的末端跟踪偏差综合最优。
从性能指标的物理意义可知，式(10-103)中权矩阵F,Qt)     和 R(t)  都必须至少取为非负矩 阵，不能取为负定矩阵，否则性能指标(10-103)的数学描述就会违背物理现实和最优控制问题的 本质。至于要求权矩阵R(t)  正定，那是由于最优控制律的需要，以保证最优解的存在。
线性二次型最优控制问题有如下几种类型：
(1)状态调节器问题
在系统方程(10-102)和二次型性能指标(10-103)中，如果C(t)=I,z(t)=0,          则有
e(t)=-y(t)=-x(t)
·585 ·





式 中
(10-104)
这时，线性二次型最优控制问题为：当系统(10-102)受扰偏离原零平衡状态时，要求产生一控制 向量，使系统状态x(t)  恢复到原平衡状态附近，并使性能指标(10-104)极小。因而，称为状态调节 器问题。
(2)输出调节器问题
对于系统方程(10- 102)和性能指标(10- 103),如果理想输出向量z(t)=0,       则 有
e(t)=-y(t)。 从而，性能指标(10-103)演变为
(10-105)
由极
这时，线性二次型最优控制问题为：当系统(10-102)受扰偏离原输出平衡状态时，要求产生一控 制向量，使系统输出y(t)保持在原零平衡状态附近，并使性能指标(10-105)极小。因而，称为输出 调节器问题。
(3)输出跟踪系统问题
对于系统方程(10-102)和性能指标(10-103),其中C(t)≠I,z(t)≠0,          则线性二次型最优控 制问题归结为：当理想输出向量z(t)作用于系统时，要求系统产生一控制向量，使系统实际输出 向量y(t)始终跟踪z(t)的变化，并使性能指标(10-103)极小。因而，这一类线性二次型最优控制 问题称为输出跟踪系统问题。
此外，根据不同的出发点，线性二次型最优控制问题还有其他的分类方法。例如，根据末端时 刻tr 是有限或无限，可以分为有限时间线性二次型问题和无限时间线性二次型问题；根据被控 系统是连续的还是离散的，可以分为线性连续系统二次型最优控制问题和线性离散系统二次型 最优控制问题。
由于线性离散二次型最优控制方法原则上是线性连续二次型最优控制方法的平行推广，因 此我们仅讨论连续系统的线性二次型最优控制问题。
2.有限时间时变状态调节器
当末端时刻ty 有限时，有限时间时变状态调节器问题可以描述如下： 问题10-2 设线性时变系统状态方程为
x(t)=A(t)x(t)+B(t)u(t),x(to)=x₀                                                          (10-106) 式中，x(t)∈R";u(t)∈R",      无约束；矩阵A(t)  与 B(t)  维数适当，其各元在[to,t/]   上连续且有界。要 求确定最优控制u*(t),    使性能指标(10-104)极小。其中，权阵F=F≥0,Q(t)=Q⁷(t)≥0,
R(t)=R(t)>0,   其各元在[to,tr]上均连续且有界；末端状态x(tp)自由；末端时刻ty给定且有


限 。
(1)最优解的充分必要条件
定理10-18 对于问题10-2,其最优控制的充分必要条件为
u*(t)=-R-¹(t)BT(t)P(t)x(t)
最优性能指标





(10-107)

(10-108)





式 中 ，P(t)  为n×n   对称非负矩阵，满足下列里卡蒂矩阵微分方程：
-P(t)=P(t)A(t)+AT(t)P(t)-P(t)B(t)R-¹BT(t)P(t)+Qt)                                                          (10-109)
其边界条件
P(ty)=F                                                                 (10-110)
而最优轨线x*(t),则是下列线性向量微分方程的解：
x(t)=[A(t)-B(t)R-¹(t)B'(t)P(t)]x(t),                                  x(to)=x₀                     (10-111)
证 明 必要性：若u*(t)为最优控制，可证式(10-107)成立。 因u'(t)    最优，故必满足极小值原理。构造哈密顿函数

由极值条件

故                              u*(t)=-R-¹BTλ(t)                                                              (10-112)
可使哈密顿函数极小。再由正则方程
(10-113) (10-114)
因末态x(ty)自由，所以横截条件为
(10-115)
由于在式(10-115)中，λ(ty)与x(ty)存在线性关系，且正则方程又是线性的，因此可以假设
λ(t)=P(t)x(t),               Vt∈[to,tf]                                        (10-116)
式中矩阵P(t)待定。对上式求导，得
λ(t)=P(t)x(t)+P(t)x(t)                                                              (10-117)
将式(10-113)和(10-116)代入式(10-117),有
λ(t)=[P(t)+P(t)A(t)-P(t)B(t)R-¹(t)BT(t)P(t)]x(t)                                               (10-118)
将式(10-116)代入式(10-114),则又有
λ(t)=-[Q(t)+AT(t)P(t)]x(t)                                                          (10-119)
比较式(10-118)和式(10-119),立即证得里卡蒂方程(10-109)成立。 在式(10-116)中，令t=tj,    有
有
λ(ty)=P(ty)x(ty)
上式与横截条件式(10-115)比较，证得里卡蒂方程的边界条件式(10-110)成立。 因P(t)  可解，将式(10-116)代入式(10-112),证得u'(t)   表达式(10-107)。
显然，将式(10-107)代入式(10-106),得式(10-111)最优闭环系统方程，其解必为最优轨线 x"(t)。
充分性：若式(10-107)成立，可证u*(t)  必为最优控制。
根据连续动态规划法，可以方便地证明最优控制的充分性及最优性能指标(10-108)成立。其 ·587 ·






证明过程略。
在上述定理的证明过程中，应用了里卡蒂方程解的有关性质，需要加以说明。
(2)里卡蒂方程解的若干性质
在式(10-107)中，令反馈增益矩阵
K(t)=R-¹(t)BT(t)P(t)                                                          (10-120)
则最优控制可表示为
u"(t)=-K(t)x(t)                                                                 (10-121)
将上式代入式(10-106),得最优闭环系统方程
x(t)=[A(t)-B(t)K(t)]x(t),                           x(to)=x₀                                 (10-122)
因为矩阵A(t),B(t)    及R(t)  已知，故闭环系统的性质与K(t)  密切相关，而K(t)  的性质又取 决于里卡蒂方程(10-109)在边界条件(10-110)下的解P(t)。
1)P(t) 是唯一的。矩阵P(t)是里卡蒂方程(10-109)在边界条件(10-110)下的解。而方程(10-
109)实质上是n(n+1)/2     个非线性标量微分方程组，当矩阵A(t),B(t),R(t)         和Q(t)  满足问题
10-2的假设条件时，根据微分方程理论中解的存在性与唯一性定理知，在区间[to,tj]上 ，P(t)唯 一存在。
2)P(t) 是对称的。
命题10-1 若矩阵P(t)  是里卡蒂方程(10-109)及其边界条件(10-110)的唯一解，则
P(t)=PT(t)                                                                  (10-123)
证明 对里卡蒂方程(10-109)及其边界条件(10-110)取转置，可得
-PT(t)=AT(t)PT(t)+PT(t)A(t)-PT(t)B(t)R-T(t)BT(t)PT(t)+Q(t)                                             (10-124)
以及
PT(ts)=FT                                                              (10-125)
因为R(t)=RT(t),Q(t)=Q⁷(t),F=FT,               于是式(10-124)及(10-125)可写为
-PT(t)=PT(t)A(t)+AT(t)PF(t)-PT(t)B(t)R-¹(t)BT(t)PT(t)+Q(t)(10-126)
PT(t;)=F                                                                (10-127) 比较式(10-109)、式(10-110)与式(10-126)、式(10-127)可见，P(t)与 PT(t)是在同一边界条
件下的同一矩阵微分方程的解。因为P(t)是唯一的，故式(10-123)必然成立。 3)P(t) 是非负的。
命题10-2 对于性能指标(10-104),如果在区间[to,t/]上，有F≥0、Q(t)≥0、R(t)>0,则对 于任意的u(t)  和相应的x(t),   总有J[x(t),u(t),t]≥0。
证明 由命题假设，二次型函数
xT(ty)Fx(ts)≥0,      ,        xT(t)Q(t)x(t)≥0,                  ur(t)R(t)u(t)>0
从而，对任意的u(t)  和相应的x(t),   由式(10-104)描述的性能指标，总有 J[x(t),u(t),t]≥0,    Vt∈[to,tf]
命题10-3 若矩阵P(t)  是里卡蒂方程(10-109)及其边界条件(10-110)的唯一解，则
P(t)≥0,     Vt∈[to,tr]                       (10-128)
证明 由命题10-2,对任意的u(t)和相应的     有
J[x(t),u(t),t]≥0,                  Vt∈[to,t]


取 u(


则 由


一的


存在

一般


相应


可见 对初


从而 唯一


初始


式中





取u(t)=u'(t), 命题10-2仍然成立。由定理10-18知，最优性能指标
Vt∈[to,tŋ]
则由二次型函数性质知，命题成立。
(3)最优控制解的存在与唯一性
若问题10-2有最优控制解，该解必满足定理10-18的结论。可以证明，该解是存在且唯 一的。
定理10-19 在定理10-18中，最优控制解
u(t)=-R-¹(t)BT(t)P(t)x(t)
存在且唯一。
证明 先证存在性：因 P(t)存在且唯一，故u'(t)存在。再证唯一性：反设u'(t)不唯一，不失 一般性，令u₁'(t)    和 u₂*(t)   均为最优控制解，则由P(t)  的唯一性可知
u₁"(t)=-R-¹(t)BT(t)P(t)x₁(t) u₂"(t)=-R-¹(t)BT(t)P(t)x₂(t)
相应的闭环系统方程(10-111)为
x₁*(t)=[A(t)-B(t)R-¹(t)BT(t)P(t)]x₁*(t),                                x₁*(to)=x。
i₂*(t)=[A(t)-B(t)R-¹(t)BT(t)P(t)]x₂*(t),                                 x₂*(to)=x。
3)
可见，最优轨线x₁*(t)   和x₂*(t)  是同一向量微分方程且具有同样初始条件下的解。根据微分方程 对初值问题解的唯一性，显然有
x₁*(t)=x₂*(t),                Vt∈[to,tr]
从而必有                  u₁'(t)=u₂*(t),      Vt∈[to,ty]
唯一性得证。
例10-13 设系统状态方程为
i₁(t)=x₂(t),                  i₂(t)=u(t)
初始条件为：x₁(0)=1,x₂(0)=0 。    性能指标

式中ty 为某一给定值。试求最优控制u'(t),     使J=min。 解本例为有限时间状态调节器问题。由题意：
    ,F=0,              
由里卡蒂方程
-P=PA+ATP-Pbr-1bTP+Q,            P(t;)=F
代入相应的A,b,Q,r,F,       并令矩阵
28)

可得下列微分方程组及相应的边界条件：
·589 ·






P₁(t)=-1+Pi₂(t),
P₂(t)=-P₁(t)+Pi₂(t)P₂₂(t),
Pz₂(t)=-2P₁₂(t)+Pi₂(t),


P₁₁(ty)=0
P₁₂(ty)=0
P₂₂(ty)=0

利用计算机逆时间方向求解上述微分方程组，可以得到P(t),t∈[0,tj]。 最优控制
u*(t)=-r-¹bTPx(t)=-P¹₂x₁(t)-P²2z₂(t)
式中P¹₂ 和 P₂2随时间变化曲线如图10-7所示。由于反馈系数P¹₂ 和P₂2 都是时变的，在设计系统 时，需离线算出P¹₂ 和P₂₂ 的值，并存储于计算机内，以便实现控制时调用。
最优控制系统的结构图如图10-8所示。

图10-7 里卡蒂方程解曲线(tr 相当大时)           图10-8 例10-13最优控制系统结构图
对于上述结论及例题求解过程，需要作如下几点说明：
1)最优控制律(10-107)是一个线性状态反馈控制律，便于实现闭环最优控制。
2)里卡蒂方程(10-109)为非线性矩阵微分方程，通常只能采用计算机逆时间方向求数值 解。由于里卡蒂方程与状态及控制变量无关，因而在定常系统情况下，可以离线算出P(t)。
3)只要时间区间[to,tŋ] 是有限的，里卡蒂方程的解P(t)  就是时变的，最优反馈系统将成为 线性时变系统，即使矩阵A,B,Q  和 R 都是常值矩阵，求出的P(t)  仍然是时变的。
3.无限时间定常状态调节器
若系统受扰偏离原零平衡状态后，希望系统能最优地恢复到原平衡状态，不产生稳态误差， 则必须采用无限时间状态调节器；若同时要求最优闭环系统渐近稳定，则应采用无限时间定常状 态调节器，其最优状态反馈矩阵为常阵，可以离线计算，便于实时控制。
(1)问题描述
问题10-3 设线性定常系统状态方程
x(t)=Ax(t)+Bu(t),                      x(0)=xo                                        (10-129)
性能指标
                (10-130) 式中，x(t)∈R”;u(t)∈R",       无约束；A,B,Q   和 R  为维数适当的常值矩阵；权阵Q=QF≥0,R=
R¹>0 。要求确定最优控制u'(t),     使性能指标(10-130)极小。
(2)最优解结果
定理10-20 在问题10-3中，若对于任意矩阵D,有DD⁷=Q,  且 P 是里卡蒂矩阵代数方程
PA+ATP-PBR-¹B'P+Q=0
的解，则阵对{A,D} 完全可观的充分必要条件是P 为对称正定矩阵。





定理10-21 对于问题10-3,若阵对{A,B}完全可控，阵对{A,D} 完全可观，其中       且
D任意，则存在唯一的最优控制
u"(t)=-R-¹BTPx(x)                                                         (10-131)
最优性能指标为
                       (10-132) 式中P 为对称正定常阵，是里卡蒂矩阵代数方程
PA+ATP-PBR-¹BTP+Q=0                                                  (10-133)
的唯一解。
(3)最优闭环系统的渐近稳定性
定理10-22 对于问题10-3,由定理10-21得到的最优闭环系统
x(t)=(A-BR-¹BTP)x(t),                      x(0)=x 。              (10-134)
必定是渐近稳定的。
证 明 取二次型函数
V(x)=xT(t)Px(t)                                                          (10-135)
上式仅当x(t)=0     时，才有V(x)=0;     对于非零x(t),   由 于P  为对称正定常值矩阵，必有V(x)>
0;而且

故式(10-135)表示的V(x) 是一个李雅普诺夫函数。 取式(10-135)对时间t 的导数，得
V(x)=xT(t)Px(t)+xT(t)Px(t)
将式(10-129)及(10-133)代入上式，可得
V(x)=xT(t)[(A-BR-¹BTP)TP+P(A-BR-¹BTP)]x(t)
=-xT(t)(Q+PBR-¹BTP)x(t)                                                                 (10-136)
因Q≥0,R>0,     故有
V(x)≤0


显然，仅在x(t)=xo=0     的原平衡状态时，才有V(x)=0, V(x)=0,   则由式(10-136)知，应有
xT(t)Qx(t)=0
x(t)PBR-¹BTPx(t)=0
将u*(t)=-R-¹B'Px(t)  代入式(10-138),得
u*T(t)Ru*(t)=0


此外V(x)≠0 。 反设对于非零x。有

(10-137) (10-138)

由于R>0,   故应有u'(t)=0,      此时系统(10-129)只有零输入响应
x(t)=exo,     Vxo≠0                       (10-139)
将式(10-139)代入式(10-137),可得
xTe^'DDTex 。=0
式中DD⁷=Q 。 上式表明
·591 ·




DTex 。=0,         Vxo≠0 故DTe"列相关，这与{A,D} 完全可观矛盾，反设不成立。
根据李雅普诺夫稳定性定理，系统(10-134)大范围渐近稳定。 对于以上主要结论，需作如下几点说明：
1)在定理10-21中，对系统(10-129)提出的可控性要求，是为了保证最优解的存在。在有限 时间调节器问题中，对系统并无可控性要求，因为式(10-130)的积分上限ty有限，无论系统可控 与否，性能指标J 不会趋于无穷。但在t→ ○ 时，当不可控状态不稳定，且又包含于性能指标J 之 中时，便会使J→0,    从而使最优解不存在。
例10-14 设系统状态方程及初始条件为
i₁(t)=x₁(t),                             x₁(0)=1
t₂(t)=x₂(t)+u(t),                    x₂(0)=0
性能指标

试求最优控制u"(t)  及最优性能指标J'。
解本例为无限时间定常状态调节器问题。由题意，状态x₁(t)  显然不可控。因为系统矩阵及
状态转移矩阵为

故u
故系统的零输入响应

显然
由
性能指标


联立
因而本例不存在最优解。
2)在定理10-21中，要求阵对{A,D}完全可观，是为了保证最优闭环系统(10-134)渐近稳定 性。如果强化性能指标中权阵2的条件，要求Q=Q⁷>0,  则可去掉{A,D} 可观的要求。至于P 矩 阵的正定性，卡尔曼曾经指出：系统可控的假设和取权阵F=0, 意味着t0   时，P 为正定矩阵。
3)对于无限时间状态调节器，通常在性能指标中不考虑终点指标，取权阵F=0, 其原因有 二：一是希望t○        时，x(t)=0,      即要求稳态误差为零，因而在性能指标中不必加入体现终点指 标的末值项；二是工程上仅考虑系统在有限时间内的响应，因而t          时的终点指标将失去工程 意义。
例10-15 设系统状态方程及初始条件为





i₁(t)=u(t),	x₁(0)=0
i₂(t)=x₁(t),	z₂(0)=1
性能指标	

试求最优控制u'(t)    和最优性能指标J'。
解本例为无限时间状态调节器问题。因




故由题意















,dT=[0



√2]

检验可控性与可观性：

故u'(t)存在且最优闭环系统渐近稳定。 解里卡蒂方程：令

由                          PA+ATP-Pbr-¹bTP+Q=0
得代数方程组
2P¹2-2P²=0
P₂2-2P¹₁P¹2=0 -2P²2+2=0
联立求解，得

求最优解：
u*(t)=-r-bFPx(t)=-2x₁(t)-2x₂(t)

检验闭环系统的稳定性：





2)

=λ²+2λ+2=0
求出特征值为λ₁=- 1+j,d₂=-1-j 。    由特征值判据知，闭环系统渐近稳定。
4.有限时间时变输出调节器
一个工程实际系统，当工作于调节器状态时，总是希望系统一旦受扰偏离原输出平衡状态 时，系统的实际输出能最优地恢复到原输出平衡状态或其邻近，则这样的问题，称为输出调节器 问题。由于输出调节器问题可以转化为等效的状态调节器问题，因此可以把状态调节器的主要结 果方便地转化为输出调节器的最优解。
如果系统是线性时变的，末端时刻tr 是有限的，则这样的输出调节器称为有限时间时变输 出调节器，其最优解由如下定理给出。
定理10-23 设线性时变系统动态方程为式(10-102),性能指标为式(10-105)。其中，x(t)∈
R";u(t)∈R",     无约束；y(t)∈R¹,0<I≤m≤n;         矩阵A(t),B(t)     和C(t)   维数适当，其各元在[to,tr]


上连续且有界；权阵F=FT≥0,Q(t)  =Q⁷(t)≥0,       R(t)=R(t)>0,
界；t;  固定。则存在使J=min    的唯一的最优控制
:u'(t)=-R-¹(t)BT(t)P(t)x(t)
最优性能指标

最优轨线x"(t)   满足下列线性向量微分方程：
x(t)=[A(t)-B(t)R-¹(t)BT(t)P(t)]x(t),
式中，P(t)  为对称非负定矩阵，是里卡蒂矩阵微分方程
-P(t)=P(t)A(t)+AT(t)P(t)-P(t)B(t)R-¹(t)BT(t)P(t)+CT(t)Q(t)C(t)

在边界条件
P(tp)=CT(tr)FC(ty)
下的唯一解。


其各元在[to,t]上连续且有 (10-140)
(10-141)

x(to)=x 。         (10-142)



(10-143) (10-144)

证 明 将输出方程y(t)=C(t)x(t) 代入性能指标(10-105),可得
器 理 色
其中
F₁=CT(t)FC(ty),                Q₁(t)=CT(t)Q(t)C(t)
因F=FT≥0,Q(t)=Q⁷(t)≥0,              故有二次型函数F₁=F{≥0,Q₁(t)=Q{(t)≥0,              而R(t)=RF(t)> 0不变，于是由有限时间时变状态调节器理论中的定理10-18知，本定理的全部结论成立。
对于上述结论，需要说明几点：
1)比较定理10-23与定理10-18可见，有限时间时变输出调节器的最优解与有限时间时变 状态调节器的最优解，具有相同的最优控制与最优性能指标表达式，仅在里卡蒂方程及其边界条 件的形式上有微小差别。





2)最优输出调节器的最优控制函数，并不是输出向量y(t)的线性函数，而仍然是状态向量 x(t) 的线性函数，表明构成最优控制系统，需要全部状态信息反馈。
5.无限时间定常输出调节器
如果末端时刻t→0,     系统及性能指标中的各矩阵均为常矩阵，则可以得到定常的状态反馈


控制律。这样的最优输出调节器，称为无限时间定常输出调节器。 定理10-24 设线性定常系统动态方程
x(t)=Ax(t)+Bu(t),       x(0)=x。
y(t)=Cx(t)
性能指标






(10-145)


(10-146)

式中，x(t)∈R";u(t)∈R",无约束；y(t)∈R',0<I≤m≤n;A,B,          C,Q 和R 为维数适当的常值矩
阵；Q=Q⁷≥0,R=R¹>0。


若阵对{A,B}完全可控，阵对{A,D} 完全可观，其中DD⁷=CTQC,D 标(10-146)极小的唯一最优控制
u*(t)=-R-¹BTPx(t)
最优性能指标

式中P 为对称正定常值矩阵，满足下列里卡蒂矩阵代数方程：
PA+ATP-PBR-¹B'P+CTQC=0
最优闭环系统
x(t)=(A-BR-¹BFP)x(t),                     x(0)=x。
是渐近稳定的，其解为最优轨线x*(t)。
证明 将输出方程y(t)=Cx(t)代入性能指标(10-146),可得


任意，则存在使性能指 (10-147)
(10-148)

(10-149) . (10-150)


式中，Q₁=CTQC 。因 Q=Q⁷≥0,    必有Q₁=Qi≥0,     而R=R⁷>0     仍然成立。
令矩阵Q₁ 的任一分解为Q₁=DD,    因{A,B}可控，{A,D} 可观，故由无限时间定常状态调节 器理论中的定理10-21和定理10-22知，本定理全部结论成立。
例10-16 设系统动态方程
i₁(t)=x₂(t),                t₂(t)=u(t),                y(t)=x₁(t)
性能指标

试构造输出调节器，使性能指标极小。
解本例为无限时间定常输出调节器问题。由题意
,c=[10],q=1,r=1
·595 ·





的唯- 及其主
2

在 初 儿


由 极
确定最优控制：
u*(t)=-r-¹bFPx(t)=-x₁(t)-√2x₂(t)
可得  由 正

由 横 根据j

所以，闭环系统确是渐近稳定的。
在 MATLAB  软件包的控制工具箱中，提供了专门的最优状态调节器的设计命令lqr 和 最 优输出调节器的设计命令lqrg,可以显著减少设计工作量。
6.有限时间时变输出跟踪系统
所谓输出跟踪系统问题，就是要求确定最优控制律，使系统的实际输出y(t),   在给定时间区 间[to,tr]  上尽可能地逼近理想输出z(t),   并使给定的性能指标极小。如果系统是线性时变的，末 端时刻tr是有限的，则为有限时间时变输出跟踪系统问题。
定理10-25 设线性时变系统如式(10-102)所示，性能指标如式(10-103)所示。其中x(t)∈
R”;u(t)∈R",     无约束；y(t)∈R',0<I≤m≤n;           输出误差向量e(t)=z(t)-y(t);z(t)∈R',               为理想
输出向量；矩阵A(t),B(t),C(t),Qt)           和R(t)  维数适当，且在[to,t;]   上连续且有界；权阵F=F≥
0,Qt)=QF(t)≥0,R(t)=RT(t)>0;tr                  固定。则使性能指标(10-103)为极小的最优解为
1)最优控制。
u'(t)=-R-¹(t)BT(t)[P(t)x(t)-g(t)]                                                        (10-151)
式中，P(t)   为n×n   对称非负定实矩阵，是里卡蒂矩阵微分方程
-P(t)=P(t)A(t)+AT(t)P(t)-P(t)B(t)R-¹(t)BT(t)P(t)
+CT(t)Q(t)C(t)                                                                                 (10-152)
及其边界条件
P(ty)=CT(t)FC(tj)                                                           (10-153)





的唯一解；g(t)  为n 维伴随向量，满足向量微分方程
-g(t)=[A(t)-B(t)R-¹(t)BT(t)P(t)]g(t)+CT(t)Q(t)z(t)
及其边界条件
g(t;)=CT(t;)Fz(ty)
2)最优轨线。最优跟踪闭环系统
x(t)=[A(t)-B(t)R-¹(t)B'(t)P(t)]x(t)+B(t)R-¹(t)B'(t)g(t) 在初始条件x(to)=x 。 下的解，为最优轨线x*(t)。
证明 用极小值原理进行证明：构造哈密顿函数

由极值条件，在u(t)  不受约束时，有

可得                         u*(t)=-R-¹(t)BT(t)λ(t)
由正则方程          

由横截条件               λ(ty)=CT(ty)F[C(tp)x(t;)-z(ty)]
根据正则方程为线性方程，以及横截条件中λ(ty)与 x(t)   和 z(ty)  成线性关系，可以假设
λ(t)=P(t)x(t)-g(t)                                                                (10-161)
式 中 ，P(t)  及 与z(t)  有关的g(t)  待定。 对式(10-161)求导，得
λ(t)=P(t)x(t)+P(t)x(t)-g(t)                                                              (10-162)
将式(10-161)代入式(10-158),有
x(t)=[A(t)-B(t)R-¹(t)BT(t)P(t)]x(t)+B(t)R-¹(t)BT(t)g(t) 上式代入式(10-162),整理后得
λ(t)=[P(t)+P(t)A(t)-P(t)B(t)R-¹(t)B⁷(t)P(t)]x(t)
+P(t)B(t)R-¹(t)BT(t)g(t)-g(t)                                                                 (10-163)
同时，将式(10-161)代入协态方程(10-159),得
λ(t)=[-CT(t)Q(t)C(t)-AT(t)P(t)]x(t)+AT(t)g(t)+CT(t)Q(t)z(t)
(10-164)
比较式(10-163)和式(10-164),可得
[P(t)+P(t)A(t)-P(t)B(t)R-¹(t)B⁷(t)P(t)]x(t)+P(t)B(t)R-¹(t)B⁷(t)g(t)-g(t) =[-CT(t)Q(t)C(t)-AT(t)P(t)]x(t)+AT(t)g(t)+CT(t)Q(t)z(t)
上式在t∈[to,t;]的任何时刻，对任何状态x(t)及任何理想输出z(t)均成立，故等式两端对应项 应相等，于是证得式(10-152)和(10-154)成立。
在式(10-161)中，令t=ty,   并与横截条件式(10-160)相比，可知边界条件式(10-153)和(10- ·597 ·





155)成立。
因 为P(t)  及g(t)  均可解，所以将式(10-161)代入式(10-157),证得最优控制表达式(10-151) 成立。
将式(10-151)代入系统状态空间表达式(10-102)中的状态方程，可得最优闭环系统(10- 156)。因系统(10-156)满足极小值原理的必要条件，故其在已知初始条件下的解，必为最优轨线 x'(t)。
对上述定理的结论，有如下说明：
由定理10-25中的伴随方程(10-154)可见，求解伴随向量g(t)  需要理想输出z(t) 的全部信 息，从而使输出跟踪系统最优控制u*(t)  的现在值与理想输出z(t)  的将来值有关。在许多工程实 际问题中，这往往是做不到的。为了便于设计输出跟踪系统，往往假定理想输出z(t)的元为典型 外作用函数，例如单位阶跃、单位斜坡或单位加速度函数等。
最优输出跟踪系统的结构图如图10-9所示。图中，A(t)=A(t)-B(t)R-¹(t)B'(t)·P(t),                    为 闭环系统矩阵。

图10-9 最优输出跟踪系统结构图
7.无限时间定常输出跟踪系统
对于无限时间输出跟踪系统问题，目前还没有严格的一般性求解方法。当理想输出为常值向 量时，无限时间定常输出最优跟踪系统问题，有如下工程上可以应用的近似结果。

定理10-26 设线性定常系统的动态方程为
x(t)=Ax(t)+Bu(t),                      x(0)=x。
y(t)=Cx(t)
式中，x(t)∈R";u(t)∈R",       无约束；y(t)∈R²,0<I≤m≤n;A,B,C 设i∈R '为理想输出常向量，e(t) 为输出误差向量，由
e(t)=i-y(t)
定义性能指标



(10-165) 为维数适当的常值矩阵。
(10-166)

(10-167)
】
式中，权阵Q 和 R 均为对称正定常值矩阵，维数适当。
若阵对{A,B} 完全可控，阵对{A,C} 完全可观，则使性能指标(10-167)极小的近似最优控制
ù(t)=-R-¹BTPx(t)+R-¹Brg
式中，P 为对称正定常阵，满足下列里卡蒂矩阵代数方程：
PA+ATP-PBR-¹BTP+CTQC=0
常值伴随向量





g=[P    BR-¹BT-AT]-CTQi                                   (10-170)
闭环系统方程
x(t)=(A-BR-¹BP)x(t)+BR-¹Bg,x(0)=x₀                                     (10-171)
的解，为近似最优轨线x(t)。
应当指出，定理10-26并没有论证闭环系统的稳定性，因此在实际应用时，需对闭环系统的 渐近稳定性加以检验。
例10- 17 设有一理想化轮船操纵系统，其从激励信号u(t)  到实际航向y(t)  的传递函数为 4/s²,   试设计近似最优激励信号ü"(t),   使性能指标

极小。式中，=1(t) 为理想输出。
解本例为无限时间定常输出跟踪系统问题，可按如下步骤求解：
1)系统状态空间建模。由于传递函数

可得                 i₁(t)=x₂(t),i₂(t)=4u(t),y(t)=x₁(t)
于 是                           c=[10]
检验                         
2)检验可控性与可观性。性能指标又可表示为
句


;)



i)
故{A,b} 可控，{A,c} 可观。
3)解里卡蒂方程。令
,由式(10-169)得
-8P¹2²+2=0
P-8P¹₂P₂2=0   2P¹2-8P₂2²=0
联立解出
))

·599 ·







4)求伴随常向量。

5)确定近似最优控制。
ü"(t)=-r-bTPx(t)+r-1bTg

6)检验闭环输出跟踪系统的稳定性。闭环系统的系统矩阵为

特征方程                det(A-A)=λ²+2√2λ+4=0
解得特征值         λ₁=-√2+j√2,A₂=-√2-j√2 故闭环输出跟踪系统渐近稳定。














第 程；第. 策过程 三级决
动 的级娄 下一点 于图1
1

将 E(   写相应

10-5   动  态  规  划

动态规划法是美国学者贝尔曼于1957年提出来的，它与极小值原理一样，是处理控制变量 有有界闭集约束时，确定最优控制解的有效数学方法。
从本质上讲，动态规划是一种非线性规划，其核心是贝尔曼的最优性原理。这个最优性原理 可归结为一个基本递推关系式，从而使决策过程连续地转移，可将一个多级决策过程化为多个单 级决策过程，使求解简化。利用动态规划求解控制有约束的最优控制问题特别方便，但也受到维 数问题的限制，其应用有一定的局限性。
1.多级决策问题
所谓多级决策问题，是指把一个多级决策过程分成若干阶段，要求对每一阶段都作出决策， 以使整个过程取得最优结果。通过多级决策问题的讨论，可以掌握动态规划的基本思想和方法。 最短路线问题，是多级决策问题的一个典型方面。
(1)最短路线问题
设由A 至 F 的路线如图10-10所示，要求从A 地出发，选择一条最短路线到达F 地，其间要 通过中间站B,C,D   和 E,  而每个中间站又有若干可供选择的通过点，各地之间的距离已标注在 图中。由图可见，通过这些中间站时，有多个方案可供选择。现将整个过程分成若干级，逐级进行 决策，具体过程如下。
·   ·







图10-10 路线问题
第一级由A 到 B(B₁,B₂,B₃),       要求选择一条路线，使AB  之间路程最短，称为一级决策过 程；第二级由B(B₁,B₂,B₃)     到 C(C₁,C₂,C₃),       要求选择一条路线，使ABC 路程最短，称为二级决 策过程；第三级由C(C₁,C₂,C₃)     到 D(D₁,D₂,D₃),       要求选择一条路线，使ABCD  路程最短，称为 三级决策过程；以此类推，共有五级决策过程。
动态规划法是一种逆序计算法，从末端开始，到始端为止，逆向递推。设N 为多级决策过程 的级数；x 表示在任一级所处的位置，称为状态变量；SN(x) 为决策变量，表示状态x 后所选取的 下一点；Jn(x)   表示从状态x  到终点F 的最短距离；d(x,Sn)    表示从x 点 到SN 点之间的距离。对 于图10-10路线问题，从最后一级开始计算。
1)E   级 。
J₁(E)=1,                J₁(E₂)=2
将E(E₁,E₂)     至F 的距离数字标注于图10-11,数字用圆圈圈起，表示本级指标，数字旁括号内填 写相应的决策变量。由于从E₁ 到 F 及 从E₂  到 F 都只有一种可能，所以本级无决策问题。


变量

原理 个单 到维



图10-11 决策过程
2)D  级。本级决策有三种选择。每种选择又有两条可能的路线。 若从D₁ 出发，可达E₁,  也可达E₂,  所以

说明D₁ 至 F  的最短距离为4,路线为D₁E₂F,   决策变量为S₂(D₁)=E₂ 。  因而在图10-11中的D₁
点处，标注④(E₂)。
·601 ·






若从D₂ 出发，有

说明D₂ 至F 的最短距离为7,路线为D₂E₁F,  决策变量S₂(D₂)=E₁ 。 因而在图10-11中的D₂ 点
处，标注⑦(E₁)。
若从D₃ 出发，有

说 明D₃ 至F  的最短距离为7,路线为D₃E₂F,  决策变量为S₂(D₃)=E₂ 。  因而，在图10-11的D₃
处，标注⑦(E₂)。
3)C  级。本级有三种选择，计算过程如下：

S₃(C₁)=D₁







决  策

J'=



以及


不但 -1
后进


把其

S₃(C₂)=D₂
那么 最优

S₃(C₃)=D₁                                                                                                                        是所

于是，可将⑤(D₁),①(D₂),⑧(D₁)     分别标注在图10-11的C₁,C₂  和C₃ 处 。 4)B  级。本级有三种选择，计算过程如下：

S₄(B₁)=C₁

S₄(B₂)=C₁

S₄(B₃)=C₂
将上述结果相应标注在图10-11之中。
5)A  级。本级决策是唯一的，计算结果为


t ∈[

决策


推方


式中 闭子



假定 u(N






决策变量
2 点
S₅(A)=B₂
最后，在图10-11中，从A  开始可顺序确定最短路线为AB₂C₁D₁E₂F,   最 短 距 离 J'=J₅(A)=14。
在用动态规划求解最短路线问题时，采用的递推方程的一般形式为
             (10-172) 以及
J₁(x)=d(x,F)                                                             (10-173)
在动态规划中，式(10-172)和(10-173)称为函数方程。当选择第一个决策Sn(x)  时，其结果 不但影响第一级的距离d[x,Sn(x)],      而且影响后面N-1    级的初始状态，因而也会影响后面N  -1级的最短距离。因此，最优策略(各阶段的决策组成的最佳集合)的选择，应在递推过程结束 后进行，不能在各级分散确定。这种递推思想的核心，是贝尔曼提出的最优性原理。
(2)最优性原理
贝尔曼指出，多级决策过程的最优策略具有这样的性质：不论初始状态和初始决策如何，当 把其中的任何一级和状态再作为初始级和初始状态时，其余的决策对此必定也是一个最优策略。
具体说，若有一个初态为x(0)的N 级决策过程，其最优策略为{u(0),u(1),…,u(N-1)},
那么,对于以x(1)  为初态的N-1    级决策过程来说，决策集合{u(1),u(2),…,u(N-1)}           必定是
最优策略。
对于连续系统，最优性原理可以表述为：若对于初始时刻to 和初始状态x(to),u'(t)     和x*(t)   是所论系统的最优控制和最优轨线，则对于时刻t₁ (t₁>to)和相应状态x(t₁),u*(t)和x*(t),其中 t∈[tr,tj],仍是所论系统的最优控制和最优轨线。
最优性原理为求解多级决策过程的寻优问题提供了简便而有效的方法，可将一个多级最优 决策问题化为多个单级决策问题来处理，并为导出递推方程提供了理论依据。
(3)动态规划的基本递推方程
动态规划的基本递推方程，又称递推函数方程。式(10-172)和(10-173)正是动态规划基本递 推方程的一个特例。设动态规划问题如下。
问题10-4 设 N 级决策过程的动态方程为
x(k+1)=f[x(k),u(k),k],                       x(0)=x 。               (10-174)
式中，状态约束x(k)∈XCR";    控制(决策)约束u(k)∈ΩCR",k=0,1,…,N-1;X             与Ω为有界
闭子集；f(·)∈R"。
代价函数(性能指标)为
(10-175)
假定：f( ·) 和 L( ·) 连 续 ，L( ·) 正有界。求最优控制序列(最优策略){u(0),u(1),…, u(N-1)},    使代价函数(10-175)极小。
·603 ·





在问题10-4中，k 表示N 级决策过程中的阶段变量，x(k) 表示第k+1   级的初始状态，u(k) 表示第k+1  级所采用的控制(决策)向量。问题中的假设，是为了保证最优策略存在。
一般情况下，将始自x(0)  的最小代价表示为J'[x(0),0],       同理，将始自x(k)   的最小代价表 示为J'[x(k),k],       其目的是强调J(·)     对初始时刻的依赖。根据动态规划的基本思想，把确定始 于x(0)的最小代价J'[x(0),0] 的问题，嵌入到确定始于x(k)的最小代价J'[x(k),k] 问题之 中，以便将多级决策过程化为多个单级决策过程。
研究如下问题：设有N-k   级决策过程
                    (10-176) s.t.x(j+1)=f[x(j),u(j),j],x(k)=x                                                         (10-177)
(j=k,k+1,…,N-1)
式中，u={u(k),u(k+1),…,u(N-1)},              假设同问题10-4。则始自第k 级任一容许状态x(k) 的最
小代价


                       (10-178)
在式(10-178)中，其右端第一项是第k 级所付出的代价；第二项是从第k+1  级到第N 级的 代价和。因此，可将式中求极小的运算也分解为两部分：在本级决策u(k)作用下求极小，以及在 剩余决策序列{u(k+1),…,u(N-1)}         作用下求极小。于是，式(10-178)可写为
根 据 所以
由于：
根据最优性原理，如下关系式成立：
求得 将 上

(k=0,1,…,N-1)                                  (10-180) 利用动态规划基本递推方程(10-180)求解问题10-4时，从过程的最后一级开始，逐级逆向
递推：首先，令k=N-1,   则由式(10-180)得
解得
+J*[x(N),N]}                                                         (10-181)
式中，J'[x(N),N]       表示代价函数J  中的末值项。对于问题10-4,代价函数中无末值项，应取
J'[x(N),N]=0,         故式(10-181)可写为





:(k)
上式为单级最优决策问题，易于求解。
介表 定始 烫之
+J'[x(N-1),N-1]}
式中，J'[x(N-1),N-1]               已由式(10-182)确定，因此上式也是一个单级最优决策问题，易于求
解。以下类推。
根据式(10-180),逆向逐级递推，最后可得J'[x(0),0] 。   这最后一步递推解及最优策略{u    (0),u'(1),…,u'(N-1))               正是问题10-4要求的最优解。就这样，利用递推方程(10-180),把一 个多级最优决策过程化成了多个单级最优决策过程。
例10-18 已知离散系统方程
x(k+1)=2x(k)+u(k),                         x(0)=1
代价函数

式中，状态x(k)  及控制u(k)  均不受约束。试求最优控制序列{u·(0),u'(1),u*(2)},            使代价函数
极小。
解 本 例 为N=3    级最优决策问题。根据递推方程(10-180),按如下步骤逆向递推：
1 ) 令k=2。

根据代价函数的末值项及系统方程，有
J₀"[x(3)]=x²(3)=[2x(2)+u(2)]²
所以

179)

求得
u"(2)=-x(2)
将上述结果代入J'[x(2)], 易得
J₁'[x(2)]=3x²(2)
2 ) 令k=1。




解得


3 ) 令k=0。







J₂'[x(1)]=4x²(1)






·605 ·






求

代入已知的x(0)=1,    按正向顺序求出

求


于是，本例的最优控制，最优轨线及最优代价分别为 u*(k)=(-1.6,-0.6,-0.2} x'(k)=(1,0.4,0.2,0.2}   J'=4.2
由上例可见，用动态规划解题要进行两次搜索：第一次搜索逆向进行，即用第k+1 级的最小 代价J'[x(k+1)], 根据基本递推方程(10-180)去计算第k 级最小代价J'[x(k)];第二次搜索正 向进行，应用第一次搜索得到的决策函数u*[x(k)],根据系统方程x(k+1)=f[x(k),u(k),k] 正 向迭代，求出最优决策序列及最优轨线。
2.离散动态规划
采用离散动态规划方法，可以方便地求解控制变量与状态变量均有约束时离散系统的最优 控制问题。
(1)离散最优控制问题的动态规划解
问题10-5 设非线性离散系统的状态差分方程
x(k+1)=f[x(k),u(k),k],                      x(0)=x₀                                  (10-183)
式中，x(k)∈XCR”,u(k)∈2CR",k=0,1,…,N-1。 代价函数
(10-184)
假设同问题10-4。要求最优控制序列u'(k),k=0,1,…,N-1,            使代价函数(10-184)最小。
在上述问题中，代价函数是复合型的，比问题10-4更一般。根据动态规划的基本递推方程， 可按如下步骤求解：
1)求第N 级最优控制u*(N-1)。

s.t.x(N)=f[x(N-1),u(N-1),N-1]
求得
u'[x(N-1)],                 Ji[x(N-1)]
2)求第N-1   级最优控制u'(N-2)。

























最小 索正 ] 正


最优



183)



184)

r 程，







s.t.x(N-1)=f[x(N-2),u(N-2),N-2] 求得
u·[x(N-2)],                Ji[x(N-2)]
3)求第k+1  级最优控制u'(k)。

s.t.x(k+1)=f[x(k),u(k),k]
求得
u'[x(k)],            JN-[x(k)]

N-1)    求第2级最优控制u*(1)。

s.t.x(2)=f[x(1),u(1),1]
求得
u'[x(1)],            JN-1[x(1)]
N) 求第1级最优控制u*(0)。

s.t.x(1)=f[x(0),u(0),0]
求得                     u(0)=u*[x(0)],      JM[x(0)]
最后，由已知的x(0),顺序求出u*(0),x*(1),u*(1),x'(2),u*(2),…,x*(N-1),u'(N-1)。 例10-19 设离散系统方程
x(k+1)=x(k)+u(k),                        (4)=2
代价函数

式中，u(k) 限取+1或-1,各级代价要求非负。试求最优控制序列u*(k)  和最优轨线序列x*(k), k=0,1,2,3。
解 本 例 为N=4   级最优控制问题，可用离散动态规划求解。 1 ) 令k=3。
x(4)=x(3)+u(3)=2,                       x(3)=2-u(3)


故有           u"(3)=1,             x"(3)=2-u(3)=1,                          J"(3)=3
2 ) 令k=2。
x(3)=x(2)+u(2)=1,                       x(2)=1-u(2)

·607 ·







故有            u*(2)=1,              x'(2)=1-u*(2)=0,                           J'(2)=3
3)令k=1。
x(2)=x(1)+u(1)=0,                         x(1)=-u(1)


故有                 u'(1)=1,      x'(1)=-1,       J'(1)=0
4 ) 令k=0。
x(1)=x(0)+u(0)=-1,                           x(0)=-1-u(0)



故有
u*(0)=-1,         ,       x*(0)=0,               J'(0)=0
最优解结果归纳如下：
u*(k)={-1,1,1,1},x*(k)={0,-1,0,1,2}
(2)离散动态规划的应用
离散动态规划除可求解动态系统的优化问题外，也可用来求解静态优化问题。所谓静态优化  问题，就是其变量与时间无关的优化问题，此类问题除可用线性规划法或非线性规划法求解外， 还可采用动态规划法求解。求解过程中采用的方法，仍然是动态规划的基本递推方程。
最优分配问题是静态优化问题的一个重要方面。例如，并联电路的电流最优分配，并联电机 的功率最优分配，串联部件之间可靠性的最优分配等，都属于最优分配问题。这里，仅讨论应用离 散动态规划，对发电厂的并联发电机组进行经济负荷的最优分配。
在电力系统运行中，电厂发电机组之间的经济负荷分配是一个重要问题。设有n 台并联发电 机组，当第k 台机组出力(即输出功率)为x   时，单位时间的燃料费用。设L 为用户所需 的负荷，求各机组的负荷分配，使单位时间总运行费用最省。
这种最优分配问题的数学模型为


②xi≥0;              i=1,2,…,n 应用动态规划求解时，其递推方程为
Ji=f₁(x₁)




的发 1,2
的运
x²,

或  会传















令

求得

故有






求得




最小






例10-20 设一简化电站由三台满足给定要求 的发电机组组成，如图10-12所示。图中，机组i(i=     1,2,3)的出力为xi; 在1个单位时间增量里，机组i  的运行费用为f;(xi),其 中,f₂(x₂)=

图10-12 电站经济负荷分配
设机组1在所有时间内连续运转，机组2和3
或投入运行，或不接通，但机组2总在机组3之前开动。已知需要的电量为D, 且 D 的需要量不 会使任一机组超过其极限容量。试用动态规划法求解该供电系统的经济负荷分配：
1)机组1单独运行时的最小运行费用J₁"(D);
2)机组1和2联合运行时的最小运行费用J₂*(D);
3)机组1,2,3联合运行时的最小运行费用J₃"(D)。 解 显 然 有
T₁+x₂+x₃=D
1)机组1单独运行时

2)机组1和2联合运行时
z₁+x₂=D

化  外 ,

机 离
故有
3)机组1,2,3联合运行时


求得


最小运行费用






3.连续动态规划
动态规划方法也可用来求解连续系统的最优化问题，得到动态规划的连续形式。
(1)连续系统的最优控制问题
问题10-6 设连续系统的状态方程为
x(t)=f[x(t),u(t),t],                        x(t₀)=x 。                  (10-185)
性能指标
             (10-186)
式中，x(t)∈R”;u(t)∈2CR",2           为有界闭集；f(·)∈R";      在[Lo,]    上 ，f(·),φ(·),L(·)                 连 续
令a
且可微；并假定以t 为初始时刻，t∈[to,tj],x(t)为初始状态时，函数J(x,t) 连续，且对x(t)和t 有连续的一阶和二阶偏导数。要求在容许控制域2中，确定最优控制u*(t),   使性能指标(10-186) 极小。
为了求得上述控制有约束的最优解，除可采用极小值原理外，还可采用连续动态规划求解， 其数学基础为哈密顿-雅可比方程。
(2)哈密顿-雅可比方程
为了使讨论的问题具有一般性，采用J(x,t)作为问题10-6的性能指标。只要确定J*(x,t)及 相应的u*(t)和x'(t),则问题10-6对应于to和x(to)的最优解也随之而定。
设在区间[t,t;]上，控制函数u[t,tr]存在，若暂不考虑控制约束，则最优指标为

假定可将[t,tr]   最优过程分成两步：从t  到 t+△t,  以及从t+△t  到 ty, 其中△t→0。于是有
一 般
与u[t+△t,t}] 无关，且由最优性原理

故有
(10-187)
上式右端中第一项，根据积分中值定理得
)  (10-188)
右端第二项可展开成如下泰勒级数：

(10-189)
于是
式中O(△t²) 表示关于△t 的高阶小量。
将式(10-188)和(10-189)代入式(10-187),经相消和移项后，得








令△→0,得哈密顿-雅可比方程第一种形式

这是一种泛函与偏微分方程的混合形式，求解不便。 当控制向量u(t)  不受约束时，构造哈密顿函数

令aH/au=0,       可得最优控制的隐含形式

将式(10-192)代入式(10-190),有








(10-190)



(10-191)


(10-192)


这是一阶偏微分方程，其边界条件可由性能指标(10-186)求出
J'[x(ty),tŋ]=9[x(ty),tf]                                                         (10-194)
从而，式(10-193)和(10-194)构成了哈密顿-雅可比方程的第2种形式。
(3)连续动态规划的基本方程
当控制有约束时，u(t)∈Ω,   由哈密顿-雅可比方程(10-190),得连续动态规划的基本方程



一般说，上式是用动态规划求问题10-6最优解的充分条件。
若将式(10-191)代入式(10-195),则最优解的充分条件还可表示为

利用式(10-196)求问题10-6的最优解，可按如下步骤进行：
1)求最优控制的隐式解。当u(t)∈2   时，在Ω中遍取u(t),     使得

求出
当u(t)无约束时，则由aH/au=0,   求出上述隐式解。
2)求最优性能指标。将 代入哈密顿函数(10-191),得

于是，最优指标为如下一阶偏微方程



(10-195)



(10-196)















(10-197)




及其边界条件
J'[x(ty),ty]=4[x(tp),t}]
的解。
3)求最优控制的显式解。由求得的J'(x,t),      计算 ,得最优控制显 式解u(x,t)。
4)求最优轨线。将求得的u'(x,t)     代入状态方程(10-185),得闭环最优系统，其解为最优轨 线x*(t)。
应当指出，除了线性二次型问题，偏微方程(10-197)的求解异常困难。对于线性二次型问题，
可令最优指标为

联 立
将上式代入(10-197),可得P(t)  满足的里卡蒂方程，从而求得u*(x)  和J' 。 对于无限时间定常线
性二次型问题，最优指标J '不显含t,故可令 例10-21 设线性定常系统
x(t)=Ax(t)+bu(t),                      x(0)=x。
性能指标
令t=

式中，手                             事                                                 试用连续动态规划方法确定使性能
指标为极小的最优控制u*(t),   最优指标J  '和最优轨线x'(t)。
解本例为无限时间定常状态调节器，采用连续动态规划求解时，可按如下步骤进行。
1 ) 求 隐式解。令
其中  闭环系
故                              
2 ) 求J'[x(t)] 。   将求得的 代入哈密顿函数，有

由于本例为线性定常二次型问题，故可设

工
是一秆 伍





在上式中，代入,可得

该式对所有非零x(t)  均成立，故有
PA+ATP-Pbr-¹bTP+Q=0
,并代入有关A,b,Q,r,   得如下代数方程组：
-2P²2+2=0
P₁-2P¹₂P₂2=0 2P¹2-2P₂=0
联立求解后得

于是，最优指标

令t=0, 代入已知的x₁ (0)=1,xz(0)=0,  得
J'[x(0)]=1
3 ) 求u"(t)  显式解。
u*(t)=-r-bTPx(t)=-2x₁(t)-2x₂(t) 表明最优控制具有状态线性反馈的形式。
4)求x(t)。 将 u"(t)=-r-1bTPx(t) 代入状态方程，得闭环系统方程为 x(t)=Ax(t)

其  中
闭环系统的状态转移矩阵

对于状态调节器，最优闭环系统的零输入响应就是系统的最优轨线，故有


10-6   控制系统优化设计

工程系统的优化设计方法有多种，除线性二次型优化及动态规划法以外，ITAE 优化方法也 是一种常用的方法。
例10-22 PID 控制系统的优化设计





在优化控制系统设计中，一种合适的性能指标是时间与绝对误差的乘积积分，称为ITAE  性 能指标，表示如下：
                       (10-198)
选择ITAE 指标，是为了减小较大的初始误差对性能指标取值的影响，同时也是为了强调最近的 响应的影响。
当所选的性能指标达到极小值时，控制系统称为是最优的。如果稳定系统的闭环传递函数具 有如下的一般形式：
            (10-199)
式中ao=bo, 则可以确定更(s)的最优系数，使系统对阶跃响应的ITAE 性能指标极小。式 (10-199)传递函数有n 个极点，没有零点，而且系统对阶跃响应的稳态误差为零。
在高阶线性系统中，ITAE 最优性能指标的几何意义是误差的广义面积极小，它也是多维相 空间曲面上的一个极值，它的维数就是该方程所描述系统的状态数。显然，用解析法很难得到该 极值，因此一般采用实验的方法来确定Φ(s) 的最优系数。
为了减少计算的复杂程度，不妨可以采用标准化微分方程形式，这样可以把n 维空间降低为
n-1 维。例如，对于标准化时间wnt,标准二阶系统只取决 于参数β=25,标准三阶系统 就只取决于β和β2两个系数，以此类
推。这里仅以三阶标准化微分方程所描述的系统在单位阶跃输入作用下的ITAE 最优系数的确 定方法为例，说明其基本实验原理。
不妨取w=1,   则标准三阶系统的微分方程为
y+β₂y+β₁y+y=1
写成可控标准型形式


其对应的状态变量图如图10-13中虚框所示。
建立ITAE 最优性能指标


需要从图10-13中引出误差信号e(t) 。显 然
e(t)=1-y(t)=y+β₂y+β₁y
将e(t) 取绝对值后与和t 一起输入乘法器，相乘结果累加就可得到ITAE  积分泛函值J,  如图10- 13所示。
在实验中，每当给定一系数β₂=const  (或β₁)后，每次再改变另一系数β₁ (或β2),就可以得






图10-13 标准三阶系统可控标准型状态变量图及其ITAE 指标实现
到一个相应的J=f(β₁,β₂) 值.将这些./值连成光滑曲线.可以得到图10-14所示的曲线簇。这 些曲线簇实际上是J-β₁-β2 三维空间中同一个曲面在不同β₂=const 值下的切面。给定不同的 β2值可得到不同的曲线簇。再根据这些切面的曲面簇可以得到它在J-β₁-β₂   三维空间中的曲 面；如图10-15所示，它的最佳系数就落在曲面的最底部。对于标准三阶系统，当β₁=2.15,β₂=





图10-14 标准三阶系统满足ITAE 最优指标的切面曲线簇



图10-15 标准三阶系统满足ITAE 最优指标的曲线

而对于三阶以上的高阶系统，其实验原理基本一致，只是确定最佳系数的曲面为一超曲面。 对阶跃响应的基于ITAE 指标的最优系数，如表10-4所示。
当系统Φ(s) 具有表10-4所示的最优系数时，系统的阶跃响应如图10-16所示，其中时间尺 度为标准化时间wnt。
对于斜坡输入，当闭环稳定系统传递函数具有如下标准形式：
(10-200)





式中，ao=bo,a₁=b₁,   则可由表10-5确定使ITAE 指标极小化的最优系数。式(10-200)传递函数 对斜坡输入的稳态误差为零。显然，系统相应的开环传递函数G(s)应至少有2个纯积分环节。
表10-4 对阶跃响应而言，基于ITAE 指标的Φ(s)的最优系数
s+wn
s²+1.4wns+ 咯
s³+1.75w,s²+2.15w²s+}
s⁴+2.1wns³+3.4m2s²+2.7w}s+%
s⁵+2.8wns⁴+5.0w2s³+5.5w³s²+3.4as+w
s⁶+3.25wns⁵+6.60w²s⁴+8.60w}s³+7.45wAs²+3.95aks+婚


标准化时间
图10-16 传递函数具有标准形式且取最优系数时，系统关于标准化时间wt 的单位阶跃响应 表10-5 对斜坡输入而言，基于ITAE 指标的φ(s)的最优系数
s²+3.2n₅+?
s³+1.75wns²+3.25a}s+a}
s⁴+2.41ans³+4.932s²+5.14w}s+f
s⁵+2.19ans⁴+6.50w2s³+6.30a}s²+5.24w4s+5








的要












当G 误差


再由





知
现要
PID



闭环


当采



采用ITAE  性能指标，以及表10-4或表10-5给出的最优系数，可以确定常用的PID 控制器
(10-201)
的参数K₁,K₂   和K₃,  使系统的ITAE  性能指标达到最小，且对阶跃输入或斜坡输入的动态响应 极好。采用ITAE  方法时，PID 控制器的设计过程可以归纳如下：
1)根据对调节时间的要求，确定闭环系统的自然频率wn。
2)根据选定的闭环最优系数(参见表10-4或表10-5)以及上一步给出的wa, 确定PID 控制 器式(10-201)的三个参数K₁,K₂   和 K₃, 从而得到G.(s)。


为了


将上



可得





3)确定合适的前置滤波器G,(s),   使得闭环传递函数的零点符合式(10-199)或式(10-200) 的要求。
N(s)

U(s)     + +


图10-17 带有期望输入R(s)和扰动输入N(s) 的反馈控制系统 设控制系统如图10-17所示，其中被控对象的传递函数为

当G(s)=1  时，系统为0型系统，静态位置误差系数K,=40, 在单位阶跃函数作用下，其稳态
误差

再由相应的闭环传递函数

知 ，w=6.4,5=0.156,     因而超调量及调节时间(△=2%)分别为
0%=100e-/~1-%=60.9%,
现要求系统的阶跃响应具有最优的ITAE  性能，且调节时间(△=2%)小于0.8s, 试设计最优 PID 控制器G₄(s) 及前置滤波器Gp(s)。
解 令 G,(s)  =1, 由于

闭环传递函数为

当采用ITAE  指标时，由表10-4可知，最优特征多项式为  D'(s)=s³+1.75wns²+2.15w²s+w³
为了满足调节时间的设计要求，需要选取wn的合适值。由于t₂=4.4/Sw.≤0.8,可选w=10,  则
最优特征多项式为
D'(s)=s³+17.5s²+215s+1000 将上式与式(10-202)的分母多项式相比，应有
2+40K₃=17.5  1+40K₁=215  40K₂=1000
可得，K₁=5.35,K₂=25,K₃=0.3875 。    于是，式(10-202)可以写成
·617 ·






此时，系统性能如表10-6所示，其阶跃响应的超调量高达34%。系统在单位阶跃输入及单位阶
跃扰动作用下的时间响应，分别如图10-18(a)、(b)所示。


表10-6 系统性能

控制器 系统性能	
G. (s)=1	PID和 G₂ (s)=1	带前置滤波器
Gp(s)的PID
超调址	60.9%	34%	1.9%
调节时间/s	4.2	0.62	0.75
稳态误差	2.4%	0.0%	0.0%
|y. (t) |max	1.57%	0.165	0.165





S

1
(a)





1
(b)
图10-18 G,(s)=1    时系统的时间响应(MATLAB)


为了进一步改善系统性能，在系统输入端接入前置滤波器G,(s),    使系统闭环传递函数具有 式(10-199)的形式，从而具有预期的最优ITAE   指标。引入G,(s)   后，系统的闭环传递函数应变为

由此求得

表10-6中的第四列给出了这时系统的阶跃响应指标。由表可见，经过优化后的系统，只有1.9% 的超调量，调节时间小于0.8s,稳态误差为零。此外，由单位阶跃扰动N(s)=1/s  引起的最大输 出为0.165。有前置滤波器时，系统的时间响应如图10-19所示。仿真结果表明，本例的设计结果 是较为满意的。
MATLAB   文本：
K1=5.35;K2=25;K3=0.3875; G0=zpk([],[-1-1],40);
Gc=tf([K3    K1    K2],[10]); Gp=tf([64.5],[113.864.5]);
sys0=feedback(Gc*G0,1);
sysn=feedback(G0,Gc); sys=series(sys0,Gp);
figure(1)
subplot(2,1,1);step(sys0);grid; subplot(2,1,2);step(sysn);
axis([0,1.2,0,1.5]);grid;		





其参 系统




则相





根振


可初






figure(2)
subplot(2.1.1);step(sys);grid;                    %绘制带前置滤波器的单位阶跃输入响应曲线
subplot(2,1,2);step(sysn):                         %绘制带前置滤波器的单位阶跃扰动响应曲线
axis([0.0.8,0,1.5]);grid;







1
(a)

(b)
图10-19 带G,(s)时系统的时间响应(MATLAB) 例10-23 鲁棒最优系统设计
设控制系统如图10-17所示，其中被控对象的传递函数为

其参数变化范围为：0.5≤T≤1,1≤K≤2 。   要求设计一个带前置滤波器的ITAE  最优鲁棒控制
系统，使得在给定的参数变化范围内，系统的阶跃响应性能始终保持o%<4%,t₁<2s(△=2%)。
解令前置滤波器G,(s)=1,     取 T=1   和 K=1    为标称值，设计ITAE  最优系统。
采用PID 控制器

则相应闭环系统

由表10-4知，最优特征多项式为
D*(s)=s³+1.75w,s²+2.15w²s+w³
根据对系统阶跃响应的调节时间要求

可初选w=8,    相 应s>0.28,     则最优特征多项式为
D*(s)=s³+14s²+137.6s+512





与Φ₂(s) 的分母多项式相比，根据对应项系数相等，可求得PID 控制器参数为 K₃=12,             K₁=136.6,              K₂=512
于是
故前置滤波器应取为

由此得ITAE  意义下的最优闭环传递函数

系统的阶跃响应性能如表10-7中第二列所示：0%=2%,t₂=0.94s,    表明标称系统的性能满足
设计指标要求，w=8   的选择是合适的。
表10-7 例10-23的设计结果(w,=8)

对象条件 动态性能	T=1 K=1	T=0.5 K=1	T=1 K=2	T=0.5 K=2
超调量	2%	0%	0%	0.4%
调节时间/s	0.94	0.65	0.63	0.66
为了考察系统对参数变化的鲁棒性，保持G.(s) 和Gp(s) 不变，分别取T=0.5,K=1;T=1,
K=2   以 及T=0.5,K=2,        测得系统的阶跃响应性能，如表10-7中第三至第五列所示。由表可以  看出，这是一个鲁棒性很强的系统。系统参数变化时的系统时间响应如图10-20～图10-23所示。

丨
图10-21 T=0.5,K=1     时系统的时间响应
(MATLAB)
MALTAB 文本：
K=2;T=0.5;K3=12;K1=136.6;K2=512;
G0=tf(K,[T^2,2*T,1]);                          %定义开环传递函数
Gc=tf([K3,K1,K2],[0,1,0]);                  %定义PID控制器传递函数






Time/sec
满足
图10-22 T=1,K=2     时系统的时间响应
(MATLAB)
G=series(G0,Gc);
Gp=tf(42.67,[1,11.38,42.67]); sys0=feedback(G,1);
sys=series(sys0,Gp);                              %带前置滤波器的闭环传递函数
step(sys);axis([0,1,0,1.3]);grid;
需要指出，实际的被控对象不容许有过大的输入量，因而图10-17系统中控制器G₄ (s)的输 出u(t)有最大允许值的限制，这样，系统自然频率w。的可选值将会受到约束。通常，当e(t)的最 大值为1时，u(t)  的数值将不得大于100。为了说明u(t)  对wn的影响，以图10-17系统为例，并假设

在进行ITAE  最优设计时，可参考表10-8中给出的w。分别取10,20和40时的PID  控制器参 数、前置滤波器和最优闭环传递函数。
表10-8 不同w, 下的设计结果

Wn	PID	Gp(s)	Φ(s)
	K₃	K1	K₂		
10	16.5	215	1000		³+17.5s²+2155+1000
20	34	860	8000		
40	69	3440	64000		
根据表10-8中给出的结果，表10-9给出 了w, 分别等于10,20和40时允许的u(t)  最大 值。从中可以推知，如果u(t)的最大允许值为 100,系统自然频率wn就不能大于16。显然，限 制wa的取值范围，也就限制了系统能达到的最 小调节时间。
·621 ·




当取w=10   时，系统的单位阶跃响应y(t)   及被控对象输入响应u(t)  分别如图10-24及 图10-25所示。

Time/sec
图10-25 被控对象输入响应(w=10)
(MATLAB)
MATLAB 文本： G0=tf(1,[1,1,0]);
Gc=tf([16.5,215,1000],[0,1,0]); Gp=tf(60.6,[1,13.03,60.6]);
sysl=tf(1000,[1,17.5,215,1000]); sys2=Gc*Gp/(1+Gc*G0);
figure(1)
step(sys1);
axis([0,1,0,1.4]); grid;
figure(2)
step(sys2); grid;

习     题

10-1 求通过x(0)=1,x(1)=2,  使下列性能指标为极值的曲线x'(t):

10-2 设x=x(t   ),0≤t≤1,求从x(0)=0 到x(1)=1 间的最短曲线。 10-3 求性能指标

在边界条件x(0)=0,x(1)      是自由情况下的极值曲线。
10-4    求性能指标






及












2



在边界条件x₁(0)=x₂(0)=0,         下的极值曲线。
10-5 已知性能指标函数为

试求：(1)8J 的表达式；
(2)当x(t)=t²,ox=0.1t 和 δx=0.2t 时的变分8J 的值。 10-6 试求下列性能指标的变分 δJ

10-7  已知性能指标为

求J 在约束条件t²+x²=R²  和边界条件x₁ (0)=-R,x₂(0)=0;x₁ (R)=0,x₂ (R)=π        下的极值。
10-8  已知系统的状态方程为
i₁(t)=x₂(t),                 i₂(t)=u(t)
边界条件为x₁ (0)= x₂(0)=1,x₁(3)=x         ₂ (3)=0, 试求使性能指标

取极小值的最优控制u*(t)   以及最优轨线x*(t)。 10-9    已知系统状态方程及初始条件为
i=u,             x(0)=1
试确定最优控制使下列性能指标取极小值

10-10 求使系统
i₁=x₂,              iz=u
由初始状态x₁(0)=x₂(0)=0         出发，在tr=1   时转移到目标集x₁(1)+x₂(1)=1,          并使性能指标

为最小值的最优控制u*(t)及相应的最优轨线x'(t)。 10-11   已知一 阶系统
i(t)=-x(t)+u(t),                          x(0)=3
(1)试确定最优控制u*(t),    使系统在ty=2  时转移到x(2)=0,     并使性能泛函

(2)如果使系统转移到x(tg)=0    的终端时间tr 自由，问u*(t)   应如何确定? 10-12  设系统状态方程及初始条件为
i(t)=u(t),                  x(0)=1




试确定最优控制u*(t),   使性能指标

为极小，其中终端时间ty 未 定 ，x(tj)=0。 10-13 设二次积分模型为
θ(t)=w(t),                w(t)=u(t)
性能指标为

已知θ(0)=w(0)=1,0(1)=0,w(1)         自由，试求最优控制u*(t)   和最优轨线θ*(t),w*(t)。
10-14 设系统状态方程及初始条件为
i₁(t)=x₂(t),
i₂ (t)=u(t),
性能指标为

要求达到x(ty)=0, 试求：
(1)ty=5 时的最优控制u*(t);
(2)tr 自由时的最优控制u*(t)。 10-15    设一阶系统方程
i(t)=u(t),      x(0)=1
性能指标

已知x(1)=0,     某工程师认为从工程观点出发可取最优控制函数u"(t)=-1,        试分析他的意见是
否正确，并说明理由。
10-16 给定二阶系统

i₂(t)=u(t),
控制约束为 ,要求最优控制u*(t),   使系统在t=tr    时转移到x(t;)=0,      并使

式中tr自 由 。
10-17    设一阶系统方程为
i(t)=x(t)-u(t),                         x(0)=5
控制约束0.5≤u(t)≤1,     性能指标为



·624 ·







终端状态自由，试求u*(t),x'(t)和J'。 10-18    设二阶系统
i₁(t)=-x₁(t)+u(t),                         x₁(0)=1
.i₂(t)=x₁(t),                                    x₂(0)=0
控制约束|u(t)|≤1,当系统终端自由时，求最优控制u'(t),使性能指标 J=2x₁(1)+x₂(1)
取极小值，并求最优轨线x'(t)。 10-19    已知二阶系统
i₁(t)=x₂(t),                 i₂(t)=u(t)
控制约束 u|(t) | ≤1, 试确定最小时间控制u"(t), 使系统由任意初态最快地转移到终端状态 x₁(t;)=2,z₂(tj)=1,           要求写出开关曲线方程Y并画出Y曲线的图形。
10-20 已知一阶系统

性能指标

求最优控制u'(t)。
10-21 已知二阶系统
i₁(t)=z₂(t),                  i₂(t)=u(t) 试确定最优控制u*(t),   使下列性能指标取极小值：

10-22    设有二次积分模型
i₁(t)=x₂(t),                 x₁(0)=0
₂(t)=u(t),        ,        x₂(0)=1
y(t)=x₁(t)
要求的性能指标为

试构造最优输出调节器，并求最优性能指标J'。 10-23    给定一阶离散系统
x(k+1)=x(k)+u(k),                         x(0)=1
性能指标

试用动态规划和极小值原理求最优控制序列u·(k),k=0,1,2,3          和最小性能指标J'。
10-24    设系统状态方程为
i₁(t)=x₂(t),                 x₁(0)=I10
i₂(t)=u(t),                  x₂(0)=X2o
·625 ·






性能指标为

试分别用连续动态规划和调节器方法确定最优控制u*(t)。 10-25    设控制系统如图10-17所示，其中被控对象

试设计最优PID 控制器G.(s) 及前置滤波器G,(s),   使系统具有最优的ITAE  性能，且调节时间 小于0.8s(△=2%)。
10-26    设被控对象为

试设计一个带有PID 控制器和前置滤波器的单位负反馈控制系统，使系统的阶跃响应具有最优 的ITAE 指标，峰值时间为0.8s左右，并给出系统的单位阶跃响应曲线。
10-27 在太阳黑子活动的高峰期，N ASA 会把Y 射线图像设备(GRID) 系于高空飞行的气 球上，以从事长时间的观测实验。GRID 设备能拍摄更准确的X 射线的强度图，也可以拍摄Y 射 线强度图。这些信息有利于在下一次太阳活动高峰期，对太阳中的高能现象进行研究。装配在气 球上的GRID 如图10-26(a) 所示，其主要组成部分是：直径为5.2m的吊舱，GRID 有效载荷，高 空气球和连接气球与吊舱的缆绳。GRID 设备指向控制系统如图10-26(b) 所示。其中，扭矩电机 负责驱动圆桶式吊舱装置。要求设计PID 控制器G.(s) 及前置滤波器G,(s),  使系统在阶跃输入作 用下的稳态跟踪误差为零，并具有ITAE  优化性能。







(a)                                                                                   (b)














传运


设讠


波暑



单仁




图10-26 GRID设备的指向控制系统
10-28 图10-27的模型描述了人类站立时的平衡调节机制。对于丧失自主站立能力的下身 残疾的伤残人士，需要安装图10-27所示的站立和腿关节人工控制系统。设计要求：
(1)若肌肉-神经系统的参数标称值为K=10,a=12,b=100,        试用ITAE  优化法设计PI 控 制 器 G.(s)     和 前 置 滤 波 器 Gp(s),      使 人 工 控 制 系 统 阶 跃 响 应 的o%<10%,
e()<5%,t₂<2s(△=2%);
(2)当人疲乏时，肌肉-神经系统的参数变化为K=15,a=8,b=144,        试沿用在(1)中得到的






间
图10-27 站立和腿关节的人工控制系统
PI 控制器和前置滤波器，检验系统的鲁棒性能，绘出系统参数变化前后的单位阶跃响应曲线。
10-29 空间机器人的机械臂及其控制框图如图10-28所示。已知电机与机械臂构成的手臂
传递函数为

设计要求：
(1)当G.(s)=K    时，确定K 的合适取值，使系统阶跃响应的超调量α%=4.5%;
(2)采用ITAE  优化方法，并选取wn=10, 设计合适的PD 控制器G(s),   确定对应的前置滤 波器G,(s);
(3)采用ITAE 优化方法，设计合适的PI 控制器 G₄(s) 和相应的前置滤波器Gp(s);
(4)采用ITAE  优化方法和w=10,    设计合适的PID 控制器G.(s) 和前置滤波器G,(s);
(5)对上述各种设计效果，列表比较系统对单位阶跃输入响应的σ%,tp,t;(△=2%),以及由 单位阶跃扰动引起的输出y(t)  的最大值和稳态值。




N(s)
s)
立角



(a)                                                                                (b) 图10-28 空间机器人的机械臂控制系统







